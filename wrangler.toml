name = "riding-lookup"
main = "src/worker.ts"
compatibility_date = "2024-09-01"

# Bind an R2 bucket that will store the large GeoJSON files
# Create the bucket with: wrangler r2 bucket create ridings

[[r2_buckets]]
binding = "RIDINGS"
bucket_name = "ridings"

[[kv_namespaces]]
binding = "GEOCODING_CACHE"
id = "your-geocoding-cache-id"
preview_id = "your-preview-geocoding-cache-id"

[[durable_objects.bindings]]
name = "QUEUE_MANAGER"
class_name = "QueueManagerDO"

[[migrations]]
tag = "v1"
new_classes = [ "QueueManagerDO" ]

[vars]
# Optional: set a geocoding provider. Supported: "nominatim" (default) or "mapbox"
# For Mapbox, set MAPBOX_TOKEN as a secret: wrangler secret put MAPBOX_TOKEN
# Basic auth credentials in format "username:password" (base64 encoded)
# Batch processing configuration
BATCH_SIZE = 50
BATCH_TIMEOUT = 30000
RATE_LIMIT = 100

[observability]
enabled = true
