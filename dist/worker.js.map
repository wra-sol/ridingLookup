{
  "version": 3,
  "sources": ["../src/config.ts", "../node_modules/zod/v3/external.js", "../node_modules/zod/v3/helpers/util.js", "../node_modules/zod/v3/ZodError.js", "../node_modules/zod/v3/locales/en.js", "../node_modules/zod/v3/errors.js", "../node_modules/zod/v3/helpers/parseUtil.js", "../node_modules/zod/v3/helpers/errorUtil.js", "../node_modules/zod/v3/types.js", "../src/validation.ts", "../src/geocoding.ts", "../src/circuit-breaker.ts", "../src/utils.ts", "../src/cache.ts", "../src/metrics.ts", "../src/spatial.ts", "../src/webhooks.ts", "../src/batch.ts", "../src/queue-manager.ts", "../src/circuit-breaker-do.ts", "../src/docs.ts", "../src/worker.ts"],
  "sourceRoot": "dist",
  "sourcesContent": ["/// <reference types=\"@cloudflare/workers-types\" />\n\nimport { Env } from './types';\n\n// Centralized timeout configuration\nexport const TIMEOUT_CONFIG = {\n  geocoding: 10000,      // 10 seconds for geocoding requests\n  lookup: 5000,           // 5 seconds for riding lookup\n  batch: 30000,          // 30 seconds for batch processing\n  total: 60000,          // 60 seconds maximum total request time\n  webhook: 30000         // 30 seconds for webhook delivery\n};\n\n// Retry configuration\nexport const RETRY_CONFIG = {\n  maxAttempts: 3,\n  baseDelay: 1000,        // 1 second base delay\n  maxDelay: 5000,         // 5 seconds maximum delay\n  backoffMultiplier: 2,   // Exponential backoff multiplier\n  jitter: true            // Add random jitter to prevent thundering herd\n};\n\n// Get timeout values from environment or use defaults\nexport function getTimeoutConfig(env: Env) {\n  return {\n    geocoding: env.BATCH_TIMEOUT || TIMEOUT_CONFIG.geocoding,\n    lookup: env.BATCH_TIMEOUT || TIMEOUT_CONFIG.lookup,\n    batch: env.BATCH_TIMEOUT || TIMEOUT_CONFIG.batch,\n    total: env.BATCH_TIMEOUT || TIMEOUT_CONFIG.total,\n    webhook: TIMEOUT_CONFIG.webhook\n  };\n}\n\n// Get retry configuration (can be overridden by env in future)\nexport function getRetryConfig() {\n  return RETRY_CONFIG;\n}\n\n// Time constants (in milliseconds)\nexport const TIME_CONSTANTS = {\n  ONE_HOUR_MS: 60 * 60 * 1000,\n  SIX_HOURS_MS: 6 * 60 * 60 * 1000,\n  TWENTY_FOUR_HOURS_MS: 24 * 60 * 60 * 1000,\n  SEVEN_DAYS_MS: 7 * 24 * 60 * 60 * 1000\n};\n\n// Time constants (in seconds for TTL)\nexport const TIME_CONSTANTS_SECONDS = {\n  TWENTY_FOUR_HOURS: 24 * 60 * 60\n};\n\n// Quality thresholds\nexport const QUALITY_THRESHOLDS = {\n  GEOGRATIS_MIN_SCORE: 0.5 // Minimum acceptable GeoGratis quality score (0-1 scale)\n};\n\n", "export * from \"./errors.js\";\nexport * from \"./helpers/parseUtil.js\";\nexport * from \"./helpers/typeAliases.js\";\nexport * from \"./helpers/util.js\";\nexport * from \"./types.js\";\nexport * from \"./ZodError.js\";\n", "export var util;\n(function (util) {\n    util.assertEqual = (_) => { };\n    function assertIs(_arg) { }\n    util.assertIs = assertIs;\n    function assertNever(_x) {\n        throw new Error();\n    }\n    util.assertNever = assertNever;\n    util.arrayToEnum = (items) => {\n        const obj = {};\n        for (const item of items) {\n            obj[item] = item;\n        }\n        return obj;\n    };\n    util.getValidEnumValues = (obj) => {\n        const validKeys = util.objectKeys(obj).filter((k) => typeof obj[obj[k]] !== \"number\");\n        const filtered = {};\n        for (const k of validKeys) {\n            filtered[k] = obj[k];\n        }\n        return util.objectValues(filtered);\n    };\n    util.objectValues = (obj) => {\n        return util.objectKeys(obj).map(function (e) {\n            return obj[e];\n        });\n    };\n    util.objectKeys = typeof Object.keys === \"function\" // eslint-disable-line ban/ban\n        ? (obj) => Object.keys(obj) // eslint-disable-line ban/ban\n        : (object) => {\n            const keys = [];\n            for (const key in object) {\n                if (Object.prototype.hasOwnProperty.call(object, key)) {\n                    keys.push(key);\n                }\n            }\n            return keys;\n        };\n    util.find = (arr, checker) => {\n        for (const item of arr) {\n            if (checker(item))\n                return item;\n        }\n        return undefined;\n    };\n    util.isInteger = typeof Number.isInteger === \"function\"\n        ? (val) => Number.isInteger(val) // eslint-disable-line ban/ban\n        : (val) => typeof val === \"number\" && Number.isFinite(val) && Math.floor(val) === val;\n    function joinValues(array, separator = \" | \") {\n        return array.map((val) => (typeof val === \"string\" ? `'${val}'` : val)).join(separator);\n    }\n    util.joinValues = joinValues;\n    util.jsonStringifyReplacer = (_, value) => {\n        if (typeof value === \"bigint\") {\n            return value.toString();\n        }\n        return value;\n    };\n})(util || (util = {}));\nexport var objectUtil;\n(function (objectUtil) {\n    objectUtil.mergeShapes = (first, second) => {\n        return {\n            ...first,\n            ...second, // second overwrites first\n        };\n    };\n})(objectUtil || (objectUtil = {}));\nexport const ZodParsedType = util.arrayToEnum([\n    \"string\",\n    \"nan\",\n    \"number\",\n    \"integer\",\n    \"float\",\n    \"boolean\",\n    \"date\",\n    \"bigint\",\n    \"symbol\",\n    \"function\",\n    \"undefined\",\n    \"null\",\n    \"array\",\n    \"object\",\n    \"unknown\",\n    \"promise\",\n    \"void\",\n    \"never\",\n    \"map\",\n    \"set\",\n]);\nexport const getParsedType = (data) => {\n    const t = typeof data;\n    switch (t) {\n        case \"undefined\":\n            return ZodParsedType.undefined;\n        case \"string\":\n            return ZodParsedType.string;\n        case \"number\":\n            return Number.isNaN(data) ? ZodParsedType.nan : ZodParsedType.number;\n        case \"boolean\":\n            return ZodParsedType.boolean;\n        case \"function\":\n            return ZodParsedType.function;\n        case \"bigint\":\n            return ZodParsedType.bigint;\n        case \"symbol\":\n            return ZodParsedType.symbol;\n        case \"object\":\n            if (Array.isArray(data)) {\n                return ZodParsedType.array;\n            }\n            if (data === null) {\n                return ZodParsedType.null;\n            }\n            if (data.then && typeof data.then === \"function\" && data.catch && typeof data.catch === \"function\") {\n                return ZodParsedType.promise;\n            }\n            if (typeof Map !== \"undefined\" && data instanceof Map) {\n                return ZodParsedType.map;\n            }\n            if (typeof Set !== \"undefined\" && data instanceof Set) {\n                return ZodParsedType.set;\n            }\n            if (typeof Date !== \"undefined\" && data instanceof Date) {\n                return ZodParsedType.date;\n            }\n            return ZodParsedType.object;\n        default:\n            return ZodParsedType.unknown;\n    }\n};\n", "import { util } from \"./helpers/util.js\";\nexport const ZodIssueCode = util.arrayToEnum([\n    \"invalid_type\",\n    \"invalid_literal\",\n    \"custom\",\n    \"invalid_union\",\n    \"invalid_union_discriminator\",\n    \"invalid_enum_value\",\n    \"unrecognized_keys\",\n    \"invalid_arguments\",\n    \"invalid_return_type\",\n    \"invalid_date\",\n    \"invalid_string\",\n    \"too_small\",\n    \"too_big\",\n    \"invalid_intersection_types\",\n    \"not_multiple_of\",\n    \"not_finite\",\n]);\nexport const quotelessJson = (obj) => {\n    const json = JSON.stringify(obj, null, 2);\n    return json.replace(/\"([^\"]+)\":/g, \"$1:\");\n};\nexport class ZodError extends Error {\n    get errors() {\n        return this.issues;\n    }\n    constructor(issues) {\n        super();\n        this.issues = [];\n        this.addIssue = (sub) => {\n            this.issues = [...this.issues, sub];\n        };\n        this.addIssues = (subs = []) => {\n            this.issues = [...this.issues, ...subs];\n        };\n        const actualProto = new.target.prototype;\n        if (Object.setPrototypeOf) {\n            // eslint-disable-next-line ban/ban\n            Object.setPrototypeOf(this, actualProto);\n        }\n        else {\n            this.__proto__ = actualProto;\n        }\n        this.name = \"ZodError\";\n        this.issues = issues;\n    }\n    format(_mapper) {\n        const mapper = _mapper ||\n            function (issue) {\n                return issue.message;\n            };\n        const fieldErrors = { _errors: [] };\n        const processError = (error) => {\n            for (const issue of error.issues) {\n                if (issue.code === \"invalid_union\") {\n                    issue.unionErrors.map(processError);\n                }\n                else if (issue.code === \"invalid_return_type\") {\n                    processError(issue.returnTypeError);\n                }\n                else if (issue.code === \"invalid_arguments\") {\n                    processError(issue.argumentsError);\n                }\n                else if (issue.path.length === 0) {\n                    fieldErrors._errors.push(mapper(issue));\n                }\n                else {\n                    let curr = fieldErrors;\n                    let i = 0;\n                    while (i < issue.path.length) {\n                        const el = issue.path[i];\n                        const terminal = i === issue.path.length - 1;\n                        if (!terminal) {\n                            curr[el] = curr[el] || { _errors: [] };\n                            // if (typeof el === \"string\") {\n                            //   curr[el] = curr[el] || { _errors: [] };\n                            // } else if (typeof el === \"number\") {\n                            //   const errorArray: any = [];\n                            //   errorArray._errors = [];\n                            //   curr[el] = curr[el] || errorArray;\n                            // }\n                        }\n                        else {\n                            curr[el] = curr[el] || { _errors: [] };\n                            curr[el]._errors.push(mapper(issue));\n                        }\n                        curr = curr[el];\n                        i++;\n                    }\n                }\n            }\n        };\n        processError(this);\n        return fieldErrors;\n    }\n    static assert(value) {\n        if (!(value instanceof ZodError)) {\n            throw new Error(`Not a ZodError: ${value}`);\n        }\n    }\n    toString() {\n        return this.message;\n    }\n    get message() {\n        return JSON.stringify(this.issues, util.jsonStringifyReplacer, 2);\n    }\n    get isEmpty() {\n        return this.issues.length === 0;\n    }\n    flatten(mapper = (issue) => issue.message) {\n        const fieldErrors = {};\n        const formErrors = [];\n        for (const sub of this.issues) {\n            if (sub.path.length > 0) {\n                const firstEl = sub.path[0];\n                fieldErrors[firstEl] = fieldErrors[firstEl] || [];\n                fieldErrors[firstEl].push(mapper(sub));\n            }\n            else {\n                formErrors.push(mapper(sub));\n            }\n        }\n        return { formErrors, fieldErrors };\n    }\n    get formErrors() {\n        return this.flatten();\n    }\n}\nZodError.create = (issues) => {\n    const error = new ZodError(issues);\n    return error;\n};\n", "import { ZodIssueCode } from \"../ZodError.js\";\nimport { util, ZodParsedType } from \"../helpers/util.js\";\nconst errorMap = (issue, _ctx) => {\n    let message;\n    switch (issue.code) {\n        case ZodIssueCode.invalid_type:\n            if (issue.received === ZodParsedType.undefined) {\n                message = \"Required\";\n            }\n            else {\n                message = `Expected ${issue.expected}, received ${issue.received}`;\n            }\n            break;\n        case ZodIssueCode.invalid_literal:\n            message = `Invalid literal value, expected ${JSON.stringify(issue.expected, util.jsonStringifyReplacer)}`;\n            break;\n        case ZodIssueCode.unrecognized_keys:\n            message = `Unrecognized key(s) in object: ${util.joinValues(issue.keys, \", \")}`;\n            break;\n        case ZodIssueCode.invalid_union:\n            message = `Invalid input`;\n            break;\n        case ZodIssueCode.invalid_union_discriminator:\n            message = `Invalid discriminator value. Expected ${util.joinValues(issue.options)}`;\n            break;\n        case ZodIssueCode.invalid_enum_value:\n            message = `Invalid enum value. Expected ${util.joinValues(issue.options)}, received '${issue.received}'`;\n            break;\n        case ZodIssueCode.invalid_arguments:\n            message = `Invalid function arguments`;\n            break;\n        case ZodIssueCode.invalid_return_type:\n            message = `Invalid function return type`;\n            break;\n        case ZodIssueCode.invalid_date:\n            message = `Invalid date`;\n            break;\n        case ZodIssueCode.invalid_string:\n            if (typeof issue.validation === \"object\") {\n                if (\"includes\" in issue.validation) {\n                    message = `Invalid input: must include \"${issue.validation.includes}\"`;\n                    if (typeof issue.validation.position === \"number\") {\n                        message = `${message} at one or more positions greater than or equal to ${issue.validation.position}`;\n                    }\n                }\n                else if (\"startsWith\" in issue.validation) {\n                    message = `Invalid input: must start with \"${issue.validation.startsWith}\"`;\n                }\n                else if (\"endsWith\" in issue.validation) {\n                    message = `Invalid input: must end with \"${issue.validation.endsWith}\"`;\n                }\n                else {\n                    util.assertNever(issue.validation);\n                }\n            }\n            else if (issue.validation !== \"regex\") {\n                message = `Invalid ${issue.validation}`;\n            }\n            else {\n                message = \"Invalid\";\n            }\n            break;\n        case ZodIssueCode.too_small:\n            if (issue.type === \"array\")\n                message = `Array must contain ${issue.exact ? \"exactly\" : issue.inclusive ? `at least` : `more than`} ${issue.minimum} element(s)`;\n            else if (issue.type === \"string\")\n                message = `String must contain ${issue.exact ? \"exactly\" : issue.inclusive ? `at least` : `over`} ${issue.minimum} character(s)`;\n            else if (issue.type === \"number\")\n                message = `Number must be ${issue.exact ? `exactly equal to ` : issue.inclusive ? `greater than or equal to ` : `greater than `}${issue.minimum}`;\n            else if (issue.type === \"bigint\")\n                message = `Number must be ${issue.exact ? `exactly equal to ` : issue.inclusive ? `greater than or equal to ` : `greater than `}${issue.minimum}`;\n            else if (issue.type === \"date\")\n                message = `Date must be ${issue.exact ? `exactly equal to ` : issue.inclusive ? `greater than or equal to ` : `greater than `}${new Date(Number(issue.minimum))}`;\n            else\n                message = \"Invalid input\";\n            break;\n        case ZodIssueCode.too_big:\n            if (issue.type === \"array\")\n                message = `Array must contain ${issue.exact ? `exactly` : issue.inclusive ? `at most` : `less than`} ${issue.maximum} element(s)`;\n            else if (issue.type === \"string\")\n                message = `String must contain ${issue.exact ? `exactly` : issue.inclusive ? `at most` : `under`} ${issue.maximum} character(s)`;\n            else if (issue.type === \"number\")\n                message = `Number must be ${issue.exact ? `exactly` : issue.inclusive ? `less than or equal to` : `less than`} ${issue.maximum}`;\n            else if (issue.type === \"bigint\")\n                message = `BigInt must be ${issue.exact ? `exactly` : issue.inclusive ? `less than or equal to` : `less than`} ${issue.maximum}`;\n            else if (issue.type === \"date\")\n                message = `Date must be ${issue.exact ? `exactly` : issue.inclusive ? `smaller than or equal to` : `smaller than`} ${new Date(Number(issue.maximum))}`;\n            else\n                message = \"Invalid input\";\n            break;\n        case ZodIssueCode.custom:\n            message = `Invalid input`;\n            break;\n        case ZodIssueCode.invalid_intersection_types:\n            message = `Intersection results could not be merged`;\n            break;\n        case ZodIssueCode.not_multiple_of:\n            message = `Number must be a multiple of ${issue.multipleOf}`;\n            break;\n        case ZodIssueCode.not_finite:\n            message = \"Number must be finite\";\n            break;\n        default:\n            message = _ctx.defaultError;\n            util.assertNever(issue);\n    }\n    return { message };\n};\nexport default errorMap;\n", "import defaultErrorMap from \"./locales/en.js\";\nlet overrideErrorMap = defaultErrorMap;\nexport { defaultErrorMap };\nexport function setErrorMap(map) {\n    overrideErrorMap = map;\n}\nexport function getErrorMap() {\n    return overrideErrorMap;\n}\n", "import { getErrorMap } from \"../errors.js\";\nimport defaultErrorMap from \"../locales/en.js\";\nexport const makeIssue = (params) => {\n    const { data, path, errorMaps, issueData } = params;\n    const fullPath = [...path, ...(issueData.path || [])];\n    const fullIssue = {\n        ...issueData,\n        path: fullPath,\n    };\n    if (issueData.message !== undefined) {\n        return {\n            ...issueData,\n            path: fullPath,\n            message: issueData.message,\n        };\n    }\n    let errorMessage = \"\";\n    const maps = errorMaps\n        .filter((m) => !!m)\n        .slice()\n        .reverse();\n    for (const map of maps) {\n        errorMessage = map(fullIssue, { data, defaultError: errorMessage }).message;\n    }\n    return {\n        ...issueData,\n        path: fullPath,\n        message: errorMessage,\n    };\n};\nexport const EMPTY_PATH = [];\nexport function addIssueToContext(ctx, issueData) {\n    const overrideMap = getErrorMap();\n    const issue = makeIssue({\n        issueData: issueData,\n        data: ctx.data,\n        path: ctx.path,\n        errorMaps: [\n            ctx.common.contextualErrorMap, // contextual error map is first priority\n            ctx.schemaErrorMap, // then schema-bound map if available\n            overrideMap, // then global override map\n            overrideMap === defaultErrorMap ? undefined : defaultErrorMap, // then global default map\n        ].filter((x) => !!x),\n    });\n    ctx.common.issues.push(issue);\n}\nexport class ParseStatus {\n    constructor() {\n        this.value = \"valid\";\n    }\n    dirty() {\n        if (this.value === \"valid\")\n            this.value = \"dirty\";\n    }\n    abort() {\n        if (this.value !== \"aborted\")\n            this.value = \"aborted\";\n    }\n    static mergeArray(status, results) {\n        const arrayValue = [];\n        for (const s of results) {\n            if (s.status === \"aborted\")\n                return INVALID;\n            if (s.status === \"dirty\")\n                status.dirty();\n            arrayValue.push(s.value);\n        }\n        return { status: status.value, value: arrayValue };\n    }\n    static async mergeObjectAsync(status, pairs) {\n        const syncPairs = [];\n        for (const pair of pairs) {\n            const key = await pair.key;\n            const value = await pair.value;\n            syncPairs.push({\n                key,\n                value,\n            });\n        }\n        return ParseStatus.mergeObjectSync(status, syncPairs);\n    }\n    static mergeObjectSync(status, pairs) {\n        const finalObject = {};\n        for (const pair of pairs) {\n            const { key, value } = pair;\n            if (key.status === \"aborted\")\n                return INVALID;\n            if (value.status === \"aborted\")\n                return INVALID;\n            if (key.status === \"dirty\")\n                status.dirty();\n            if (value.status === \"dirty\")\n                status.dirty();\n            if (key.value !== \"__proto__\" && (typeof value.value !== \"undefined\" || pair.alwaysSet)) {\n                finalObject[key.value] = value.value;\n            }\n        }\n        return { status: status.value, value: finalObject };\n    }\n}\nexport const INVALID = Object.freeze({\n    status: \"aborted\",\n});\nexport const DIRTY = (value) => ({ status: \"dirty\", value });\nexport const OK = (value) => ({ status: \"valid\", value });\nexport const isAborted = (x) => x.status === \"aborted\";\nexport const isDirty = (x) => x.status === \"dirty\";\nexport const isValid = (x) => x.status === \"valid\";\nexport const isAsync = (x) => typeof Promise !== \"undefined\" && x instanceof Promise;\n", "export var errorUtil;\n(function (errorUtil) {\n    errorUtil.errToObj = (message) => typeof message === \"string\" ? { message } : message || {};\n    // biome-ignore lint:\n    errorUtil.toString = (message) => typeof message === \"string\" ? message : message?.message;\n})(errorUtil || (errorUtil = {}));\n", "import { ZodError, ZodIssueCode, } from \"./ZodError.js\";\nimport { defaultErrorMap, getErrorMap } from \"./errors.js\";\nimport { errorUtil } from \"./helpers/errorUtil.js\";\nimport { DIRTY, INVALID, OK, ParseStatus, addIssueToContext, isAborted, isAsync, isDirty, isValid, makeIssue, } from \"./helpers/parseUtil.js\";\nimport { util, ZodParsedType, getParsedType } from \"./helpers/util.js\";\nclass ParseInputLazyPath {\n    constructor(parent, value, path, key) {\n        this._cachedPath = [];\n        this.parent = parent;\n        this.data = value;\n        this._path = path;\n        this._key = key;\n    }\n    get path() {\n        if (!this._cachedPath.length) {\n            if (Array.isArray(this._key)) {\n                this._cachedPath.push(...this._path, ...this._key);\n            }\n            else {\n                this._cachedPath.push(...this._path, this._key);\n            }\n        }\n        return this._cachedPath;\n    }\n}\nconst handleResult = (ctx, result) => {\n    if (isValid(result)) {\n        return { success: true, data: result.value };\n    }\n    else {\n        if (!ctx.common.issues.length) {\n            throw new Error(\"Validation failed but no issues detected.\");\n        }\n        return {\n            success: false,\n            get error() {\n                if (this._error)\n                    return this._error;\n                const error = new ZodError(ctx.common.issues);\n                this._error = error;\n                return this._error;\n            },\n        };\n    }\n};\nfunction processCreateParams(params) {\n    if (!params)\n        return {};\n    const { errorMap, invalid_type_error, required_error, description } = params;\n    if (errorMap && (invalid_type_error || required_error)) {\n        throw new Error(`Can't use \"invalid_type_error\" or \"required_error\" in conjunction with custom error map.`);\n    }\n    if (errorMap)\n        return { errorMap: errorMap, description };\n    const customMap = (iss, ctx) => {\n        const { message } = params;\n        if (iss.code === \"invalid_enum_value\") {\n            return { message: message ?? ctx.defaultError };\n        }\n        if (typeof ctx.data === \"undefined\") {\n            return { message: message ?? required_error ?? ctx.defaultError };\n        }\n        if (iss.code !== \"invalid_type\")\n            return { message: ctx.defaultError };\n        return { message: message ?? invalid_type_error ?? ctx.defaultError };\n    };\n    return { errorMap: customMap, description };\n}\nexport class ZodType {\n    get description() {\n        return this._def.description;\n    }\n    _getType(input) {\n        return getParsedType(input.data);\n    }\n    _getOrReturnCtx(input, ctx) {\n        return (ctx || {\n            common: input.parent.common,\n            data: input.data,\n            parsedType: getParsedType(input.data),\n            schemaErrorMap: this._def.errorMap,\n            path: input.path,\n            parent: input.parent,\n        });\n    }\n    _processInputParams(input) {\n        return {\n            status: new ParseStatus(),\n            ctx: {\n                common: input.parent.common,\n                data: input.data,\n                parsedType: getParsedType(input.data),\n                schemaErrorMap: this._def.errorMap,\n                path: input.path,\n                parent: input.parent,\n            },\n        };\n    }\n    _parseSync(input) {\n        const result = this._parse(input);\n        if (isAsync(result)) {\n            throw new Error(\"Synchronous parse encountered promise.\");\n        }\n        return result;\n    }\n    _parseAsync(input) {\n        const result = this._parse(input);\n        return Promise.resolve(result);\n    }\n    parse(data, params) {\n        const result = this.safeParse(data, params);\n        if (result.success)\n            return result.data;\n        throw result.error;\n    }\n    safeParse(data, params) {\n        const ctx = {\n            common: {\n                issues: [],\n                async: params?.async ?? false,\n                contextualErrorMap: params?.errorMap,\n            },\n            path: params?.path || [],\n            schemaErrorMap: this._def.errorMap,\n            parent: null,\n            data,\n            parsedType: getParsedType(data),\n        };\n        const result = this._parseSync({ data, path: ctx.path, parent: ctx });\n        return handleResult(ctx, result);\n    }\n    \"~validate\"(data) {\n        const ctx = {\n            common: {\n                issues: [],\n                async: !!this[\"~standard\"].async,\n            },\n            path: [],\n            schemaErrorMap: this._def.errorMap,\n            parent: null,\n            data,\n            parsedType: getParsedType(data),\n        };\n        if (!this[\"~standard\"].async) {\n            try {\n                const result = this._parseSync({ data, path: [], parent: ctx });\n                return isValid(result)\n                    ? {\n                        value: result.value,\n                    }\n                    : {\n                        issues: ctx.common.issues,\n                    };\n            }\n            catch (err) {\n                if (err?.message?.toLowerCase()?.includes(\"encountered\")) {\n                    this[\"~standard\"].async = true;\n                }\n                ctx.common = {\n                    issues: [],\n                    async: true,\n                };\n            }\n        }\n        return this._parseAsync({ data, path: [], parent: ctx }).then((result) => isValid(result)\n            ? {\n                value: result.value,\n            }\n            : {\n                issues: ctx.common.issues,\n            });\n    }\n    async parseAsync(data, params) {\n        const result = await this.safeParseAsync(data, params);\n        if (result.success)\n            return result.data;\n        throw result.error;\n    }\n    async safeParseAsync(data, params) {\n        const ctx = {\n            common: {\n                issues: [],\n                contextualErrorMap: params?.errorMap,\n                async: true,\n            },\n            path: params?.path || [],\n            schemaErrorMap: this._def.errorMap,\n            parent: null,\n            data,\n            parsedType: getParsedType(data),\n        };\n        const maybeAsyncResult = this._parse({ data, path: ctx.path, parent: ctx });\n        const result = await (isAsync(maybeAsyncResult) ? maybeAsyncResult : Promise.resolve(maybeAsyncResult));\n        return handleResult(ctx, result);\n    }\n    refine(check, message) {\n        const getIssueProperties = (val) => {\n            if (typeof message === \"string\" || typeof message === \"undefined\") {\n                return { message };\n            }\n            else if (typeof message === \"function\") {\n                return message(val);\n            }\n            else {\n                return message;\n            }\n        };\n        return this._refinement((val, ctx) => {\n            const result = check(val);\n            const setError = () => ctx.addIssue({\n                code: ZodIssueCode.custom,\n                ...getIssueProperties(val),\n            });\n            if (typeof Promise !== \"undefined\" && result instanceof Promise) {\n                return result.then((data) => {\n                    if (!data) {\n                        setError();\n                        return false;\n                    }\n                    else {\n                        return true;\n                    }\n                });\n            }\n            if (!result) {\n                setError();\n                return false;\n            }\n            else {\n                return true;\n            }\n        });\n    }\n    refinement(check, refinementData) {\n        return this._refinement((val, ctx) => {\n            if (!check(val)) {\n                ctx.addIssue(typeof refinementData === \"function\" ? refinementData(val, ctx) : refinementData);\n                return false;\n            }\n            else {\n                return true;\n            }\n        });\n    }\n    _refinement(refinement) {\n        return new ZodEffects({\n            schema: this,\n            typeName: ZodFirstPartyTypeKind.ZodEffects,\n            effect: { type: \"refinement\", refinement },\n        });\n    }\n    superRefine(refinement) {\n        return this._refinement(refinement);\n    }\n    constructor(def) {\n        /** Alias of safeParseAsync */\n        this.spa = this.safeParseAsync;\n        this._def = def;\n        this.parse = this.parse.bind(this);\n        this.safeParse = this.safeParse.bind(this);\n        this.parseAsync = this.parseAsync.bind(this);\n        this.safeParseAsync = this.safeParseAsync.bind(this);\n        this.spa = this.spa.bind(this);\n        this.refine = this.refine.bind(this);\n        this.refinement = this.refinement.bind(this);\n        this.superRefine = this.superRefine.bind(this);\n        this.optional = this.optional.bind(this);\n        this.nullable = this.nullable.bind(this);\n        this.nullish = this.nullish.bind(this);\n        this.array = this.array.bind(this);\n        this.promise = this.promise.bind(this);\n        this.or = this.or.bind(this);\n        this.and = this.and.bind(this);\n        this.transform = this.transform.bind(this);\n        this.brand = this.brand.bind(this);\n        this.default = this.default.bind(this);\n        this.catch = this.catch.bind(this);\n        this.describe = this.describe.bind(this);\n        this.pipe = this.pipe.bind(this);\n        this.readonly = this.readonly.bind(this);\n        this.isNullable = this.isNullable.bind(this);\n        this.isOptional = this.isOptional.bind(this);\n        this[\"~standard\"] = {\n            version: 1,\n            vendor: \"zod\",\n            validate: (data) => this[\"~validate\"](data),\n        };\n    }\n    optional() {\n        return ZodOptional.create(this, this._def);\n    }\n    nullable() {\n        return ZodNullable.create(this, this._def);\n    }\n    nullish() {\n        return this.nullable().optional();\n    }\n    array() {\n        return ZodArray.create(this);\n    }\n    promise() {\n        return ZodPromise.create(this, this._def);\n    }\n    or(option) {\n        return ZodUnion.create([this, option], this._def);\n    }\n    and(incoming) {\n        return ZodIntersection.create(this, incoming, this._def);\n    }\n    transform(transform) {\n        return new ZodEffects({\n            ...processCreateParams(this._def),\n            schema: this,\n            typeName: ZodFirstPartyTypeKind.ZodEffects,\n            effect: { type: \"transform\", transform },\n        });\n    }\n    default(def) {\n        const defaultValueFunc = typeof def === \"function\" ? def : () => def;\n        return new ZodDefault({\n            ...processCreateParams(this._def),\n            innerType: this,\n            defaultValue: defaultValueFunc,\n            typeName: ZodFirstPartyTypeKind.ZodDefault,\n        });\n    }\n    brand() {\n        return new ZodBranded({\n            typeName: ZodFirstPartyTypeKind.ZodBranded,\n            type: this,\n            ...processCreateParams(this._def),\n        });\n    }\n    catch(def) {\n        const catchValueFunc = typeof def === \"function\" ? def : () => def;\n        return new ZodCatch({\n            ...processCreateParams(this._def),\n            innerType: this,\n            catchValue: catchValueFunc,\n            typeName: ZodFirstPartyTypeKind.ZodCatch,\n        });\n    }\n    describe(description) {\n        const This = this.constructor;\n        return new This({\n            ...this._def,\n            description,\n        });\n    }\n    pipe(target) {\n        return ZodPipeline.create(this, target);\n    }\n    readonly() {\n        return ZodReadonly.create(this);\n    }\n    isOptional() {\n        return this.safeParse(undefined).success;\n    }\n    isNullable() {\n        return this.safeParse(null).success;\n    }\n}\nconst cuidRegex = /^c[^\\s-]{8,}$/i;\nconst cuid2Regex = /^[0-9a-z]+$/;\nconst ulidRegex = /^[0-9A-HJKMNP-TV-Z]{26}$/i;\n// const uuidRegex =\n//   /^([a-f0-9]{8}-[a-f0-9]{4}-[1-5][a-f0-9]{3}-[a-f0-9]{4}-[a-f0-9]{12}|00000000-0000-0000-0000-000000000000)$/i;\nconst uuidRegex = /^[0-9a-fA-F]{8}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{4}\\b-[0-9a-fA-F]{12}$/i;\nconst nanoidRegex = /^[a-z0-9_-]{21}$/i;\nconst jwtRegex = /^[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]*$/;\nconst durationRegex = /^[-+]?P(?!$)(?:(?:[-+]?\\d+Y)|(?:[-+]?\\d+[.,]\\d+Y$))?(?:(?:[-+]?\\d+M)|(?:[-+]?\\d+[.,]\\d+M$))?(?:(?:[-+]?\\d+W)|(?:[-+]?\\d+[.,]\\d+W$))?(?:(?:[-+]?\\d+D)|(?:[-+]?\\d+[.,]\\d+D$))?(?:T(?=[\\d+-])(?:(?:[-+]?\\d+H)|(?:[-+]?\\d+[.,]\\d+H$))?(?:(?:[-+]?\\d+M)|(?:[-+]?\\d+[.,]\\d+M$))?(?:[-+]?\\d+(?:[.,]\\d+)?S)?)??$/;\n// from https://stackoverflow.com/a/46181/1550155\n// old version: too slow, didn't support unicode\n// const emailRegex = /^((([a-z]|\\d|[!#\\$%&'\\*\\+\\-\\/=\\?\\^_`{\\|}~]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])+(\\.([a-z]|\\d|[!#\\$%&'\\*\\+\\-\\/=\\?\\^_`{\\|}~]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])+)*)|((\\x22)((((\\x20|\\x09)*(\\x0d\\x0a))?(\\x20|\\x09)+)?(([\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x7f]|\\x21|[\\x23-\\x5b]|[\\x5d-\\x7e]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(\\\\([\\x01-\\x09\\x0b\\x0c\\x0d-\\x7f]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]))))*(((\\x20|\\x09)*(\\x0d\\x0a))?(\\x20|\\x09)+)?(\\x22)))@((([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))\\.)+(([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))$/i;\n//old email regex\n// const emailRegex = /^(([^<>()[\\].,;:\\s@\"]+(\\.[^<>()[\\].,;:\\s@\"]+)*)|(\".+\"))@((?!-)([^<>()[\\].,;:\\s@\"]+\\.)+[^<>()[\\].,;:\\s@\"]{1,})[^-<>()[\\].,;:\\s@\"]$/i;\n// eslint-disable-next-line\n// const emailRegex =\n//   /^(([^<>()[\\]\\\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@((\\[(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\\])|(\\[IPv6:(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))\\])|([A-Za-z0-9]([A-Za-z0-9-]*[A-Za-z0-9])*(\\.[A-Za-z]{2,})+))$/;\n// const emailRegex =\n//   /^[a-zA-Z0-9\\.\\!\\#\\$\\%\\&\\'\\*\\+\\/\\=\\?\\^\\_\\`\\{\\|\\}\\~\\-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;\n// const emailRegex =\n//   /^(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|\"(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21\\x23-\\x5b\\x5d-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])*\")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21-\\x5a\\x53-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])+)\\])$/i;\nconst emailRegex = /^(?!\\.)(?!.*\\.\\.)([A-Z0-9_'+\\-\\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\\-]*\\.)+[A-Z]{2,}$/i;\n// const emailRegex =\n//   /^[a-z0-9.!#$%&\u2019*+/=?^_`{|}~-]+@[a-z0-9-]+(?:\\.[a-z0-9\\-]+)*$/i;\n// from https://thekevinscott.com/emojis-in-javascript/#writing-a-regular-expression\nconst _emojiRegex = `^(\\\\p{Extended_Pictographic}|\\\\p{Emoji_Component})+$`;\nlet emojiRegex;\n// faster, simpler, safer\nconst ipv4Regex = /^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/;\nconst ipv4CidrRegex = /^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\\/(3[0-2]|[12]?[0-9])$/;\n// const ipv6Regex =\n// /^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/;\nconst ipv6Regex = /^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/;\nconst ipv6CidrRegex = /^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/;\n// https://stackoverflow.com/questions/7860392/determine-if-string-is-in-base64-using-javascript\nconst base64Regex = /^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/;\n// https://base64.guru/standards/base64url\nconst base64urlRegex = /^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/;\n// simple\n// const dateRegexSource = `\\\\d{4}-\\\\d{2}-\\\\d{2}`;\n// no leap year validation\n// const dateRegexSource = `\\\\d{4}-((0[13578]|10|12)-31|(0[13-9]|1[0-2])-30|(0[1-9]|1[0-2])-(0[1-9]|1\\\\d|2\\\\d))`;\n// with leap year validation\nconst dateRegexSource = `((\\\\d\\\\d[2468][048]|\\\\d\\\\d[13579][26]|\\\\d\\\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\\\d|30)|(02)-(0[1-9]|1\\\\d|2[0-8])))`;\nconst dateRegex = new RegExp(`^${dateRegexSource}$`);\nfunction timeRegexSource(args) {\n    let secondsRegexSource = `[0-5]\\\\d`;\n    if (args.precision) {\n        secondsRegexSource = `${secondsRegexSource}\\\\.\\\\d{${args.precision}}`;\n    }\n    else if (args.precision == null) {\n        secondsRegexSource = `${secondsRegexSource}(\\\\.\\\\d+)?`;\n    }\n    const secondsQuantifier = args.precision ? \"+\" : \"?\"; // require seconds if precision is nonzero\n    return `([01]\\\\d|2[0-3]):[0-5]\\\\d(:${secondsRegexSource})${secondsQuantifier}`;\n}\nfunction timeRegex(args) {\n    return new RegExp(`^${timeRegexSource(args)}$`);\n}\n// Adapted from https://stackoverflow.com/a/3143231\nexport function datetimeRegex(args) {\n    let regex = `${dateRegexSource}T${timeRegexSource(args)}`;\n    const opts = [];\n    opts.push(args.local ? `Z?` : `Z`);\n    if (args.offset)\n        opts.push(`([+-]\\\\d{2}:?\\\\d{2})`);\n    regex = `${regex}(${opts.join(\"|\")})`;\n    return new RegExp(`^${regex}$`);\n}\nfunction isValidIP(ip, version) {\n    if ((version === \"v4\" || !version) && ipv4Regex.test(ip)) {\n        return true;\n    }\n    if ((version === \"v6\" || !version) && ipv6Regex.test(ip)) {\n        return true;\n    }\n    return false;\n}\nfunction isValidJWT(jwt, alg) {\n    if (!jwtRegex.test(jwt))\n        return false;\n    try {\n        const [header] = jwt.split(\".\");\n        if (!header)\n            return false;\n        // Convert base64url to base64\n        const base64 = header\n            .replace(/-/g, \"+\")\n            .replace(/_/g, \"/\")\n            .padEnd(header.length + ((4 - (header.length % 4)) % 4), \"=\");\n        const decoded = JSON.parse(atob(base64));\n        if (typeof decoded !== \"object\" || decoded === null)\n            return false;\n        if (\"typ\" in decoded && decoded?.typ !== \"JWT\")\n            return false;\n        if (!decoded.alg)\n            return false;\n        if (alg && decoded.alg !== alg)\n            return false;\n        return true;\n    }\n    catch {\n        return false;\n    }\n}\nfunction isValidCidr(ip, version) {\n    if ((version === \"v4\" || !version) && ipv4CidrRegex.test(ip)) {\n        return true;\n    }\n    if ((version === \"v6\" || !version) && ipv6CidrRegex.test(ip)) {\n        return true;\n    }\n    return false;\n}\nexport class ZodString extends ZodType {\n    _parse(input) {\n        if (this._def.coerce) {\n            input.data = String(input.data);\n        }\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.string) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.string,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        const status = new ParseStatus();\n        let ctx = undefined;\n        for (const check of this._def.checks) {\n            if (check.kind === \"min\") {\n                if (input.data.length < check.value) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.too_small,\n                        minimum: check.value,\n                        type: \"string\",\n                        inclusive: true,\n                        exact: false,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"max\") {\n                if (input.data.length > check.value) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.too_big,\n                        maximum: check.value,\n                        type: \"string\",\n                        inclusive: true,\n                        exact: false,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"length\") {\n                const tooBig = input.data.length > check.value;\n                const tooSmall = input.data.length < check.value;\n                if (tooBig || tooSmall) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    if (tooBig) {\n                        addIssueToContext(ctx, {\n                            code: ZodIssueCode.too_big,\n                            maximum: check.value,\n                            type: \"string\",\n                            inclusive: true,\n                            exact: true,\n                            message: check.message,\n                        });\n                    }\n                    else if (tooSmall) {\n                        addIssueToContext(ctx, {\n                            code: ZodIssueCode.too_small,\n                            minimum: check.value,\n                            type: \"string\",\n                            inclusive: true,\n                            exact: true,\n                            message: check.message,\n                        });\n                    }\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"email\") {\n                if (!emailRegex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"email\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"emoji\") {\n                if (!emojiRegex) {\n                    emojiRegex = new RegExp(_emojiRegex, \"u\");\n                }\n                if (!emojiRegex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"emoji\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"uuid\") {\n                if (!uuidRegex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"uuid\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"nanoid\") {\n                if (!nanoidRegex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"nanoid\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"cuid\") {\n                if (!cuidRegex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"cuid\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"cuid2\") {\n                if (!cuid2Regex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"cuid2\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"ulid\") {\n                if (!ulidRegex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"ulid\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"url\") {\n                try {\n                    new URL(input.data);\n                }\n                catch {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"url\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"regex\") {\n                check.regex.lastIndex = 0;\n                const testResult = check.regex.test(input.data);\n                if (!testResult) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"regex\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"trim\") {\n                input.data = input.data.trim();\n            }\n            else if (check.kind === \"includes\") {\n                if (!input.data.includes(check.value, check.position)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.invalid_string,\n                        validation: { includes: check.value, position: check.position },\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"toLowerCase\") {\n                input.data = input.data.toLowerCase();\n            }\n            else if (check.kind === \"toUpperCase\") {\n                input.data = input.data.toUpperCase();\n            }\n            else if (check.kind === \"startsWith\") {\n                if (!input.data.startsWith(check.value)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.invalid_string,\n                        validation: { startsWith: check.value },\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"endsWith\") {\n                if (!input.data.endsWith(check.value)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.invalid_string,\n                        validation: { endsWith: check.value },\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"datetime\") {\n                const regex = datetimeRegex(check);\n                if (!regex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.invalid_string,\n                        validation: \"datetime\",\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"date\") {\n                const regex = dateRegex;\n                if (!regex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.invalid_string,\n                        validation: \"date\",\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"time\") {\n                const regex = timeRegex(check);\n                if (!regex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.invalid_string,\n                        validation: \"time\",\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"duration\") {\n                if (!durationRegex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"duration\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"ip\") {\n                if (!isValidIP(input.data, check.version)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"ip\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"jwt\") {\n                if (!isValidJWT(input.data, check.alg)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"jwt\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"cidr\") {\n                if (!isValidCidr(input.data, check.version)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"cidr\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"base64\") {\n                if (!base64Regex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"base64\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"base64url\") {\n                if (!base64urlRegex.test(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        validation: \"base64url\",\n                        code: ZodIssueCode.invalid_string,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else {\n                util.assertNever(check);\n            }\n        }\n        return { status: status.value, value: input.data };\n    }\n    _regex(regex, validation, message) {\n        return this.refinement((data) => regex.test(data), {\n            validation,\n            code: ZodIssueCode.invalid_string,\n            ...errorUtil.errToObj(message),\n        });\n    }\n    _addCheck(check) {\n        return new ZodString({\n            ...this._def,\n            checks: [...this._def.checks, check],\n        });\n    }\n    email(message) {\n        return this._addCheck({ kind: \"email\", ...errorUtil.errToObj(message) });\n    }\n    url(message) {\n        return this._addCheck({ kind: \"url\", ...errorUtil.errToObj(message) });\n    }\n    emoji(message) {\n        return this._addCheck({ kind: \"emoji\", ...errorUtil.errToObj(message) });\n    }\n    uuid(message) {\n        return this._addCheck({ kind: \"uuid\", ...errorUtil.errToObj(message) });\n    }\n    nanoid(message) {\n        return this._addCheck({ kind: \"nanoid\", ...errorUtil.errToObj(message) });\n    }\n    cuid(message) {\n        return this._addCheck({ kind: \"cuid\", ...errorUtil.errToObj(message) });\n    }\n    cuid2(message) {\n        return this._addCheck({ kind: \"cuid2\", ...errorUtil.errToObj(message) });\n    }\n    ulid(message) {\n        return this._addCheck({ kind: \"ulid\", ...errorUtil.errToObj(message) });\n    }\n    base64(message) {\n        return this._addCheck({ kind: \"base64\", ...errorUtil.errToObj(message) });\n    }\n    base64url(message) {\n        // base64url encoding is a modification of base64 that can safely be used in URLs and filenames\n        return this._addCheck({\n            kind: \"base64url\",\n            ...errorUtil.errToObj(message),\n        });\n    }\n    jwt(options) {\n        return this._addCheck({ kind: \"jwt\", ...errorUtil.errToObj(options) });\n    }\n    ip(options) {\n        return this._addCheck({ kind: \"ip\", ...errorUtil.errToObj(options) });\n    }\n    cidr(options) {\n        return this._addCheck({ kind: \"cidr\", ...errorUtil.errToObj(options) });\n    }\n    datetime(options) {\n        if (typeof options === \"string\") {\n            return this._addCheck({\n                kind: \"datetime\",\n                precision: null,\n                offset: false,\n                local: false,\n                message: options,\n            });\n        }\n        return this._addCheck({\n            kind: \"datetime\",\n            precision: typeof options?.precision === \"undefined\" ? null : options?.precision,\n            offset: options?.offset ?? false,\n            local: options?.local ?? false,\n            ...errorUtil.errToObj(options?.message),\n        });\n    }\n    date(message) {\n        return this._addCheck({ kind: \"date\", message });\n    }\n    time(options) {\n        if (typeof options === \"string\") {\n            return this._addCheck({\n                kind: \"time\",\n                precision: null,\n                message: options,\n            });\n        }\n        return this._addCheck({\n            kind: \"time\",\n            precision: typeof options?.precision === \"undefined\" ? null : options?.precision,\n            ...errorUtil.errToObj(options?.message),\n        });\n    }\n    duration(message) {\n        return this._addCheck({ kind: \"duration\", ...errorUtil.errToObj(message) });\n    }\n    regex(regex, message) {\n        return this._addCheck({\n            kind: \"regex\",\n            regex: regex,\n            ...errorUtil.errToObj(message),\n        });\n    }\n    includes(value, options) {\n        return this._addCheck({\n            kind: \"includes\",\n            value: value,\n            position: options?.position,\n            ...errorUtil.errToObj(options?.message),\n        });\n    }\n    startsWith(value, message) {\n        return this._addCheck({\n            kind: \"startsWith\",\n            value: value,\n            ...errorUtil.errToObj(message),\n        });\n    }\n    endsWith(value, message) {\n        return this._addCheck({\n            kind: \"endsWith\",\n            value: value,\n            ...errorUtil.errToObj(message),\n        });\n    }\n    min(minLength, message) {\n        return this._addCheck({\n            kind: \"min\",\n            value: minLength,\n            ...errorUtil.errToObj(message),\n        });\n    }\n    max(maxLength, message) {\n        return this._addCheck({\n            kind: \"max\",\n            value: maxLength,\n            ...errorUtil.errToObj(message),\n        });\n    }\n    length(len, message) {\n        return this._addCheck({\n            kind: \"length\",\n            value: len,\n            ...errorUtil.errToObj(message),\n        });\n    }\n    /**\n     * Equivalent to `.min(1)`\n     */\n    nonempty(message) {\n        return this.min(1, errorUtil.errToObj(message));\n    }\n    trim() {\n        return new ZodString({\n            ...this._def,\n            checks: [...this._def.checks, { kind: \"trim\" }],\n        });\n    }\n    toLowerCase() {\n        return new ZodString({\n            ...this._def,\n            checks: [...this._def.checks, { kind: \"toLowerCase\" }],\n        });\n    }\n    toUpperCase() {\n        return new ZodString({\n            ...this._def,\n            checks: [...this._def.checks, { kind: \"toUpperCase\" }],\n        });\n    }\n    get isDatetime() {\n        return !!this._def.checks.find((ch) => ch.kind === \"datetime\");\n    }\n    get isDate() {\n        return !!this._def.checks.find((ch) => ch.kind === \"date\");\n    }\n    get isTime() {\n        return !!this._def.checks.find((ch) => ch.kind === \"time\");\n    }\n    get isDuration() {\n        return !!this._def.checks.find((ch) => ch.kind === \"duration\");\n    }\n    get isEmail() {\n        return !!this._def.checks.find((ch) => ch.kind === \"email\");\n    }\n    get isURL() {\n        return !!this._def.checks.find((ch) => ch.kind === \"url\");\n    }\n    get isEmoji() {\n        return !!this._def.checks.find((ch) => ch.kind === \"emoji\");\n    }\n    get isUUID() {\n        return !!this._def.checks.find((ch) => ch.kind === \"uuid\");\n    }\n    get isNANOID() {\n        return !!this._def.checks.find((ch) => ch.kind === \"nanoid\");\n    }\n    get isCUID() {\n        return !!this._def.checks.find((ch) => ch.kind === \"cuid\");\n    }\n    get isCUID2() {\n        return !!this._def.checks.find((ch) => ch.kind === \"cuid2\");\n    }\n    get isULID() {\n        return !!this._def.checks.find((ch) => ch.kind === \"ulid\");\n    }\n    get isIP() {\n        return !!this._def.checks.find((ch) => ch.kind === \"ip\");\n    }\n    get isCIDR() {\n        return !!this._def.checks.find((ch) => ch.kind === \"cidr\");\n    }\n    get isBase64() {\n        return !!this._def.checks.find((ch) => ch.kind === \"base64\");\n    }\n    get isBase64url() {\n        // base64url encoding is a modification of base64 that can safely be used in URLs and filenames\n        return !!this._def.checks.find((ch) => ch.kind === \"base64url\");\n    }\n    get minLength() {\n        let min = null;\n        for (const ch of this._def.checks) {\n            if (ch.kind === \"min\") {\n                if (min === null || ch.value > min)\n                    min = ch.value;\n            }\n        }\n        return min;\n    }\n    get maxLength() {\n        let max = null;\n        for (const ch of this._def.checks) {\n            if (ch.kind === \"max\") {\n                if (max === null || ch.value < max)\n                    max = ch.value;\n            }\n        }\n        return max;\n    }\n}\nZodString.create = (params) => {\n    return new ZodString({\n        checks: [],\n        typeName: ZodFirstPartyTypeKind.ZodString,\n        coerce: params?.coerce ?? false,\n        ...processCreateParams(params),\n    });\n};\n// https://stackoverflow.com/questions/3966484/why-does-modulus-operator-return-fractional-number-in-javascript/31711034#31711034\nfunction floatSafeRemainder(val, step) {\n    const valDecCount = (val.toString().split(\".\")[1] || \"\").length;\n    const stepDecCount = (step.toString().split(\".\")[1] || \"\").length;\n    const decCount = valDecCount > stepDecCount ? valDecCount : stepDecCount;\n    const valInt = Number.parseInt(val.toFixed(decCount).replace(\".\", \"\"));\n    const stepInt = Number.parseInt(step.toFixed(decCount).replace(\".\", \"\"));\n    return (valInt % stepInt) / 10 ** decCount;\n}\nexport class ZodNumber extends ZodType {\n    constructor() {\n        super(...arguments);\n        this.min = this.gte;\n        this.max = this.lte;\n        this.step = this.multipleOf;\n    }\n    _parse(input) {\n        if (this._def.coerce) {\n            input.data = Number(input.data);\n        }\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.number) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.number,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        let ctx = undefined;\n        const status = new ParseStatus();\n        for (const check of this._def.checks) {\n            if (check.kind === \"int\") {\n                if (!util.isInteger(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.invalid_type,\n                        expected: \"integer\",\n                        received: \"float\",\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"min\") {\n                const tooSmall = check.inclusive ? input.data < check.value : input.data <= check.value;\n                if (tooSmall) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.too_small,\n                        minimum: check.value,\n                        type: \"number\",\n                        inclusive: check.inclusive,\n                        exact: false,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"max\") {\n                const tooBig = check.inclusive ? input.data > check.value : input.data >= check.value;\n                if (tooBig) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.too_big,\n                        maximum: check.value,\n                        type: \"number\",\n                        inclusive: check.inclusive,\n                        exact: false,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"multipleOf\") {\n                if (floatSafeRemainder(input.data, check.value) !== 0) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.not_multiple_of,\n                        multipleOf: check.value,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"finite\") {\n                if (!Number.isFinite(input.data)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.not_finite,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else {\n                util.assertNever(check);\n            }\n        }\n        return { status: status.value, value: input.data };\n    }\n    gte(value, message) {\n        return this.setLimit(\"min\", value, true, errorUtil.toString(message));\n    }\n    gt(value, message) {\n        return this.setLimit(\"min\", value, false, errorUtil.toString(message));\n    }\n    lte(value, message) {\n        return this.setLimit(\"max\", value, true, errorUtil.toString(message));\n    }\n    lt(value, message) {\n        return this.setLimit(\"max\", value, false, errorUtil.toString(message));\n    }\n    setLimit(kind, value, inclusive, message) {\n        return new ZodNumber({\n            ...this._def,\n            checks: [\n                ...this._def.checks,\n                {\n                    kind,\n                    value,\n                    inclusive,\n                    message: errorUtil.toString(message),\n                },\n            ],\n        });\n    }\n    _addCheck(check) {\n        return new ZodNumber({\n            ...this._def,\n            checks: [...this._def.checks, check],\n        });\n    }\n    int(message) {\n        return this._addCheck({\n            kind: \"int\",\n            message: errorUtil.toString(message),\n        });\n    }\n    positive(message) {\n        return this._addCheck({\n            kind: \"min\",\n            value: 0,\n            inclusive: false,\n            message: errorUtil.toString(message),\n        });\n    }\n    negative(message) {\n        return this._addCheck({\n            kind: \"max\",\n            value: 0,\n            inclusive: false,\n            message: errorUtil.toString(message),\n        });\n    }\n    nonpositive(message) {\n        return this._addCheck({\n            kind: \"max\",\n            value: 0,\n            inclusive: true,\n            message: errorUtil.toString(message),\n        });\n    }\n    nonnegative(message) {\n        return this._addCheck({\n            kind: \"min\",\n            value: 0,\n            inclusive: true,\n            message: errorUtil.toString(message),\n        });\n    }\n    multipleOf(value, message) {\n        return this._addCheck({\n            kind: \"multipleOf\",\n            value: value,\n            message: errorUtil.toString(message),\n        });\n    }\n    finite(message) {\n        return this._addCheck({\n            kind: \"finite\",\n            message: errorUtil.toString(message),\n        });\n    }\n    safe(message) {\n        return this._addCheck({\n            kind: \"min\",\n            inclusive: true,\n            value: Number.MIN_SAFE_INTEGER,\n            message: errorUtil.toString(message),\n        })._addCheck({\n            kind: \"max\",\n            inclusive: true,\n            value: Number.MAX_SAFE_INTEGER,\n            message: errorUtil.toString(message),\n        });\n    }\n    get minValue() {\n        let min = null;\n        for (const ch of this._def.checks) {\n            if (ch.kind === \"min\") {\n                if (min === null || ch.value > min)\n                    min = ch.value;\n            }\n        }\n        return min;\n    }\n    get maxValue() {\n        let max = null;\n        for (const ch of this._def.checks) {\n            if (ch.kind === \"max\") {\n                if (max === null || ch.value < max)\n                    max = ch.value;\n            }\n        }\n        return max;\n    }\n    get isInt() {\n        return !!this._def.checks.find((ch) => ch.kind === \"int\" || (ch.kind === \"multipleOf\" && util.isInteger(ch.value)));\n    }\n    get isFinite() {\n        let max = null;\n        let min = null;\n        for (const ch of this._def.checks) {\n            if (ch.kind === \"finite\" || ch.kind === \"int\" || ch.kind === \"multipleOf\") {\n                return true;\n            }\n            else if (ch.kind === \"min\") {\n                if (min === null || ch.value > min)\n                    min = ch.value;\n            }\n            else if (ch.kind === \"max\") {\n                if (max === null || ch.value < max)\n                    max = ch.value;\n            }\n        }\n        return Number.isFinite(min) && Number.isFinite(max);\n    }\n}\nZodNumber.create = (params) => {\n    return new ZodNumber({\n        checks: [],\n        typeName: ZodFirstPartyTypeKind.ZodNumber,\n        coerce: params?.coerce || false,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodBigInt extends ZodType {\n    constructor() {\n        super(...arguments);\n        this.min = this.gte;\n        this.max = this.lte;\n    }\n    _parse(input) {\n        if (this._def.coerce) {\n            try {\n                input.data = BigInt(input.data);\n            }\n            catch {\n                return this._getInvalidInput(input);\n            }\n        }\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.bigint) {\n            return this._getInvalidInput(input);\n        }\n        let ctx = undefined;\n        const status = new ParseStatus();\n        for (const check of this._def.checks) {\n            if (check.kind === \"min\") {\n                const tooSmall = check.inclusive ? input.data < check.value : input.data <= check.value;\n                if (tooSmall) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.too_small,\n                        type: \"bigint\",\n                        minimum: check.value,\n                        inclusive: check.inclusive,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"max\") {\n                const tooBig = check.inclusive ? input.data > check.value : input.data >= check.value;\n                if (tooBig) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.too_big,\n                        type: \"bigint\",\n                        maximum: check.value,\n                        inclusive: check.inclusive,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"multipleOf\") {\n                if (input.data % check.value !== BigInt(0)) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.not_multiple_of,\n                        multipleOf: check.value,\n                        message: check.message,\n                    });\n                    status.dirty();\n                }\n            }\n            else {\n                util.assertNever(check);\n            }\n        }\n        return { status: status.value, value: input.data };\n    }\n    _getInvalidInput(input) {\n        const ctx = this._getOrReturnCtx(input);\n        addIssueToContext(ctx, {\n            code: ZodIssueCode.invalid_type,\n            expected: ZodParsedType.bigint,\n            received: ctx.parsedType,\n        });\n        return INVALID;\n    }\n    gte(value, message) {\n        return this.setLimit(\"min\", value, true, errorUtil.toString(message));\n    }\n    gt(value, message) {\n        return this.setLimit(\"min\", value, false, errorUtil.toString(message));\n    }\n    lte(value, message) {\n        return this.setLimit(\"max\", value, true, errorUtil.toString(message));\n    }\n    lt(value, message) {\n        return this.setLimit(\"max\", value, false, errorUtil.toString(message));\n    }\n    setLimit(kind, value, inclusive, message) {\n        return new ZodBigInt({\n            ...this._def,\n            checks: [\n                ...this._def.checks,\n                {\n                    kind,\n                    value,\n                    inclusive,\n                    message: errorUtil.toString(message),\n                },\n            ],\n        });\n    }\n    _addCheck(check) {\n        return new ZodBigInt({\n            ...this._def,\n            checks: [...this._def.checks, check],\n        });\n    }\n    positive(message) {\n        return this._addCheck({\n            kind: \"min\",\n            value: BigInt(0),\n            inclusive: false,\n            message: errorUtil.toString(message),\n        });\n    }\n    negative(message) {\n        return this._addCheck({\n            kind: \"max\",\n            value: BigInt(0),\n            inclusive: false,\n            message: errorUtil.toString(message),\n        });\n    }\n    nonpositive(message) {\n        return this._addCheck({\n            kind: \"max\",\n            value: BigInt(0),\n            inclusive: true,\n            message: errorUtil.toString(message),\n        });\n    }\n    nonnegative(message) {\n        return this._addCheck({\n            kind: \"min\",\n            value: BigInt(0),\n            inclusive: true,\n            message: errorUtil.toString(message),\n        });\n    }\n    multipleOf(value, message) {\n        return this._addCheck({\n            kind: \"multipleOf\",\n            value,\n            message: errorUtil.toString(message),\n        });\n    }\n    get minValue() {\n        let min = null;\n        for (const ch of this._def.checks) {\n            if (ch.kind === \"min\") {\n                if (min === null || ch.value > min)\n                    min = ch.value;\n            }\n        }\n        return min;\n    }\n    get maxValue() {\n        let max = null;\n        for (const ch of this._def.checks) {\n            if (ch.kind === \"max\") {\n                if (max === null || ch.value < max)\n                    max = ch.value;\n            }\n        }\n        return max;\n    }\n}\nZodBigInt.create = (params) => {\n    return new ZodBigInt({\n        checks: [],\n        typeName: ZodFirstPartyTypeKind.ZodBigInt,\n        coerce: params?.coerce ?? false,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodBoolean extends ZodType {\n    _parse(input) {\n        if (this._def.coerce) {\n            input.data = Boolean(input.data);\n        }\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.boolean) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.boolean,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        return OK(input.data);\n    }\n}\nZodBoolean.create = (params) => {\n    return new ZodBoolean({\n        typeName: ZodFirstPartyTypeKind.ZodBoolean,\n        coerce: params?.coerce || false,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodDate extends ZodType {\n    _parse(input) {\n        if (this._def.coerce) {\n            input.data = new Date(input.data);\n        }\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.date) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.date,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        if (Number.isNaN(input.data.getTime())) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_date,\n            });\n            return INVALID;\n        }\n        const status = new ParseStatus();\n        let ctx = undefined;\n        for (const check of this._def.checks) {\n            if (check.kind === \"min\") {\n                if (input.data.getTime() < check.value) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.too_small,\n                        message: check.message,\n                        inclusive: true,\n                        exact: false,\n                        minimum: check.value,\n                        type: \"date\",\n                    });\n                    status.dirty();\n                }\n            }\n            else if (check.kind === \"max\") {\n                if (input.data.getTime() > check.value) {\n                    ctx = this._getOrReturnCtx(input, ctx);\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.too_big,\n                        message: check.message,\n                        inclusive: true,\n                        exact: false,\n                        maximum: check.value,\n                        type: \"date\",\n                    });\n                    status.dirty();\n                }\n            }\n            else {\n                util.assertNever(check);\n            }\n        }\n        return {\n            status: status.value,\n            value: new Date(input.data.getTime()),\n        };\n    }\n    _addCheck(check) {\n        return new ZodDate({\n            ...this._def,\n            checks: [...this._def.checks, check],\n        });\n    }\n    min(minDate, message) {\n        return this._addCheck({\n            kind: \"min\",\n            value: minDate.getTime(),\n            message: errorUtil.toString(message),\n        });\n    }\n    max(maxDate, message) {\n        return this._addCheck({\n            kind: \"max\",\n            value: maxDate.getTime(),\n            message: errorUtil.toString(message),\n        });\n    }\n    get minDate() {\n        let min = null;\n        for (const ch of this._def.checks) {\n            if (ch.kind === \"min\") {\n                if (min === null || ch.value > min)\n                    min = ch.value;\n            }\n        }\n        return min != null ? new Date(min) : null;\n    }\n    get maxDate() {\n        let max = null;\n        for (const ch of this._def.checks) {\n            if (ch.kind === \"max\") {\n                if (max === null || ch.value < max)\n                    max = ch.value;\n            }\n        }\n        return max != null ? new Date(max) : null;\n    }\n}\nZodDate.create = (params) => {\n    return new ZodDate({\n        checks: [],\n        coerce: params?.coerce || false,\n        typeName: ZodFirstPartyTypeKind.ZodDate,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodSymbol extends ZodType {\n    _parse(input) {\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.symbol) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.symbol,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        return OK(input.data);\n    }\n}\nZodSymbol.create = (params) => {\n    return new ZodSymbol({\n        typeName: ZodFirstPartyTypeKind.ZodSymbol,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodUndefined extends ZodType {\n    _parse(input) {\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.undefined) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.undefined,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        return OK(input.data);\n    }\n}\nZodUndefined.create = (params) => {\n    return new ZodUndefined({\n        typeName: ZodFirstPartyTypeKind.ZodUndefined,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodNull extends ZodType {\n    _parse(input) {\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.null) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.null,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        return OK(input.data);\n    }\n}\nZodNull.create = (params) => {\n    return new ZodNull({\n        typeName: ZodFirstPartyTypeKind.ZodNull,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodAny extends ZodType {\n    constructor() {\n        super(...arguments);\n        // to prevent instances of other classes from extending ZodAny. this causes issues with catchall in ZodObject.\n        this._any = true;\n    }\n    _parse(input) {\n        return OK(input.data);\n    }\n}\nZodAny.create = (params) => {\n    return new ZodAny({\n        typeName: ZodFirstPartyTypeKind.ZodAny,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodUnknown extends ZodType {\n    constructor() {\n        super(...arguments);\n        // required\n        this._unknown = true;\n    }\n    _parse(input) {\n        return OK(input.data);\n    }\n}\nZodUnknown.create = (params) => {\n    return new ZodUnknown({\n        typeName: ZodFirstPartyTypeKind.ZodUnknown,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodNever extends ZodType {\n    _parse(input) {\n        const ctx = this._getOrReturnCtx(input);\n        addIssueToContext(ctx, {\n            code: ZodIssueCode.invalid_type,\n            expected: ZodParsedType.never,\n            received: ctx.parsedType,\n        });\n        return INVALID;\n    }\n}\nZodNever.create = (params) => {\n    return new ZodNever({\n        typeName: ZodFirstPartyTypeKind.ZodNever,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodVoid extends ZodType {\n    _parse(input) {\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.undefined) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.void,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        return OK(input.data);\n    }\n}\nZodVoid.create = (params) => {\n    return new ZodVoid({\n        typeName: ZodFirstPartyTypeKind.ZodVoid,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodArray extends ZodType {\n    _parse(input) {\n        const { ctx, status } = this._processInputParams(input);\n        const def = this._def;\n        if (ctx.parsedType !== ZodParsedType.array) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.array,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        if (def.exactLength !== null) {\n            const tooBig = ctx.data.length > def.exactLength.value;\n            const tooSmall = ctx.data.length < def.exactLength.value;\n            if (tooBig || tooSmall) {\n                addIssueToContext(ctx, {\n                    code: tooBig ? ZodIssueCode.too_big : ZodIssueCode.too_small,\n                    minimum: (tooSmall ? def.exactLength.value : undefined),\n                    maximum: (tooBig ? def.exactLength.value : undefined),\n                    type: \"array\",\n                    inclusive: true,\n                    exact: true,\n                    message: def.exactLength.message,\n                });\n                status.dirty();\n            }\n        }\n        if (def.minLength !== null) {\n            if (ctx.data.length < def.minLength.value) {\n                addIssueToContext(ctx, {\n                    code: ZodIssueCode.too_small,\n                    minimum: def.minLength.value,\n                    type: \"array\",\n                    inclusive: true,\n                    exact: false,\n                    message: def.minLength.message,\n                });\n                status.dirty();\n            }\n        }\n        if (def.maxLength !== null) {\n            if (ctx.data.length > def.maxLength.value) {\n                addIssueToContext(ctx, {\n                    code: ZodIssueCode.too_big,\n                    maximum: def.maxLength.value,\n                    type: \"array\",\n                    inclusive: true,\n                    exact: false,\n                    message: def.maxLength.message,\n                });\n                status.dirty();\n            }\n        }\n        if (ctx.common.async) {\n            return Promise.all([...ctx.data].map((item, i) => {\n                return def.type._parseAsync(new ParseInputLazyPath(ctx, item, ctx.path, i));\n            })).then((result) => {\n                return ParseStatus.mergeArray(status, result);\n            });\n        }\n        const result = [...ctx.data].map((item, i) => {\n            return def.type._parseSync(new ParseInputLazyPath(ctx, item, ctx.path, i));\n        });\n        return ParseStatus.mergeArray(status, result);\n    }\n    get element() {\n        return this._def.type;\n    }\n    min(minLength, message) {\n        return new ZodArray({\n            ...this._def,\n            minLength: { value: minLength, message: errorUtil.toString(message) },\n        });\n    }\n    max(maxLength, message) {\n        return new ZodArray({\n            ...this._def,\n            maxLength: { value: maxLength, message: errorUtil.toString(message) },\n        });\n    }\n    length(len, message) {\n        return new ZodArray({\n            ...this._def,\n            exactLength: { value: len, message: errorUtil.toString(message) },\n        });\n    }\n    nonempty(message) {\n        return this.min(1, message);\n    }\n}\nZodArray.create = (schema, params) => {\n    return new ZodArray({\n        type: schema,\n        minLength: null,\n        maxLength: null,\n        exactLength: null,\n        typeName: ZodFirstPartyTypeKind.ZodArray,\n        ...processCreateParams(params),\n    });\n};\nfunction deepPartialify(schema) {\n    if (schema instanceof ZodObject) {\n        const newShape = {};\n        for (const key in schema.shape) {\n            const fieldSchema = schema.shape[key];\n            newShape[key] = ZodOptional.create(deepPartialify(fieldSchema));\n        }\n        return new ZodObject({\n            ...schema._def,\n            shape: () => newShape,\n        });\n    }\n    else if (schema instanceof ZodArray) {\n        return new ZodArray({\n            ...schema._def,\n            type: deepPartialify(schema.element),\n        });\n    }\n    else if (schema instanceof ZodOptional) {\n        return ZodOptional.create(deepPartialify(schema.unwrap()));\n    }\n    else if (schema instanceof ZodNullable) {\n        return ZodNullable.create(deepPartialify(schema.unwrap()));\n    }\n    else if (schema instanceof ZodTuple) {\n        return ZodTuple.create(schema.items.map((item) => deepPartialify(item)));\n    }\n    else {\n        return schema;\n    }\n}\nexport class ZodObject extends ZodType {\n    constructor() {\n        super(...arguments);\n        this._cached = null;\n        /**\n         * @deprecated In most cases, this is no longer needed - unknown properties are now silently stripped.\n         * If you want to pass through unknown properties, use `.passthrough()` instead.\n         */\n        this.nonstrict = this.passthrough;\n        // extend<\n        //   Augmentation extends ZodRawShape,\n        //   NewOutput extends util.flatten<{\n        //     [k in keyof Augmentation | keyof Output]: k extends keyof Augmentation\n        //       ? Augmentation[k][\"_output\"]\n        //       : k extends keyof Output\n        //       ? Output[k]\n        //       : never;\n        //   }>,\n        //   NewInput extends util.flatten<{\n        //     [k in keyof Augmentation | keyof Input]: k extends keyof Augmentation\n        //       ? Augmentation[k][\"_input\"]\n        //       : k extends keyof Input\n        //       ? Input[k]\n        //       : never;\n        //   }>\n        // >(\n        //   augmentation: Augmentation\n        // ): ZodObject<\n        //   extendShape<T, Augmentation>,\n        //   UnknownKeys,\n        //   Catchall,\n        //   NewOutput,\n        //   NewInput\n        // > {\n        //   return new ZodObject({\n        //     ...this._def,\n        //     shape: () => ({\n        //       ...this._def.shape(),\n        //       ...augmentation,\n        //     }),\n        //   }) as any;\n        // }\n        /**\n         * @deprecated Use `.extend` instead\n         *  */\n        this.augment = this.extend;\n    }\n    _getCached() {\n        if (this._cached !== null)\n            return this._cached;\n        const shape = this._def.shape();\n        const keys = util.objectKeys(shape);\n        this._cached = { shape, keys };\n        return this._cached;\n    }\n    _parse(input) {\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.object) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.object,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        const { status, ctx } = this._processInputParams(input);\n        const { shape, keys: shapeKeys } = this._getCached();\n        const extraKeys = [];\n        if (!(this._def.catchall instanceof ZodNever && this._def.unknownKeys === \"strip\")) {\n            for (const key in ctx.data) {\n                if (!shapeKeys.includes(key)) {\n                    extraKeys.push(key);\n                }\n            }\n        }\n        const pairs = [];\n        for (const key of shapeKeys) {\n            const keyValidator = shape[key];\n            const value = ctx.data[key];\n            pairs.push({\n                key: { status: \"valid\", value: key },\n                value: keyValidator._parse(new ParseInputLazyPath(ctx, value, ctx.path, key)),\n                alwaysSet: key in ctx.data,\n            });\n        }\n        if (this._def.catchall instanceof ZodNever) {\n            const unknownKeys = this._def.unknownKeys;\n            if (unknownKeys === \"passthrough\") {\n                for (const key of extraKeys) {\n                    pairs.push({\n                        key: { status: \"valid\", value: key },\n                        value: { status: \"valid\", value: ctx.data[key] },\n                    });\n                }\n            }\n            else if (unknownKeys === \"strict\") {\n                if (extraKeys.length > 0) {\n                    addIssueToContext(ctx, {\n                        code: ZodIssueCode.unrecognized_keys,\n                        keys: extraKeys,\n                    });\n                    status.dirty();\n                }\n            }\n            else if (unknownKeys === \"strip\") {\n            }\n            else {\n                throw new Error(`Internal ZodObject error: invalid unknownKeys value.`);\n            }\n        }\n        else {\n            // run catchall validation\n            const catchall = this._def.catchall;\n            for (const key of extraKeys) {\n                const value = ctx.data[key];\n                pairs.push({\n                    key: { status: \"valid\", value: key },\n                    value: catchall._parse(new ParseInputLazyPath(ctx, value, ctx.path, key) //, ctx.child(key), value, getParsedType(value)\n                    ),\n                    alwaysSet: key in ctx.data,\n                });\n            }\n        }\n        if (ctx.common.async) {\n            return Promise.resolve()\n                .then(async () => {\n                const syncPairs = [];\n                for (const pair of pairs) {\n                    const key = await pair.key;\n                    const value = await pair.value;\n                    syncPairs.push({\n                        key,\n                        value,\n                        alwaysSet: pair.alwaysSet,\n                    });\n                }\n                return syncPairs;\n            })\n                .then((syncPairs) => {\n                return ParseStatus.mergeObjectSync(status, syncPairs);\n            });\n        }\n        else {\n            return ParseStatus.mergeObjectSync(status, pairs);\n        }\n    }\n    get shape() {\n        return this._def.shape();\n    }\n    strict(message) {\n        errorUtil.errToObj;\n        return new ZodObject({\n            ...this._def,\n            unknownKeys: \"strict\",\n            ...(message !== undefined\n                ? {\n                    errorMap: (issue, ctx) => {\n                        const defaultError = this._def.errorMap?.(issue, ctx).message ?? ctx.defaultError;\n                        if (issue.code === \"unrecognized_keys\")\n                            return {\n                                message: errorUtil.errToObj(message).message ?? defaultError,\n                            };\n                        return {\n                            message: defaultError,\n                        };\n                    },\n                }\n                : {}),\n        });\n    }\n    strip() {\n        return new ZodObject({\n            ...this._def,\n            unknownKeys: \"strip\",\n        });\n    }\n    passthrough() {\n        return new ZodObject({\n            ...this._def,\n            unknownKeys: \"passthrough\",\n        });\n    }\n    // const AugmentFactory =\n    //   <Def extends ZodObjectDef>(def: Def) =>\n    //   <Augmentation extends ZodRawShape>(\n    //     augmentation: Augmentation\n    //   ): ZodObject<\n    //     extendShape<ReturnType<Def[\"shape\"]>, Augmentation>,\n    //     Def[\"unknownKeys\"],\n    //     Def[\"catchall\"]\n    //   > => {\n    //     return new ZodObject({\n    //       ...def,\n    //       shape: () => ({\n    //         ...def.shape(),\n    //         ...augmentation,\n    //       }),\n    //     }) as any;\n    //   };\n    extend(augmentation) {\n        return new ZodObject({\n            ...this._def,\n            shape: () => ({\n                ...this._def.shape(),\n                ...augmentation,\n            }),\n        });\n    }\n    /**\n     * Prior to zod@1.0.12 there was a bug in the\n     * inferred type of merged objects. Please\n     * upgrade if you are experiencing issues.\n     */\n    merge(merging) {\n        const merged = new ZodObject({\n            unknownKeys: merging._def.unknownKeys,\n            catchall: merging._def.catchall,\n            shape: () => ({\n                ...this._def.shape(),\n                ...merging._def.shape(),\n            }),\n            typeName: ZodFirstPartyTypeKind.ZodObject,\n        });\n        return merged;\n    }\n    // merge<\n    //   Incoming extends AnyZodObject,\n    //   Augmentation extends Incoming[\"shape\"],\n    //   NewOutput extends {\n    //     [k in keyof Augmentation | keyof Output]: k extends keyof Augmentation\n    //       ? Augmentation[k][\"_output\"]\n    //       : k extends keyof Output\n    //       ? Output[k]\n    //       : never;\n    //   },\n    //   NewInput extends {\n    //     [k in keyof Augmentation | keyof Input]: k extends keyof Augmentation\n    //       ? Augmentation[k][\"_input\"]\n    //       : k extends keyof Input\n    //       ? Input[k]\n    //       : never;\n    //   }\n    // >(\n    //   merging: Incoming\n    // ): ZodObject<\n    //   extendShape<T, ReturnType<Incoming[\"_def\"][\"shape\"]>>,\n    //   Incoming[\"_def\"][\"unknownKeys\"],\n    //   Incoming[\"_def\"][\"catchall\"],\n    //   NewOutput,\n    //   NewInput\n    // > {\n    //   const merged: any = new ZodObject({\n    //     unknownKeys: merging._def.unknownKeys,\n    //     catchall: merging._def.catchall,\n    //     shape: () =>\n    //       objectUtil.mergeShapes(this._def.shape(), merging._def.shape()),\n    //     typeName: ZodFirstPartyTypeKind.ZodObject,\n    //   }) as any;\n    //   return merged;\n    // }\n    setKey(key, schema) {\n        return this.augment({ [key]: schema });\n    }\n    // merge<Incoming extends AnyZodObject>(\n    //   merging: Incoming\n    // ): //ZodObject<T & Incoming[\"_shape\"], UnknownKeys, Catchall> = (merging) => {\n    // ZodObject<\n    //   extendShape<T, ReturnType<Incoming[\"_def\"][\"shape\"]>>,\n    //   Incoming[\"_def\"][\"unknownKeys\"],\n    //   Incoming[\"_def\"][\"catchall\"]\n    // > {\n    //   // const mergedShape = objectUtil.mergeShapes(\n    //   //   this._def.shape(),\n    //   //   merging._def.shape()\n    //   // );\n    //   const merged: any = new ZodObject({\n    //     unknownKeys: merging._def.unknownKeys,\n    //     catchall: merging._def.catchall,\n    //     shape: () =>\n    //       objectUtil.mergeShapes(this._def.shape(), merging._def.shape()),\n    //     typeName: ZodFirstPartyTypeKind.ZodObject,\n    //   }) as any;\n    //   return merged;\n    // }\n    catchall(index) {\n        return new ZodObject({\n            ...this._def,\n            catchall: index,\n        });\n    }\n    pick(mask) {\n        const shape = {};\n        for (const key of util.objectKeys(mask)) {\n            if (mask[key] && this.shape[key]) {\n                shape[key] = this.shape[key];\n            }\n        }\n        return new ZodObject({\n            ...this._def,\n            shape: () => shape,\n        });\n    }\n    omit(mask) {\n        const shape = {};\n        for (const key of util.objectKeys(this.shape)) {\n            if (!mask[key]) {\n                shape[key] = this.shape[key];\n            }\n        }\n        return new ZodObject({\n            ...this._def,\n            shape: () => shape,\n        });\n    }\n    /**\n     * @deprecated\n     */\n    deepPartial() {\n        return deepPartialify(this);\n    }\n    partial(mask) {\n        const newShape = {};\n        for (const key of util.objectKeys(this.shape)) {\n            const fieldSchema = this.shape[key];\n            if (mask && !mask[key]) {\n                newShape[key] = fieldSchema;\n            }\n            else {\n                newShape[key] = fieldSchema.optional();\n            }\n        }\n        return new ZodObject({\n            ...this._def,\n            shape: () => newShape,\n        });\n    }\n    required(mask) {\n        const newShape = {};\n        for (const key of util.objectKeys(this.shape)) {\n            if (mask && !mask[key]) {\n                newShape[key] = this.shape[key];\n            }\n            else {\n                const fieldSchema = this.shape[key];\n                let newField = fieldSchema;\n                while (newField instanceof ZodOptional) {\n                    newField = newField._def.innerType;\n                }\n                newShape[key] = newField;\n            }\n        }\n        return new ZodObject({\n            ...this._def,\n            shape: () => newShape,\n        });\n    }\n    keyof() {\n        return createZodEnum(util.objectKeys(this.shape));\n    }\n}\nZodObject.create = (shape, params) => {\n    return new ZodObject({\n        shape: () => shape,\n        unknownKeys: \"strip\",\n        catchall: ZodNever.create(),\n        typeName: ZodFirstPartyTypeKind.ZodObject,\n        ...processCreateParams(params),\n    });\n};\nZodObject.strictCreate = (shape, params) => {\n    return new ZodObject({\n        shape: () => shape,\n        unknownKeys: \"strict\",\n        catchall: ZodNever.create(),\n        typeName: ZodFirstPartyTypeKind.ZodObject,\n        ...processCreateParams(params),\n    });\n};\nZodObject.lazycreate = (shape, params) => {\n    return new ZodObject({\n        shape,\n        unknownKeys: \"strip\",\n        catchall: ZodNever.create(),\n        typeName: ZodFirstPartyTypeKind.ZodObject,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodUnion extends ZodType {\n    _parse(input) {\n        const { ctx } = this._processInputParams(input);\n        const options = this._def.options;\n        function handleResults(results) {\n            // return first issue-free validation if it exists\n            for (const result of results) {\n                if (result.result.status === \"valid\") {\n                    return result.result;\n                }\n            }\n            for (const result of results) {\n                if (result.result.status === \"dirty\") {\n                    // add issues from dirty option\n                    ctx.common.issues.push(...result.ctx.common.issues);\n                    return result.result;\n                }\n            }\n            // return invalid\n            const unionErrors = results.map((result) => new ZodError(result.ctx.common.issues));\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_union,\n                unionErrors,\n            });\n            return INVALID;\n        }\n        if (ctx.common.async) {\n            return Promise.all(options.map(async (option) => {\n                const childCtx = {\n                    ...ctx,\n                    common: {\n                        ...ctx.common,\n                        issues: [],\n                    },\n                    parent: null,\n                };\n                return {\n                    result: await option._parseAsync({\n                        data: ctx.data,\n                        path: ctx.path,\n                        parent: childCtx,\n                    }),\n                    ctx: childCtx,\n                };\n            })).then(handleResults);\n        }\n        else {\n            let dirty = undefined;\n            const issues = [];\n            for (const option of options) {\n                const childCtx = {\n                    ...ctx,\n                    common: {\n                        ...ctx.common,\n                        issues: [],\n                    },\n                    parent: null,\n                };\n                const result = option._parseSync({\n                    data: ctx.data,\n                    path: ctx.path,\n                    parent: childCtx,\n                });\n                if (result.status === \"valid\") {\n                    return result;\n                }\n                else if (result.status === \"dirty\" && !dirty) {\n                    dirty = { result, ctx: childCtx };\n                }\n                if (childCtx.common.issues.length) {\n                    issues.push(childCtx.common.issues);\n                }\n            }\n            if (dirty) {\n                ctx.common.issues.push(...dirty.ctx.common.issues);\n                return dirty.result;\n            }\n            const unionErrors = issues.map((issues) => new ZodError(issues));\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_union,\n                unionErrors,\n            });\n            return INVALID;\n        }\n    }\n    get options() {\n        return this._def.options;\n    }\n}\nZodUnion.create = (types, params) => {\n    return new ZodUnion({\n        options: types,\n        typeName: ZodFirstPartyTypeKind.ZodUnion,\n        ...processCreateParams(params),\n    });\n};\n/////////////////////////////////////////////////////\n/////////////////////////////////////////////////////\n//////////                                 //////////\n//////////      ZodDiscriminatedUnion      //////////\n//////////                                 //////////\n/////////////////////////////////////////////////////\n/////////////////////////////////////////////////////\nconst getDiscriminator = (type) => {\n    if (type instanceof ZodLazy) {\n        return getDiscriminator(type.schema);\n    }\n    else if (type instanceof ZodEffects) {\n        return getDiscriminator(type.innerType());\n    }\n    else if (type instanceof ZodLiteral) {\n        return [type.value];\n    }\n    else if (type instanceof ZodEnum) {\n        return type.options;\n    }\n    else if (type instanceof ZodNativeEnum) {\n        // eslint-disable-next-line ban/ban\n        return util.objectValues(type.enum);\n    }\n    else if (type instanceof ZodDefault) {\n        return getDiscriminator(type._def.innerType);\n    }\n    else if (type instanceof ZodUndefined) {\n        return [undefined];\n    }\n    else if (type instanceof ZodNull) {\n        return [null];\n    }\n    else if (type instanceof ZodOptional) {\n        return [undefined, ...getDiscriminator(type.unwrap())];\n    }\n    else if (type instanceof ZodNullable) {\n        return [null, ...getDiscriminator(type.unwrap())];\n    }\n    else if (type instanceof ZodBranded) {\n        return getDiscriminator(type.unwrap());\n    }\n    else if (type instanceof ZodReadonly) {\n        return getDiscriminator(type.unwrap());\n    }\n    else if (type instanceof ZodCatch) {\n        return getDiscriminator(type._def.innerType);\n    }\n    else {\n        return [];\n    }\n};\nexport class ZodDiscriminatedUnion extends ZodType {\n    _parse(input) {\n        const { ctx } = this._processInputParams(input);\n        if (ctx.parsedType !== ZodParsedType.object) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.object,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        const discriminator = this.discriminator;\n        const discriminatorValue = ctx.data[discriminator];\n        const option = this.optionsMap.get(discriminatorValue);\n        if (!option) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_union_discriminator,\n                options: Array.from(this.optionsMap.keys()),\n                path: [discriminator],\n            });\n            return INVALID;\n        }\n        if (ctx.common.async) {\n            return option._parseAsync({\n                data: ctx.data,\n                path: ctx.path,\n                parent: ctx,\n            });\n        }\n        else {\n            return option._parseSync({\n                data: ctx.data,\n                path: ctx.path,\n                parent: ctx,\n            });\n        }\n    }\n    get discriminator() {\n        return this._def.discriminator;\n    }\n    get options() {\n        return this._def.options;\n    }\n    get optionsMap() {\n        return this._def.optionsMap;\n    }\n    /**\n     * The constructor of the discriminated union schema. Its behaviour is very similar to that of the normal z.union() constructor.\n     * However, it only allows a union of objects, all of which need to share a discriminator property. This property must\n     * have a different value for each object in the union.\n     * @param discriminator the name of the discriminator property\n     * @param types an array of object schemas\n     * @param params\n     */\n    static create(discriminator, options, params) {\n        // Get all the valid discriminator values\n        const optionsMap = new Map();\n        // try {\n        for (const type of options) {\n            const discriminatorValues = getDiscriminator(type.shape[discriminator]);\n            if (!discriminatorValues.length) {\n                throw new Error(`A discriminator value for key \\`${discriminator}\\` could not be extracted from all schema options`);\n            }\n            for (const value of discriminatorValues) {\n                if (optionsMap.has(value)) {\n                    throw new Error(`Discriminator property ${String(discriminator)} has duplicate value ${String(value)}`);\n                }\n                optionsMap.set(value, type);\n            }\n        }\n        return new ZodDiscriminatedUnion({\n            typeName: ZodFirstPartyTypeKind.ZodDiscriminatedUnion,\n            discriminator,\n            options,\n            optionsMap,\n            ...processCreateParams(params),\n        });\n    }\n}\nfunction mergeValues(a, b) {\n    const aType = getParsedType(a);\n    const bType = getParsedType(b);\n    if (a === b) {\n        return { valid: true, data: a };\n    }\n    else if (aType === ZodParsedType.object && bType === ZodParsedType.object) {\n        const bKeys = util.objectKeys(b);\n        const sharedKeys = util.objectKeys(a).filter((key) => bKeys.indexOf(key) !== -1);\n        const newObj = { ...a, ...b };\n        for (const key of sharedKeys) {\n            const sharedValue = mergeValues(a[key], b[key]);\n            if (!sharedValue.valid) {\n                return { valid: false };\n            }\n            newObj[key] = sharedValue.data;\n        }\n        return { valid: true, data: newObj };\n    }\n    else if (aType === ZodParsedType.array && bType === ZodParsedType.array) {\n        if (a.length !== b.length) {\n            return { valid: false };\n        }\n        const newArray = [];\n        for (let index = 0; index < a.length; index++) {\n            const itemA = a[index];\n            const itemB = b[index];\n            const sharedValue = mergeValues(itemA, itemB);\n            if (!sharedValue.valid) {\n                return { valid: false };\n            }\n            newArray.push(sharedValue.data);\n        }\n        return { valid: true, data: newArray };\n    }\n    else if (aType === ZodParsedType.date && bType === ZodParsedType.date && +a === +b) {\n        return { valid: true, data: a };\n    }\n    else {\n        return { valid: false };\n    }\n}\nexport class ZodIntersection extends ZodType {\n    _parse(input) {\n        const { status, ctx } = this._processInputParams(input);\n        const handleParsed = (parsedLeft, parsedRight) => {\n            if (isAborted(parsedLeft) || isAborted(parsedRight)) {\n                return INVALID;\n            }\n            const merged = mergeValues(parsedLeft.value, parsedRight.value);\n            if (!merged.valid) {\n                addIssueToContext(ctx, {\n                    code: ZodIssueCode.invalid_intersection_types,\n                });\n                return INVALID;\n            }\n            if (isDirty(parsedLeft) || isDirty(parsedRight)) {\n                status.dirty();\n            }\n            return { status: status.value, value: merged.data };\n        };\n        if (ctx.common.async) {\n            return Promise.all([\n                this._def.left._parseAsync({\n                    data: ctx.data,\n                    path: ctx.path,\n                    parent: ctx,\n                }),\n                this._def.right._parseAsync({\n                    data: ctx.data,\n                    path: ctx.path,\n                    parent: ctx,\n                }),\n            ]).then(([left, right]) => handleParsed(left, right));\n        }\n        else {\n            return handleParsed(this._def.left._parseSync({\n                data: ctx.data,\n                path: ctx.path,\n                parent: ctx,\n            }), this._def.right._parseSync({\n                data: ctx.data,\n                path: ctx.path,\n                parent: ctx,\n            }));\n        }\n    }\n}\nZodIntersection.create = (left, right, params) => {\n    return new ZodIntersection({\n        left: left,\n        right: right,\n        typeName: ZodFirstPartyTypeKind.ZodIntersection,\n        ...processCreateParams(params),\n    });\n};\n// type ZodTupleItems = [ZodTypeAny, ...ZodTypeAny[]];\nexport class ZodTuple extends ZodType {\n    _parse(input) {\n        const { status, ctx } = this._processInputParams(input);\n        if (ctx.parsedType !== ZodParsedType.array) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.array,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        if (ctx.data.length < this._def.items.length) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.too_small,\n                minimum: this._def.items.length,\n                inclusive: true,\n                exact: false,\n                type: \"array\",\n            });\n            return INVALID;\n        }\n        const rest = this._def.rest;\n        if (!rest && ctx.data.length > this._def.items.length) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.too_big,\n                maximum: this._def.items.length,\n                inclusive: true,\n                exact: false,\n                type: \"array\",\n            });\n            status.dirty();\n        }\n        const items = [...ctx.data]\n            .map((item, itemIndex) => {\n            const schema = this._def.items[itemIndex] || this._def.rest;\n            if (!schema)\n                return null;\n            return schema._parse(new ParseInputLazyPath(ctx, item, ctx.path, itemIndex));\n        })\n            .filter((x) => !!x); // filter nulls\n        if (ctx.common.async) {\n            return Promise.all(items).then((results) => {\n                return ParseStatus.mergeArray(status, results);\n            });\n        }\n        else {\n            return ParseStatus.mergeArray(status, items);\n        }\n    }\n    get items() {\n        return this._def.items;\n    }\n    rest(rest) {\n        return new ZodTuple({\n            ...this._def,\n            rest,\n        });\n    }\n}\nZodTuple.create = (schemas, params) => {\n    if (!Array.isArray(schemas)) {\n        throw new Error(\"You must pass an array of schemas to z.tuple([ ... ])\");\n    }\n    return new ZodTuple({\n        items: schemas,\n        typeName: ZodFirstPartyTypeKind.ZodTuple,\n        rest: null,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodRecord extends ZodType {\n    get keySchema() {\n        return this._def.keyType;\n    }\n    get valueSchema() {\n        return this._def.valueType;\n    }\n    _parse(input) {\n        const { status, ctx } = this._processInputParams(input);\n        if (ctx.parsedType !== ZodParsedType.object) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.object,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        const pairs = [];\n        const keyType = this._def.keyType;\n        const valueType = this._def.valueType;\n        for (const key in ctx.data) {\n            pairs.push({\n                key: keyType._parse(new ParseInputLazyPath(ctx, key, ctx.path, key)),\n                value: valueType._parse(new ParseInputLazyPath(ctx, ctx.data[key], ctx.path, key)),\n                alwaysSet: key in ctx.data,\n            });\n        }\n        if (ctx.common.async) {\n            return ParseStatus.mergeObjectAsync(status, pairs);\n        }\n        else {\n            return ParseStatus.mergeObjectSync(status, pairs);\n        }\n    }\n    get element() {\n        return this._def.valueType;\n    }\n    static create(first, second, third) {\n        if (second instanceof ZodType) {\n            return new ZodRecord({\n                keyType: first,\n                valueType: second,\n                typeName: ZodFirstPartyTypeKind.ZodRecord,\n                ...processCreateParams(third),\n            });\n        }\n        return new ZodRecord({\n            keyType: ZodString.create(),\n            valueType: first,\n            typeName: ZodFirstPartyTypeKind.ZodRecord,\n            ...processCreateParams(second),\n        });\n    }\n}\nexport class ZodMap extends ZodType {\n    get keySchema() {\n        return this._def.keyType;\n    }\n    get valueSchema() {\n        return this._def.valueType;\n    }\n    _parse(input) {\n        const { status, ctx } = this._processInputParams(input);\n        if (ctx.parsedType !== ZodParsedType.map) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.map,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        const keyType = this._def.keyType;\n        const valueType = this._def.valueType;\n        const pairs = [...ctx.data.entries()].map(([key, value], index) => {\n            return {\n                key: keyType._parse(new ParseInputLazyPath(ctx, key, ctx.path, [index, \"key\"])),\n                value: valueType._parse(new ParseInputLazyPath(ctx, value, ctx.path, [index, \"value\"])),\n            };\n        });\n        if (ctx.common.async) {\n            const finalMap = new Map();\n            return Promise.resolve().then(async () => {\n                for (const pair of pairs) {\n                    const key = await pair.key;\n                    const value = await pair.value;\n                    if (key.status === \"aborted\" || value.status === \"aborted\") {\n                        return INVALID;\n                    }\n                    if (key.status === \"dirty\" || value.status === \"dirty\") {\n                        status.dirty();\n                    }\n                    finalMap.set(key.value, value.value);\n                }\n                return { status: status.value, value: finalMap };\n            });\n        }\n        else {\n            const finalMap = new Map();\n            for (const pair of pairs) {\n                const key = pair.key;\n                const value = pair.value;\n                if (key.status === \"aborted\" || value.status === \"aborted\") {\n                    return INVALID;\n                }\n                if (key.status === \"dirty\" || value.status === \"dirty\") {\n                    status.dirty();\n                }\n                finalMap.set(key.value, value.value);\n            }\n            return { status: status.value, value: finalMap };\n        }\n    }\n}\nZodMap.create = (keyType, valueType, params) => {\n    return new ZodMap({\n        valueType,\n        keyType,\n        typeName: ZodFirstPartyTypeKind.ZodMap,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodSet extends ZodType {\n    _parse(input) {\n        const { status, ctx } = this._processInputParams(input);\n        if (ctx.parsedType !== ZodParsedType.set) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.set,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        const def = this._def;\n        if (def.minSize !== null) {\n            if (ctx.data.size < def.minSize.value) {\n                addIssueToContext(ctx, {\n                    code: ZodIssueCode.too_small,\n                    minimum: def.minSize.value,\n                    type: \"set\",\n                    inclusive: true,\n                    exact: false,\n                    message: def.minSize.message,\n                });\n                status.dirty();\n            }\n        }\n        if (def.maxSize !== null) {\n            if (ctx.data.size > def.maxSize.value) {\n                addIssueToContext(ctx, {\n                    code: ZodIssueCode.too_big,\n                    maximum: def.maxSize.value,\n                    type: \"set\",\n                    inclusive: true,\n                    exact: false,\n                    message: def.maxSize.message,\n                });\n                status.dirty();\n            }\n        }\n        const valueType = this._def.valueType;\n        function finalizeSet(elements) {\n            const parsedSet = new Set();\n            for (const element of elements) {\n                if (element.status === \"aborted\")\n                    return INVALID;\n                if (element.status === \"dirty\")\n                    status.dirty();\n                parsedSet.add(element.value);\n            }\n            return { status: status.value, value: parsedSet };\n        }\n        const elements = [...ctx.data.values()].map((item, i) => valueType._parse(new ParseInputLazyPath(ctx, item, ctx.path, i)));\n        if (ctx.common.async) {\n            return Promise.all(elements).then((elements) => finalizeSet(elements));\n        }\n        else {\n            return finalizeSet(elements);\n        }\n    }\n    min(minSize, message) {\n        return new ZodSet({\n            ...this._def,\n            minSize: { value: minSize, message: errorUtil.toString(message) },\n        });\n    }\n    max(maxSize, message) {\n        return new ZodSet({\n            ...this._def,\n            maxSize: { value: maxSize, message: errorUtil.toString(message) },\n        });\n    }\n    size(size, message) {\n        return this.min(size, message).max(size, message);\n    }\n    nonempty(message) {\n        return this.min(1, message);\n    }\n}\nZodSet.create = (valueType, params) => {\n    return new ZodSet({\n        valueType,\n        minSize: null,\n        maxSize: null,\n        typeName: ZodFirstPartyTypeKind.ZodSet,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodFunction extends ZodType {\n    constructor() {\n        super(...arguments);\n        this.validate = this.implement;\n    }\n    _parse(input) {\n        const { ctx } = this._processInputParams(input);\n        if (ctx.parsedType !== ZodParsedType.function) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.function,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        function makeArgsIssue(args, error) {\n            return makeIssue({\n                data: args,\n                path: ctx.path,\n                errorMaps: [ctx.common.contextualErrorMap, ctx.schemaErrorMap, getErrorMap(), defaultErrorMap].filter((x) => !!x),\n                issueData: {\n                    code: ZodIssueCode.invalid_arguments,\n                    argumentsError: error,\n                },\n            });\n        }\n        function makeReturnsIssue(returns, error) {\n            return makeIssue({\n                data: returns,\n                path: ctx.path,\n                errorMaps: [ctx.common.contextualErrorMap, ctx.schemaErrorMap, getErrorMap(), defaultErrorMap].filter((x) => !!x),\n                issueData: {\n                    code: ZodIssueCode.invalid_return_type,\n                    returnTypeError: error,\n                },\n            });\n        }\n        const params = { errorMap: ctx.common.contextualErrorMap };\n        const fn = ctx.data;\n        if (this._def.returns instanceof ZodPromise) {\n            // Would love a way to avoid disabling this rule, but we need\n            // an alias (using an arrow function was what caused 2651).\n            // eslint-disable-next-line @typescript-eslint/no-this-alias\n            const me = this;\n            return OK(async function (...args) {\n                const error = new ZodError([]);\n                const parsedArgs = await me._def.args.parseAsync(args, params).catch((e) => {\n                    error.addIssue(makeArgsIssue(args, e));\n                    throw error;\n                });\n                const result = await Reflect.apply(fn, this, parsedArgs);\n                const parsedReturns = await me._def.returns._def.type\n                    .parseAsync(result, params)\n                    .catch((e) => {\n                    error.addIssue(makeReturnsIssue(result, e));\n                    throw error;\n                });\n                return parsedReturns;\n            });\n        }\n        else {\n            // Would love a way to avoid disabling this rule, but we need\n            // an alias (using an arrow function was what caused 2651).\n            // eslint-disable-next-line @typescript-eslint/no-this-alias\n            const me = this;\n            return OK(function (...args) {\n                const parsedArgs = me._def.args.safeParse(args, params);\n                if (!parsedArgs.success) {\n                    throw new ZodError([makeArgsIssue(args, parsedArgs.error)]);\n                }\n                const result = Reflect.apply(fn, this, parsedArgs.data);\n                const parsedReturns = me._def.returns.safeParse(result, params);\n                if (!parsedReturns.success) {\n                    throw new ZodError([makeReturnsIssue(result, parsedReturns.error)]);\n                }\n                return parsedReturns.data;\n            });\n        }\n    }\n    parameters() {\n        return this._def.args;\n    }\n    returnType() {\n        return this._def.returns;\n    }\n    args(...items) {\n        return new ZodFunction({\n            ...this._def,\n            args: ZodTuple.create(items).rest(ZodUnknown.create()),\n        });\n    }\n    returns(returnType) {\n        return new ZodFunction({\n            ...this._def,\n            returns: returnType,\n        });\n    }\n    implement(func) {\n        const validatedFunc = this.parse(func);\n        return validatedFunc;\n    }\n    strictImplement(func) {\n        const validatedFunc = this.parse(func);\n        return validatedFunc;\n    }\n    static create(args, returns, params) {\n        return new ZodFunction({\n            args: (args ? args : ZodTuple.create([]).rest(ZodUnknown.create())),\n            returns: returns || ZodUnknown.create(),\n            typeName: ZodFirstPartyTypeKind.ZodFunction,\n            ...processCreateParams(params),\n        });\n    }\n}\nexport class ZodLazy extends ZodType {\n    get schema() {\n        return this._def.getter();\n    }\n    _parse(input) {\n        const { ctx } = this._processInputParams(input);\n        const lazySchema = this._def.getter();\n        return lazySchema._parse({ data: ctx.data, path: ctx.path, parent: ctx });\n    }\n}\nZodLazy.create = (getter, params) => {\n    return new ZodLazy({\n        getter: getter,\n        typeName: ZodFirstPartyTypeKind.ZodLazy,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodLiteral extends ZodType {\n    _parse(input) {\n        if (input.data !== this._def.value) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                received: ctx.data,\n                code: ZodIssueCode.invalid_literal,\n                expected: this._def.value,\n            });\n            return INVALID;\n        }\n        return { status: \"valid\", value: input.data };\n    }\n    get value() {\n        return this._def.value;\n    }\n}\nZodLiteral.create = (value, params) => {\n    return new ZodLiteral({\n        value: value,\n        typeName: ZodFirstPartyTypeKind.ZodLiteral,\n        ...processCreateParams(params),\n    });\n};\nfunction createZodEnum(values, params) {\n    return new ZodEnum({\n        values,\n        typeName: ZodFirstPartyTypeKind.ZodEnum,\n        ...processCreateParams(params),\n    });\n}\nexport class ZodEnum extends ZodType {\n    _parse(input) {\n        if (typeof input.data !== \"string\") {\n            const ctx = this._getOrReturnCtx(input);\n            const expectedValues = this._def.values;\n            addIssueToContext(ctx, {\n                expected: util.joinValues(expectedValues),\n                received: ctx.parsedType,\n                code: ZodIssueCode.invalid_type,\n            });\n            return INVALID;\n        }\n        if (!this._cache) {\n            this._cache = new Set(this._def.values);\n        }\n        if (!this._cache.has(input.data)) {\n            const ctx = this._getOrReturnCtx(input);\n            const expectedValues = this._def.values;\n            addIssueToContext(ctx, {\n                received: ctx.data,\n                code: ZodIssueCode.invalid_enum_value,\n                options: expectedValues,\n            });\n            return INVALID;\n        }\n        return OK(input.data);\n    }\n    get options() {\n        return this._def.values;\n    }\n    get enum() {\n        const enumValues = {};\n        for (const val of this._def.values) {\n            enumValues[val] = val;\n        }\n        return enumValues;\n    }\n    get Values() {\n        const enumValues = {};\n        for (const val of this._def.values) {\n            enumValues[val] = val;\n        }\n        return enumValues;\n    }\n    get Enum() {\n        const enumValues = {};\n        for (const val of this._def.values) {\n            enumValues[val] = val;\n        }\n        return enumValues;\n    }\n    extract(values, newDef = this._def) {\n        return ZodEnum.create(values, {\n            ...this._def,\n            ...newDef,\n        });\n    }\n    exclude(values, newDef = this._def) {\n        return ZodEnum.create(this.options.filter((opt) => !values.includes(opt)), {\n            ...this._def,\n            ...newDef,\n        });\n    }\n}\nZodEnum.create = createZodEnum;\nexport class ZodNativeEnum extends ZodType {\n    _parse(input) {\n        const nativeEnumValues = util.getValidEnumValues(this._def.values);\n        const ctx = this._getOrReturnCtx(input);\n        if (ctx.parsedType !== ZodParsedType.string && ctx.parsedType !== ZodParsedType.number) {\n            const expectedValues = util.objectValues(nativeEnumValues);\n            addIssueToContext(ctx, {\n                expected: util.joinValues(expectedValues),\n                received: ctx.parsedType,\n                code: ZodIssueCode.invalid_type,\n            });\n            return INVALID;\n        }\n        if (!this._cache) {\n            this._cache = new Set(util.getValidEnumValues(this._def.values));\n        }\n        if (!this._cache.has(input.data)) {\n            const expectedValues = util.objectValues(nativeEnumValues);\n            addIssueToContext(ctx, {\n                received: ctx.data,\n                code: ZodIssueCode.invalid_enum_value,\n                options: expectedValues,\n            });\n            return INVALID;\n        }\n        return OK(input.data);\n    }\n    get enum() {\n        return this._def.values;\n    }\n}\nZodNativeEnum.create = (values, params) => {\n    return new ZodNativeEnum({\n        values: values,\n        typeName: ZodFirstPartyTypeKind.ZodNativeEnum,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodPromise extends ZodType {\n    unwrap() {\n        return this._def.type;\n    }\n    _parse(input) {\n        const { ctx } = this._processInputParams(input);\n        if (ctx.parsedType !== ZodParsedType.promise && ctx.common.async === false) {\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.promise,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        const promisified = ctx.parsedType === ZodParsedType.promise ? ctx.data : Promise.resolve(ctx.data);\n        return OK(promisified.then((data) => {\n            return this._def.type.parseAsync(data, {\n                path: ctx.path,\n                errorMap: ctx.common.contextualErrorMap,\n            });\n        }));\n    }\n}\nZodPromise.create = (schema, params) => {\n    return new ZodPromise({\n        type: schema,\n        typeName: ZodFirstPartyTypeKind.ZodPromise,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodEffects extends ZodType {\n    innerType() {\n        return this._def.schema;\n    }\n    sourceType() {\n        return this._def.schema._def.typeName === ZodFirstPartyTypeKind.ZodEffects\n            ? this._def.schema.sourceType()\n            : this._def.schema;\n    }\n    _parse(input) {\n        const { status, ctx } = this._processInputParams(input);\n        const effect = this._def.effect || null;\n        const checkCtx = {\n            addIssue: (arg) => {\n                addIssueToContext(ctx, arg);\n                if (arg.fatal) {\n                    status.abort();\n                }\n                else {\n                    status.dirty();\n                }\n            },\n            get path() {\n                return ctx.path;\n            },\n        };\n        checkCtx.addIssue = checkCtx.addIssue.bind(checkCtx);\n        if (effect.type === \"preprocess\") {\n            const processed = effect.transform(ctx.data, checkCtx);\n            if (ctx.common.async) {\n                return Promise.resolve(processed).then(async (processed) => {\n                    if (status.value === \"aborted\")\n                        return INVALID;\n                    const result = await this._def.schema._parseAsync({\n                        data: processed,\n                        path: ctx.path,\n                        parent: ctx,\n                    });\n                    if (result.status === \"aborted\")\n                        return INVALID;\n                    if (result.status === \"dirty\")\n                        return DIRTY(result.value);\n                    if (status.value === \"dirty\")\n                        return DIRTY(result.value);\n                    return result;\n                });\n            }\n            else {\n                if (status.value === \"aborted\")\n                    return INVALID;\n                const result = this._def.schema._parseSync({\n                    data: processed,\n                    path: ctx.path,\n                    parent: ctx,\n                });\n                if (result.status === \"aborted\")\n                    return INVALID;\n                if (result.status === \"dirty\")\n                    return DIRTY(result.value);\n                if (status.value === \"dirty\")\n                    return DIRTY(result.value);\n                return result;\n            }\n        }\n        if (effect.type === \"refinement\") {\n            const executeRefinement = (acc) => {\n                const result = effect.refinement(acc, checkCtx);\n                if (ctx.common.async) {\n                    return Promise.resolve(result);\n                }\n                if (result instanceof Promise) {\n                    throw new Error(\"Async refinement encountered during synchronous parse operation. Use .parseAsync instead.\");\n                }\n                return acc;\n            };\n            if (ctx.common.async === false) {\n                const inner = this._def.schema._parseSync({\n                    data: ctx.data,\n                    path: ctx.path,\n                    parent: ctx,\n                });\n                if (inner.status === \"aborted\")\n                    return INVALID;\n                if (inner.status === \"dirty\")\n                    status.dirty();\n                // return value is ignored\n                executeRefinement(inner.value);\n                return { status: status.value, value: inner.value };\n            }\n            else {\n                return this._def.schema._parseAsync({ data: ctx.data, path: ctx.path, parent: ctx }).then((inner) => {\n                    if (inner.status === \"aborted\")\n                        return INVALID;\n                    if (inner.status === \"dirty\")\n                        status.dirty();\n                    return executeRefinement(inner.value).then(() => {\n                        return { status: status.value, value: inner.value };\n                    });\n                });\n            }\n        }\n        if (effect.type === \"transform\") {\n            if (ctx.common.async === false) {\n                const base = this._def.schema._parseSync({\n                    data: ctx.data,\n                    path: ctx.path,\n                    parent: ctx,\n                });\n                if (!isValid(base))\n                    return INVALID;\n                const result = effect.transform(base.value, checkCtx);\n                if (result instanceof Promise) {\n                    throw new Error(`Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.`);\n                }\n                return { status: status.value, value: result };\n            }\n            else {\n                return this._def.schema._parseAsync({ data: ctx.data, path: ctx.path, parent: ctx }).then((base) => {\n                    if (!isValid(base))\n                        return INVALID;\n                    return Promise.resolve(effect.transform(base.value, checkCtx)).then((result) => ({\n                        status: status.value,\n                        value: result,\n                    }));\n                });\n            }\n        }\n        util.assertNever(effect);\n    }\n}\nZodEffects.create = (schema, effect, params) => {\n    return new ZodEffects({\n        schema,\n        typeName: ZodFirstPartyTypeKind.ZodEffects,\n        effect,\n        ...processCreateParams(params),\n    });\n};\nZodEffects.createWithPreprocess = (preprocess, schema, params) => {\n    return new ZodEffects({\n        schema,\n        effect: { type: \"preprocess\", transform: preprocess },\n        typeName: ZodFirstPartyTypeKind.ZodEffects,\n        ...processCreateParams(params),\n    });\n};\nexport { ZodEffects as ZodTransformer };\nexport class ZodOptional extends ZodType {\n    _parse(input) {\n        const parsedType = this._getType(input);\n        if (parsedType === ZodParsedType.undefined) {\n            return OK(undefined);\n        }\n        return this._def.innerType._parse(input);\n    }\n    unwrap() {\n        return this._def.innerType;\n    }\n}\nZodOptional.create = (type, params) => {\n    return new ZodOptional({\n        innerType: type,\n        typeName: ZodFirstPartyTypeKind.ZodOptional,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodNullable extends ZodType {\n    _parse(input) {\n        const parsedType = this._getType(input);\n        if (parsedType === ZodParsedType.null) {\n            return OK(null);\n        }\n        return this._def.innerType._parse(input);\n    }\n    unwrap() {\n        return this._def.innerType;\n    }\n}\nZodNullable.create = (type, params) => {\n    return new ZodNullable({\n        innerType: type,\n        typeName: ZodFirstPartyTypeKind.ZodNullable,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodDefault extends ZodType {\n    _parse(input) {\n        const { ctx } = this._processInputParams(input);\n        let data = ctx.data;\n        if (ctx.parsedType === ZodParsedType.undefined) {\n            data = this._def.defaultValue();\n        }\n        return this._def.innerType._parse({\n            data,\n            path: ctx.path,\n            parent: ctx,\n        });\n    }\n    removeDefault() {\n        return this._def.innerType;\n    }\n}\nZodDefault.create = (type, params) => {\n    return new ZodDefault({\n        innerType: type,\n        typeName: ZodFirstPartyTypeKind.ZodDefault,\n        defaultValue: typeof params.default === \"function\" ? params.default : () => params.default,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodCatch extends ZodType {\n    _parse(input) {\n        const { ctx } = this._processInputParams(input);\n        // newCtx is used to not collect issues from inner types in ctx\n        const newCtx = {\n            ...ctx,\n            common: {\n                ...ctx.common,\n                issues: [],\n            },\n        };\n        const result = this._def.innerType._parse({\n            data: newCtx.data,\n            path: newCtx.path,\n            parent: {\n                ...newCtx,\n            },\n        });\n        if (isAsync(result)) {\n            return result.then((result) => {\n                return {\n                    status: \"valid\",\n                    value: result.status === \"valid\"\n                        ? result.value\n                        : this._def.catchValue({\n                            get error() {\n                                return new ZodError(newCtx.common.issues);\n                            },\n                            input: newCtx.data,\n                        }),\n                };\n            });\n        }\n        else {\n            return {\n                status: \"valid\",\n                value: result.status === \"valid\"\n                    ? result.value\n                    : this._def.catchValue({\n                        get error() {\n                            return new ZodError(newCtx.common.issues);\n                        },\n                        input: newCtx.data,\n                    }),\n            };\n        }\n    }\n    removeCatch() {\n        return this._def.innerType;\n    }\n}\nZodCatch.create = (type, params) => {\n    return new ZodCatch({\n        innerType: type,\n        typeName: ZodFirstPartyTypeKind.ZodCatch,\n        catchValue: typeof params.catch === \"function\" ? params.catch : () => params.catch,\n        ...processCreateParams(params),\n    });\n};\nexport class ZodNaN extends ZodType {\n    _parse(input) {\n        const parsedType = this._getType(input);\n        if (parsedType !== ZodParsedType.nan) {\n            const ctx = this._getOrReturnCtx(input);\n            addIssueToContext(ctx, {\n                code: ZodIssueCode.invalid_type,\n                expected: ZodParsedType.nan,\n                received: ctx.parsedType,\n            });\n            return INVALID;\n        }\n        return { status: \"valid\", value: input.data };\n    }\n}\nZodNaN.create = (params) => {\n    return new ZodNaN({\n        typeName: ZodFirstPartyTypeKind.ZodNaN,\n        ...processCreateParams(params),\n    });\n};\nexport const BRAND = Symbol(\"zod_brand\");\nexport class ZodBranded extends ZodType {\n    _parse(input) {\n        const { ctx } = this._processInputParams(input);\n        const data = ctx.data;\n        return this._def.type._parse({\n            data,\n            path: ctx.path,\n            parent: ctx,\n        });\n    }\n    unwrap() {\n        return this._def.type;\n    }\n}\nexport class ZodPipeline extends ZodType {\n    _parse(input) {\n        const { status, ctx } = this._processInputParams(input);\n        if (ctx.common.async) {\n            const handleAsync = async () => {\n                const inResult = await this._def.in._parseAsync({\n                    data: ctx.data,\n                    path: ctx.path,\n                    parent: ctx,\n                });\n                if (inResult.status === \"aborted\")\n                    return INVALID;\n                if (inResult.status === \"dirty\") {\n                    status.dirty();\n                    return DIRTY(inResult.value);\n                }\n                else {\n                    return this._def.out._parseAsync({\n                        data: inResult.value,\n                        path: ctx.path,\n                        parent: ctx,\n                    });\n                }\n            };\n            return handleAsync();\n        }\n        else {\n            const inResult = this._def.in._parseSync({\n                data: ctx.data,\n                path: ctx.path,\n                parent: ctx,\n            });\n            if (inResult.status === \"aborted\")\n                return INVALID;\n            if (inResult.status === \"dirty\") {\n                status.dirty();\n                return {\n                    status: \"dirty\",\n                    value: inResult.value,\n                };\n            }\n            else {\n                return this._def.out._parseSync({\n                    data: inResult.value,\n                    path: ctx.path,\n                    parent: ctx,\n                });\n            }\n        }\n    }\n    static create(a, b) {\n        return new ZodPipeline({\n            in: a,\n            out: b,\n            typeName: ZodFirstPartyTypeKind.ZodPipeline,\n        });\n    }\n}\nexport class ZodReadonly extends ZodType {\n    _parse(input) {\n        const result = this._def.innerType._parse(input);\n        const freeze = (data) => {\n            if (isValid(data)) {\n                data.value = Object.freeze(data.value);\n            }\n            return data;\n        };\n        return isAsync(result) ? result.then((data) => freeze(data)) : freeze(result);\n    }\n    unwrap() {\n        return this._def.innerType;\n    }\n}\nZodReadonly.create = (type, params) => {\n    return new ZodReadonly({\n        innerType: type,\n        typeName: ZodFirstPartyTypeKind.ZodReadonly,\n        ...processCreateParams(params),\n    });\n};\n////////////////////////////////////////\n////////////////////////////////////////\n//////////                    //////////\n//////////      z.custom      //////////\n//////////                    //////////\n////////////////////////////////////////\n////////////////////////////////////////\nfunction cleanParams(params, data) {\n    const p = typeof params === \"function\" ? params(data) : typeof params === \"string\" ? { message: params } : params;\n    const p2 = typeof p === \"string\" ? { message: p } : p;\n    return p2;\n}\nexport function custom(check, _params = {}, \n/**\n * @deprecated\n *\n * Pass `fatal` into the params object instead:\n *\n * ```ts\n * z.string().custom((val) => val.length > 5, { fatal: false })\n * ```\n *\n */\nfatal) {\n    if (check)\n        return ZodAny.create().superRefine((data, ctx) => {\n            const r = check(data);\n            if (r instanceof Promise) {\n                return r.then((r) => {\n                    if (!r) {\n                        const params = cleanParams(_params, data);\n                        const _fatal = params.fatal ?? fatal ?? true;\n                        ctx.addIssue({ code: \"custom\", ...params, fatal: _fatal });\n                    }\n                });\n            }\n            if (!r) {\n                const params = cleanParams(_params, data);\n                const _fatal = params.fatal ?? fatal ?? true;\n                ctx.addIssue({ code: \"custom\", ...params, fatal: _fatal });\n            }\n            return;\n        });\n    return ZodAny.create();\n}\nexport { ZodType as Schema, ZodType as ZodSchema };\nexport const late = {\n    object: ZodObject.lazycreate,\n};\nexport var ZodFirstPartyTypeKind;\n(function (ZodFirstPartyTypeKind) {\n    ZodFirstPartyTypeKind[\"ZodString\"] = \"ZodString\";\n    ZodFirstPartyTypeKind[\"ZodNumber\"] = \"ZodNumber\";\n    ZodFirstPartyTypeKind[\"ZodNaN\"] = \"ZodNaN\";\n    ZodFirstPartyTypeKind[\"ZodBigInt\"] = \"ZodBigInt\";\n    ZodFirstPartyTypeKind[\"ZodBoolean\"] = \"ZodBoolean\";\n    ZodFirstPartyTypeKind[\"ZodDate\"] = \"ZodDate\";\n    ZodFirstPartyTypeKind[\"ZodSymbol\"] = \"ZodSymbol\";\n    ZodFirstPartyTypeKind[\"ZodUndefined\"] = \"ZodUndefined\";\n    ZodFirstPartyTypeKind[\"ZodNull\"] = \"ZodNull\";\n    ZodFirstPartyTypeKind[\"ZodAny\"] = \"ZodAny\";\n    ZodFirstPartyTypeKind[\"ZodUnknown\"] = \"ZodUnknown\";\n    ZodFirstPartyTypeKind[\"ZodNever\"] = \"ZodNever\";\n    ZodFirstPartyTypeKind[\"ZodVoid\"] = \"ZodVoid\";\n    ZodFirstPartyTypeKind[\"ZodArray\"] = \"ZodArray\";\n    ZodFirstPartyTypeKind[\"ZodObject\"] = \"ZodObject\";\n    ZodFirstPartyTypeKind[\"ZodUnion\"] = \"ZodUnion\";\n    ZodFirstPartyTypeKind[\"ZodDiscriminatedUnion\"] = \"ZodDiscriminatedUnion\";\n    ZodFirstPartyTypeKind[\"ZodIntersection\"] = \"ZodIntersection\";\n    ZodFirstPartyTypeKind[\"ZodTuple\"] = \"ZodTuple\";\n    ZodFirstPartyTypeKind[\"ZodRecord\"] = \"ZodRecord\";\n    ZodFirstPartyTypeKind[\"ZodMap\"] = \"ZodMap\";\n    ZodFirstPartyTypeKind[\"ZodSet\"] = \"ZodSet\";\n    ZodFirstPartyTypeKind[\"ZodFunction\"] = \"ZodFunction\";\n    ZodFirstPartyTypeKind[\"ZodLazy\"] = \"ZodLazy\";\n    ZodFirstPartyTypeKind[\"ZodLiteral\"] = \"ZodLiteral\";\n    ZodFirstPartyTypeKind[\"ZodEnum\"] = \"ZodEnum\";\n    ZodFirstPartyTypeKind[\"ZodEffects\"] = \"ZodEffects\";\n    ZodFirstPartyTypeKind[\"ZodNativeEnum\"] = \"ZodNativeEnum\";\n    ZodFirstPartyTypeKind[\"ZodOptional\"] = \"ZodOptional\";\n    ZodFirstPartyTypeKind[\"ZodNullable\"] = \"ZodNullable\";\n    ZodFirstPartyTypeKind[\"ZodDefault\"] = \"ZodDefault\";\n    ZodFirstPartyTypeKind[\"ZodCatch\"] = \"ZodCatch\";\n    ZodFirstPartyTypeKind[\"ZodPromise\"] = \"ZodPromise\";\n    ZodFirstPartyTypeKind[\"ZodBranded\"] = \"ZodBranded\";\n    ZodFirstPartyTypeKind[\"ZodPipeline\"] = \"ZodPipeline\";\n    ZodFirstPartyTypeKind[\"ZodReadonly\"] = \"ZodReadonly\";\n})(ZodFirstPartyTypeKind || (ZodFirstPartyTypeKind = {}));\n// requires TS 4.4+\nclass Class {\n    constructor(..._) { }\n}\nconst instanceOfType = (\n// const instanceOfType = <T extends new (...args: any[]) => any>(\ncls, params = {\n    message: `Input not instance of ${cls.name}`,\n}) => custom((data) => data instanceof cls, params);\nconst stringType = ZodString.create;\nconst numberType = ZodNumber.create;\nconst nanType = ZodNaN.create;\nconst bigIntType = ZodBigInt.create;\nconst booleanType = ZodBoolean.create;\nconst dateType = ZodDate.create;\nconst symbolType = ZodSymbol.create;\nconst undefinedType = ZodUndefined.create;\nconst nullType = ZodNull.create;\nconst anyType = ZodAny.create;\nconst unknownType = ZodUnknown.create;\nconst neverType = ZodNever.create;\nconst voidType = ZodVoid.create;\nconst arrayType = ZodArray.create;\nconst objectType = ZodObject.create;\nconst strictObjectType = ZodObject.strictCreate;\nconst unionType = ZodUnion.create;\nconst discriminatedUnionType = ZodDiscriminatedUnion.create;\nconst intersectionType = ZodIntersection.create;\nconst tupleType = ZodTuple.create;\nconst recordType = ZodRecord.create;\nconst mapType = ZodMap.create;\nconst setType = ZodSet.create;\nconst functionType = ZodFunction.create;\nconst lazyType = ZodLazy.create;\nconst literalType = ZodLiteral.create;\nconst enumType = ZodEnum.create;\nconst nativeEnumType = ZodNativeEnum.create;\nconst promiseType = ZodPromise.create;\nconst effectsType = ZodEffects.create;\nconst optionalType = ZodOptional.create;\nconst nullableType = ZodNullable.create;\nconst preprocessType = ZodEffects.createWithPreprocess;\nconst pipelineType = ZodPipeline.create;\nconst ostring = () => stringType().optional();\nconst onumber = () => numberType().optional();\nconst oboolean = () => booleanType().optional();\nexport const coerce = {\n    string: ((arg) => ZodString.create({ ...arg, coerce: true })),\n    number: ((arg) => ZodNumber.create({ ...arg, coerce: true })),\n    boolean: ((arg) => ZodBoolean.create({\n        ...arg,\n        coerce: true,\n    })),\n    bigint: ((arg) => ZodBigInt.create({ ...arg, coerce: true })),\n    date: ((arg) => ZodDate.create({ ...arg, coerce: true })),\n};\nexport { anyType as any, arrayType as array, bigIntType as bigint, booleanType as boolean, dateType as date, discriminatedUnionType as discriminatedUnion, effectsType as effect, enumType as enum, functionType as function, instanceOfType as instanceof, intersectionType as intersection, lazyType as lazy, literalType as literal, mapType as map, nanType as nan, nativeEnumType as nativeEnum, neverType as never, nullType as null, nullableType as nullable, numberType as number, objectType as object, oboolean, onumber, optionalType as optional, ostring, pipelineType as pipeline, preprocessType as preprocess, promiseType as promise, recordType as record, setType as set, strictObjectType as strictObject, stringType as string, symbolType as symbol, effectsType as transformer, tupleType as tuple, undefinedType as undefined, unionType as union, unknownType as unknown, voidType as void, };\nexport const NEVER = INVALID;\n", "import { z } from 'zod';\n\n/**\n * Runtime type validation schemas for external API responses.\n * Used to validate and parse responses from geocoding providers and other external services.\n */\n\n// GeoGratis API response schemas\nexport const GeoGratisGeometrySchema = z.object({\n  type: z.string(),\n  coordinates: z.array(z.number())\n});\n\nexport const GeoGratisResultSchema = z.object({\n  title: z.string().optional(),\n  qualifier: z.string().optional(),\n  type: z.string().optional(),\n  geometry: GeoGratisGeometrySchema,\n  bbox: z.array(z.number()).optional(),\n  score: z.number().min(0).max(1).optional(),\n  component: z.record(z.any()).optional()\n});\n\nexport const GeoGratisResponseSchema = z.array(GeoGratisResultSchema);\n\n// Google Geocoding API response schemas\nexport const GoogleLocationSchema = z.object({\n  lat: z.number(),\n  lng: z.number()\n});\n\nexport const GoogleGeometrySchema = z.object({\n  location: GoogleLocationSchema,\n  location_type: z.string().optional(),\n  viewport: z.object({\n    northeast: GoogleLocationSchema,\n    southwest: GoogleLocationSchema\n  }).optional()\n});\n\nexport const GoogleGeocodeResultSchema = z.object({\n  address_components: z.array(z.any()).optional(),\n  formatted_address: z.string().optional(),\n  geometry: GoogleGeometrySchema,\n  place_id: z.string().optional(),\n  types: z.array(z.string()).optional()\n});\n\nexport const GoogleGeocodeResponseSchema = z.object({\n  results: z.array(GoogleGeocodeResultSchema),\n  status: z.enum(['OK', 'ZERO_RESULTS', 'OVER_QUERY_LIMIT', 'REQUEST_DENIED', 'INVALID_REQUEST', 'UNKNOWN_ERROR'])\n});\n\n// Google Batch Geocoding API response schemas\nexport const GoogleBatchGeocodeResultItemSchema = z.object({\n  address: z.string(),\n  geocoded_address: z.string().optional(),\n  partial_match: z.boolean().optional(),\n  place_id: z.string().optional(),\n  postcode_localities: z.array(z.string()).optional(),\n  types: z.array(z.string()).optional(),\n  geometry: z.object({\n    location: z.object({\n      lat: z.number(),\n      lng: z.number()\n    }),\n    location_type: z.string().optional(),\n    viewport: z.object({\n      northeast: z.object({ lat: z.number(), lng: z.number() }),\n      southwest: z.object({ lat: z.number(), lng: z.number() })\n    }).optional()\n  })\n});\n\nexport const GoogleBatchGeocodeResponseSchema = z.object({\n  results: z.array(GoogleBatchGeocodeResultItemSchema)\n});\n\n// Nominatim (OpenStreetMap) API response schemas\nexport const NominatimResultSchema = z.object({\n  place_id: z.number().optional(),\n  licence: z.string().optional(),\n  osm_type: z.string().optional(),\n  osm_id: z.number().optional(),\n  boundingbox: z.array(z.string()).optional(),\n  lat: z.string(),\n  lon: z.string(),\n  display_name: z.string().optional(),\n  class: z.string().optional(),\n  type: z.string().optional(),\n  importance: z.number().optional(),\n  icon: z.string().optional()\n});\n\nexport const NominatimResponseSchema = z.array(NominatimResultSchema);\n\n// Mapbox Geocoding API response schemas\nexport const MapboxFeatureSchema = z.object({\n  id: z.string().optional(),\n  type: z.string(),\n  place_type: z.array(z.string()).optional(),\n  relevance: z.number().optional(),\n  properties: z.record(z.any()).optional(),\n  text: z.string().optional(),\n  place_name: z.string().optional(),\n  center: z.tuple([z.number(), z.number()]),\n  geometry: z.any().optional()\n});\n\nexport const MapboxResponseSchema = z.object({\n  type: z.literal('FeatureCollection'),\n  query: z.array(z.any()).optional(),\n  features: z.array(MapboxFeatureSchema),\n  attribution: z.string().optional()\n});\n\n/**\n * Validates a GeoGratis API response.\n * @param data - Raw response data to validate\n * @returns Validated GeoGratis response or throws ZodError\n */\nexport function validateGeoGratisResponse(data: unknown) {\n  return GeoGratisResponseSchema.parse(data);\n}\n\n/**\n * Validates a Google Geocoding API response.\n * @param data - Raw response data to validate\n * @returns Validated Google response or throws ZodError\n */\nexport function validateGoogleGeocodeResponse(data: unknown) {\n  return GoogleGeocodeResponseSchema.parse(data);\n}\n\n/**\n * Validates a Google Batch Geocoding API response.\n * @param data - Raw response data to validate\n * @returns Validated Google batch response or throws ZodError\n */\nexport function validateGoogleBatchGeocodeResponse(data: unknown) {\n  return GoogleBatchGeocodeResponseSchema.parse(data);\n}\n\n/**\n * Validates a Nominatim API response.\n * @param data - Raw response data to validate\n * @returns Validated Nominatim response or throws ZodError\n */\nexport function validateNominatimResponse(data: unknown) {\n  return NominatimResponseSchema.parse(data);\n}\n\n/**\n * Validates a Mapbox Geocoding API response.\n * @param data - Raw response data to validate\n * @returns Validated Mapbox response or throws ZodError\n */\nexport function validateMapboxResponse(data: unknown) {\n  return MapboxResponseSchema.parse(data);\n}\n\n/**\n * Safe validation wrapper for GeoGratis responses.\n */\nexport function safeValidateGeoGratis(data: unknown) {\n  return safeValidate(GeoGratisResponseSchema, data);\n}\n\n/**\n * Safe validation wrapper for Google Geocoding responses.\n */\nexport function safeValidateGoogleGeocode(data: unknown) {\n  return safeValidate(GoogleGeocodeResponseSchema, data);\n}\n\n/**\n * Safe validation wrapper for Google Batch Geocoding responses.\n */\nexport function safeValidateGoogleBatchGeocode(data: unknown) {\n  return safeValidate(GoogleBatchGeocodeResponseSchema, data);\n}\n\n/**\n * Safe validation wrapper for Nominatim responses.\n */\nexport function safeValidateNominatim(data: unknown) {\n  return safeValidate(NominatimResponseSchema, data);\n}\n\n/**\n * Safe validation wrapper for Mapbox responses.\n */\nexport function safeValidateMapbox(data: unknown) {\n  return safeValidate(MapboxResponseSchema, data);\n}\n\n/**\n * Safe validation wrapper that returns a result instead of throwing.\n * Useful for error handling when validation failures should be handled gracefully.\n */\nexport function safeValidate<T>(\n  schema: z.ZodSchema<T>,\n  data: unknown\n): { success: true; data: T } | { success: false; error: z.ZodError } {\n  const result = schema.safeParse(data);\n  if (result.success) {\n    return { success: true, data: result.data };\n  } else {\n    return { success: false, error: result.error };\n  }\n}\n\n", "import { \n  Env, \n  QueryParams, \n  MapboxResponse, \n  NominatimResult, \n  GoogleGeocodeResponse,\n  GoogleBatchGeocodeRequest,\n  GoogleBatchGeocodeResponse,\n  GeoGratisResponse,\n  GeoGratisResult\n} from './types';\nimport { getTimeoutConfig, getRetryConfig, TIME_CONSTANTS, TIME_CONSTANTS_SECONDS, QUALITY_THRESHOLDS } from './config';\nimport { \n  safeValidateGeoGratis,\n  safeValidateGoogleGeocode,\n  safeValidateGoogleBatchGeocode,\n  safeValidateNominatim,\n  safeValidateMapbox\n} from './validation';\n\n// Geocoding cache entry interface\ninterface GeocodingCacheEntry {\n  lon: number;\n  lat: number;\n  timestamp: number;\n  provider: string;\n  qualifier?: string; // GeoGratis qualifier (e.g., 'INTERPOLATED_POSITION')\n  score?: number; // GeoGratis quality score (0-1)\n}\n\n// GeoGratis-first for geolocation; normalization via Google reverse geocode when key is set.\nconst BATCH_GEOCODING_CONFIG = {\n  ENABLED: true,\n  MAX_BATCH_SIZE: 10,\n  PROVIDER: 'individual' as 'individual' | 'google' // 'individual' = GeoGratis-first; 'google' = batch Google (optional fallback)\n};\n\n// Use quality threshold from config\nconst GEOGRATIS_MIN_SCORE = QUALITY_THRESHOLDS.GEOGRATIS_MIN_SCORE;\n\n/**\n * Generates a normalized cache key for geocoding requests.\n * Normalizes query parameters to ensure consistent caching.\n * \n * @param query - Query parameters (address, postal, city, state, country)\n * @param provider - Geocoding provider name (e.g., 'geogratis', 'google', 'mapbox')\n * @returns Cache key string\n */\nexport function generateGeocodingCacheKey(query: QueryParams, provider: string): string {\n  const normalizedQuery = {\n    address: query.address?.toLowerCase().trim(),\n    postal: query.postal?.toLowerCase().trim().replace(/\\s+/g, ''),\n    city: query.city?.toLowerCase().trim(),\n    state: query.state?.toLowerCase().trim(),\n    country: query.country?.toLowerCase().trim()\n  };\n  \n  return `geocoding:${provider}:${JSON.stringify(normalizedQuery)}`;\n}\n\n/**\n * Retrieves a cached geocoding result from KV storage.\n * Validates cache entry age (24 hour TTL) and returns null if expired.\n * \n * @param env - Environment bindings containing GEOCODING_CACHE KV namespace\n * @param cacheKey - Cache key generated by generateGeocodingCacheKey\n * @returns Cached coordinates with quality info, or null if not found/expired\n */\nexport async function getCachedGeocoding(env: Env, cacheKey: string): Promise<{ lon: number; lat: number; qualifier?: string; score?: number } | null> {\n  if (!env.GEOCODING_CACHE) return null;\n  \n  try {\n    const cached = await env.GEOCODING_CACHE.get(cacheKey, 'json') as GeocodingCacheEntry | null;\n    if (!cached) return null;\n    \n    // Check if cache entry is still valid (24 hours TTL)\n    const maxAge = TIME_CONSTANTS.TWENTY_FOUR_HOURS_MS;\n    if (Date.now() - cached.timestamp > maxAge) {\n      await env.GEOCODING_CACHE.delete(cacheKey);\n      return null;\n    }\n    \n    return { \n      lon: cached.lon, \n      lat: cached.lat,\n      qualifier: cached.qualifier,\n      score: cached.score\n    };\n  } catch (error) {\n    console.warn('Failed to get cached geocoding result:', error);\n    return null;\n  }\n}\n\n/**\n * Stores a geocoding result in KV cache with 24-hour TTL.\n * Includes quality metadata (qualifier, score) for GeoGratis results.\n * \n * @param env - Environment bindings containing GEOCODING_CACHE KV namespace\n * @param cacheKey - Cache key generated by generateGeocodingCacheKey\n * @param lon - Longitude\n * @param lat - Latitude\n * @param provider - Geocoding provider name\n * @param qualifier - Optional quality qualifier (e.g., 'INTERPOLATED_POSITION')\n * @param score - Optional quality score (0-1 scale)\n */\nexport async function setCachedGeocoding(env: Env, cacheKey: string, lon: number, lat: number, provider: string, qualifier?: string, score?: number): Promise<void> {\n  if (!env.GEOCODING_CACHE) return;\n  \n  try {\n    const entry: GeocodingCacheEntry = {\n      lon,\n      lat,\n      timestamp: Date.now(),\n      provider,\n      qualifier,\n      score\n    };\n    \n    // Store with 24 hour TTL\n    await env.GEOCODING_CACHE.put(cacheKey, JSON.stringify(entry), {\n      expirationTtl: TIME_CONSTANTS_SECONDS.TWENTY_FOUR_HOURS\n    });\n  } catch (error) {\n    console.warn('Failed to cache geocoding result:', error);\n  }\n}\n\n// Non-retriable error type\nclass NonRetriableError extends Error {\n  nonRetriable: boolean;\n  constructor(message: string) {\n    super(message);\n    this.nonRetriable = true;\n  }\n}\n\n// Retry utility function with jitter and non-retriable support\nasync function withRetry<T>(\n  fn: () => Promise<T>,\n  config: ReturnType<typeof getRetryConfig>,\n  operation: string\n): Promise<T> {\n  let lastError: Error;\n  \n  for (let attempt = 1; attempt <= config.maxAttempts; attempt++) {\n    try {\n      const result = await fn();\n      if (attempt > 1) {\n      }\n      return result;\n    } catch (error) {\n      lastError = error as Error;\n      \n      // Do not retry non-retriable errors\n      if ((lastError as any)?.nonRetriable) {\n        console.error(`[GEOCODING] ${operation} failed with non-retriable error:`, lastError.message);\n        throw lastError;\n      }\n      \n      if (attempt === config.maxAttempts) {\n        console.error(`[GEOCODING] ${operation} failed after ${config.maxAttempts} attempts:`, lastError.message);\n        throw lastError;\n      }\n      \n      const delay = Math.min(\n        config.baseDelay * Math.pow(config.backoffMultiplier, attempt - 1),\n        config.maxDelay\n      );\n      const jitteredDelay = delay + Math.random() * 1000;\n      \n      console.warn(`[GEOCODING] ${operation} attempt ${attempt} failed, retrying in ${Math.round(jitteredDelay)}ms:`, lastError.message);\n      await new Promise(resolve => setTimeout(resolve, jitteredDelay));\n    }\n  }\n  \n  throw lastError!;\n}\n\n// Timeout utility function\nasync function withTimeout<T>(promise: Promise<T>, timeoutMs: number, operation: string): Promise<T> {\n  const timeoutPromise = new Promise<never>((_, reject) => {\n    setTimeout(() => reject(new Error(`${operation} timed out after ${timeoutMs}ms`)), timeoutMs);\n  });\n  \n  return Promise.race([promise, timeoutPromise]);\n}\n\nexport type GeocodeResult = { lon: number; lat: number; normalizedAddress?: string };\n\nexport type GeocodeBatchResult = { lon: number; lat: number; success: boolean; error?: string; normalizedAddress?: string };\n\n/**\n * Reverse-geocodes (lat, lon) via Google Geocoding API to obtain a normalized formatted address.\n * Uses X-Google-API-Key header or GOOGLE_MAPS_KEY env. Returns null if no key, ZERO_RESULTS, or error.\n */\nexport async function normalizeAddressWithGoogle(\n  env: Env,\n  lat: number,\n  lon: number,\n  request?: Request,\n  circuitBreaker?: { execute: (key: string, fn: () => Promise<any>) => Promise<any> }\n): Promise<string | null> {\n  const headerKey = request?.headers.get('X-Google-API-Key');\n  const key = headerKey || env.GOOGLE_MAPS_KEY;\n  if (!key) return null;\n\n  const doReverse = async (): Promise<string | null> => {\n    const params = new URLSearchParams({\n      latlng: `${lat},${lon}`,\n      key,\n      region: 'ca'\n    });\n    const url = `https://maps.googleapis.com/maps/api/geocode/json?${params.toString()}`;\n    const resp = await fetch(url, { headers: { 'User-Agent': 'riding-lookup/1.0' } });\n    if (!resp.ok) return null;\n    const rawData = await resp.json();\n    const validation = safeValidateGoogleGeocode(rawData);\n    if (!validation.success) return null;\n    const data = validation.data;\n    if (data.status !== 'OK' || !data.results?.length) return null;\n    const addr = data.results[0].formatted_address;\n    return typeof addr === 'string' && addr.length > 0 ? addr : null;\n  };\n\n  try {\n    const timeoutConfig = getTimeoutConfig(env);\n    const timeoutMs = Math.min(timeoutConfig.geocoding, 5000);\n    const fn = () => withTimeout(doReverse(), timeoutMs, 'Google reverse geocode');\n    const out = circuitBreaker\n      ? await circuitBreaker.execute('geocoding:google-reverse', fn)\n      : await fn();\n    return out;\n  } catch {\n    return null;\n  }\n}\n\n/**\n * Geocodes an address using the GeoGratis Geolocation API (Government of Canada).\n * This is the primary geocoding service used by the application.\n * \n * @param qp - Query parameters containing address, postal code, city, state, or country\n * @returns Promise resolving to geocoding result with lon, lat, qualifier, and score, or null if failed\n * \n * @remarks\n * - Uses the GeoGratis API endpoint: https://geogratis.gc.ca/services/geolocation/en/locate\n * - Requests score and component data via expand parameter for quality assessment\n * - Returns null on API errors, empty results, or invalid coordinates\n */\nasync function geocodeWithGeoGratis(qp: QueryParams): Promise<{ lon: number; lat: number; qualifier?: string; score?: number } | null> {\n  try {\n    // Build query string from available parameters\n    const queryParts: string[] = [];\n    if (qp.address) queryParts.push(qp.address);\n    if (qp.postal) queryParts.push(qp.postal);\n    if (qp.city) queryParts.push(qp.city);\n    if (qp.state) queryParts.push(qp.state);\n    if (qp.country) queryParts.push(qp.country);\n    \n    // Fallback to any available query if no structured parts\n    if (queryParts.length === 0) {\n      const query = qp.address || qp.postal || qp.city || qp.state || qp.country;\n      if (!query) return null;\n      queryParts.push(query);\n    }\n    \n    const queryString = queryParts.join(', ');\n    const params = new URLSearchParams({ \n      q: queryString,\n      expand: 'score,component' // Request score and component for quality assessment\n    });\n    \n    const url = `https://geogratis.gc.ca/services/geolocation/en/locate?${params.toString()}`;\n    const resp = await fetch(url, { \n      headers: { \"User-Agent\": \"riding-lookup/1.0\" } \n    });\n    \n    if (!resp.ok) {\n      console.warn(`[GEOCODING] GeoGratis API error: ${resp.status}`);\n      return null;\n    }\n    \n    const rawData = await resp.json();\n    \n    // Validate response structure with zod\n    const validation = safeValidateGeoGratis(rawData);\n    if (!validation.success) {\n      console.warn(`[GEOCODING] GeoGratis response validation failed:`, validation.error.errors);\n      return null;\n    }\n    \n    const data = validation.data;\n    \n    // Check if we have results\n    if (data.length === 0) {\n      console.warn(`[GEOCODING] GeoGratis returned no results`);\n      return null;\n    }\n    \n    // Get the first result (best match)\n    const firstResult = data[0];\n    \n    // Extract coordinates from geometry\n    if (!firstResult.geometry || !firstResult.geometry.coordinates || firstResult.geometry.coordinates.length < 2) {\n      console.warn(`[GEOCODING] GeoGratis result missing valid coordinates`);\n      return null;\n    }\n    \n    // GeoJSON coordinates are [lon, lat] format\n    const lon = firstResult.geometry.coordinates[0];\n    const lat = firstResult.geometry.coordinates[1];\n    \n    if (typeof lon !== 'number' || typeof lat !== 'number' || isNaN(lon) || isNaN(lat)) {\n      console.warn(`[GEOCODING] GeoGratis result has invalid coordinates`);\n      return null;\n    }\n    \n    return {\n      lon,\n      lat,\n      qualifier: firstResult.qualifier,\n      score: firstResult.score\n    };\n  } catch (error) {\n    console.warn(`[GEOCODING] GeoGratis geocoding failed:`, error instanceof Error ? error.message : 'Unknown error');\n    return null;\n  }\n}\n\n// Main geocoding function\n/**\n * Geocodes a query (address/postal code) to coordinates if needed.\n * Uses cached results when available, with quality-aware caching for GeoGratis.\n * Falls back through multiple providers: GeoGratis -> Google -> Mapbox -> Nominatim.\n * When Google is used for forward geocoding, returns normalizedAddress (formatted_address).\n * \n * @param env - Environment bindings (API keys, KV cache)\n * @param query - Query parameters (address, postal, city, state, country)\n * @param request - Optional request object for extracting Google API key from headers\n * @returns Promise resolving to {lon, lat, normalizedAddress?} coordinates\n * @throws Error if geocoding fails for all providers\n */\nexport async function geocodeIfNeeded(\n  env: Env, \n  qp: QueryParams, \n  request?: Request,\n  metrics?: {\n    incrementMetric: (key: keyof import('./types').Metrics, value?: number) => void;\n    recordTiming: (key: keyof import('./types').Metrics, duration: number) => void;\n  },\n  circuitBreaker?: {\n    execute: (key: string, fn: () => Promise<any>) => Promise<any>;\n  }\n): Promise<GeocodeResult> {\n  if (typeof qp.lat === \"number\" && typeof qp.lon === \"number\") {\n    return { lon: qp.lon, lat: qp.lat };\n  }\n  const query = qp.address || qp.postal || qp.city || qp.state || qp.country;\n  if (!query) throw new Error(\"Missing location: provide lat/lon or address/postal\");\n\n  const timeoutConfig = getTimeoutConfig(env);\n  const timeoutMs = timeoutConfig.geocoding;\n  \n  const geocodePromise = (async () => {\n    const startTime = Date.now();\n    metrics?.incrementMetric('geocodingRequests');\n    \n    // ALWAYS try GeoGratis first\n    const geogratisCacheKey = generateGeocodingCacheKey(qp, 'geogratis');\n    const geogratisCached = await getCachedGeocoding(env, geogratisCacheKey);\n    \n    if (geogratisCached) {\n      // Check cached result quality - reject if it was interpolated or had poor score\n      const isInterpolated = geogratisCached.qualifier === 'INTERPOLATED_POSITION';\n      const hasPoorScore = geogratisCached.score !== undefined && geogratisCached.score < GEOGRATIS_MIN_SCORE;\n      \n      if (!isInterpolated && !hasPoorScore) {\n        // Cached result is good quality\n        metrics?.incrementMetric('geocodingCacheHits');\n        metrics?.recordTiming('totalGeocodingTime', Date.now() - startTime);\n        return { lon: geogratisCached.lon, lat: geogratisCached.lat } as GeocodeResult;\n      } else {\n        // Cached result was poor quality, try fresh lookup\n        console.warn(`[GEOCODING] Cached GeoGratis result was ${isInterpolated ? 'interpolated' : 'poor quality'}, fetching fresh result`);\n      }\n    }\n    \n    // Try GeoGratis API\n    try {\n      const geogratisResult = await geocodeWithGeoGratis(qp);\n      \n      if (geogratisResult) {\n        // Check if result is acceptable\n        const isInterpolated = geogratisResult.qualifier === 'INTERPOLATED_POSITION';\n        const hasPoorScore = geogratisResult.score !== undefined && geogratisResult.score < GEOGRATIS_MIN_SCORE;\n        \n        if (isInterpolated) {\n          console.warn(`[GEOCODING] GeoGratis returned INTERPOLATED_POSITION, falling back to ${env.GEOCODER || 'nominatim'}`);\n        } else if (hasPoorScore) {\n          console.warn(`[GEOCODING] GeoGratis returned poor score (${geogratisResult.score}), falling back to ${env.GEOCODER || 'nominatim'}`);\n        } else {\n          // GeoGratis result is good, use it and cache with quality info\n          await setCachedGeocoding(env, geogratisCacheKey, geogratisResult.lon, geogratisResult.lat, 'geogratis', geogratisResult.qualifier, geogratisResult.score);\n          metrics?.incrementMetric('geocodingSuccesses');\n          metrics?.recordTiming('totalGeocodingTime', Date.now() - startTime);\n          return { lon: geogratisResult.lon, lat: geogratisResult.lat } as GeocodeResult;\n        }\n      } else {\n        // GeoGratis failed\n        console.warn(`[GEOCODING] GeoGratis failed, falling back to ${env.GEOCODER || 'nominatim'}`);\n      }\n    } catch (error) {\n      // GeoGratis threw an error\n      console.warn(`[GEOCODING] GeoGratis error, falling back to ${env.GEOCODER || 'nominatim'}:`, error instanceof Error ? error.message : 'Unknown error');\n    }\n    \n    // Fallback to existing provider logic\n    const provider = (env.GEOCODER || \"nominatim\").toLowerCase();\n    \n    // Check cache for fallback provider\n    const cacheKey = generateGeocodingCacheKey(qp, provider);\n    const cached = await getCachedGeocoding(env, cacheKey);\n    if (cached) {\n      metrics?.incrementMetric('geocodingCacheHits');\n      metrics?.recordTiming('totalGeocodingTime', Date.now() - startTime);\n      return { lon: cached.lon, lat: cached.lat } as GeocodeResult;\n    }\n    \n    metrics?.incrementMetric('geocodingCacheMisses');\n    \n    // Use circuit breaker and retry for geocoding\n    let result: GeocodeResult;\n    try {\n      const geocodeFn = async (): Promise<GeocodeResult> => {\n        let geocodeResult: GeocodeResult;\n    \n        if (provider === \"google\") {\n          // Check for Google API key in header first, then fall back to environment variable\n          const headerKey = request?.headers.get(\"X-Google-API-Key\");\n          const key = headerKey || env.GOOGLE_MAPS_KEY;\n          if (!key) throw new Error(\"Google API key not provided. Set X-Google-API-Key header or configure GOOGLE_MAPS_KEY environment variable\");\n          const params = new URLSearchParams({ key });\n          // Prefer structured components when available\n          const components: string[] = [];\n          if (qp.postal) components.push(`postal_code:${qp.postal.replace(/\\s+/g, '')}`);\n          if (qp.city) components.push(`locality:${qp.city}`);\n          if (qp.state) components.push(`administrative_area:${qp.state}`);\n          // Default to Canada unless caller specifies\n          const country = (qp.country || 'CA').toUpperCase();\n          components.push(`country:${country}`);\n          if (components.length) params.set(\"components\", components.join(\"|\"));\n          if (qp.address) params.set(\"address\", qp.address);\n          // Region bias for Canada\n          params.set('region', 'ca');\n\n          const url = `https://maps.googleapis.com/maps/api/geocode/json?${params.toString()}`;\n          const resp = await fetch(url, { headers: { \"User-Agent\": \"riding-lookup/1.0\" } });\n          if (!resp.ok) throw new Error(`Google error: ${resp.status}`);\n          const rawData = await resp.json();\n          // Validate response structure with zod\n          const validation = safeValidateGoogleGeocode(rawData);\n          if (!validation.success) {\n            console.warn(`[GEOCODING] Google response validation failed:`, validation.error.errors);\n            throw new Error(`Google API response validation failed`);\n          }\n          const data = validation.data;\n          // Handle zero results or API errors without pointless retries; try Nominatim fallback immediately\n          if (data.status === 'ZERO_RESULTS' || data.status === 'REQUEST_DENIED' || data.status === 'INVALID_REQUEST' || !data.results?.length) {\n            console.error(`[GEOCODING] Google API failed (${data.status || 'no results'}), falling back to Nominatim`);\n            // Fallback to Nominatim (same shaping as below)\n            const nominatimParams = new URLSearchParams({ format: \"jsonv2\", limit: \"1\", country: \"canada\" });\n            if (qp.address) nominatimParams.set(\"street\", qp.address);\n            if (qp.city) nominatimParams.set(\"city\", qp.city);\n            if (qp.state) nominatimParams.set(\"state\", qp.state);\n            if (qp.country) nominatimParams.set(\"country\", qp.country);\n            if (qp.postal) nominatimParams.set(\"postalcode\", qp.postal);\n            if (![qp.address, qp.city, qp.state, qp.country, qp.postal].some(Boolean)) {\n              nominatimParams.set(\"q\", query);\n            }\n            const nominatimUrl = `https://nominatim.openstreetmap.org/search?${nominatimParams.toString()}`;\n            const nomResp = await fetch(nominatimUrl, { headers: { \"User-Agent\": \"riding-lookup/1.0\" } });\n            if (nomResp.ok) {\n            const rawResults = await nomResp.json();\n            // Validate Nominatim response\n            const nomValidation = safeValidateNominatim(rawResults);\n            if (!nomValidation.success) {\n              console.warn(`[GEOCODING] Nominatim response validation failed:`, nomValidation.error.errors);\n              throw new Error(`Nominatim API response validation failed`);\n            }\n            const results = nomValidation.data;\n            const first = results?.[0];\n              if (first) {\n                geocodeResult = { lon: Number(first.lon), lat: Number(first.lat) };\n                return geocodeResult;\n              }\n            }\n            console.error(`[GEOCODING] Nominatim fallback also failed, no results found`);\n            throw new NonRetriableError(\"No results from Google\");\n          }\n          \n          // Handle other Google API error statuses\n          if (data.status === 'OVER_QUERY_LIMIT' || data.status === 'UNKNOWN_ERROR') {\n            throw new Error(`Google API error: ${data.status}`);\n          }\n          \n          const loc = data.results[0].geometry.location;\n          const fmt = data.results[0].formatted_address;\n          geocodeResult = {\n            lon: loc.lng,\n            lat: loc.lat,\n            ...(typeof fmt === 'string' && fmt.length > 0 && { normalizedAddress: fmt })\n          };\n        } else if (provider === \"mapbox\") {\n          const token = env.MAPBOX_TOKEN;\n          if (!token) throw new Error(\"MAPBOX_TOKEN not configured\");\n          const resp = await fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/${encodeURIComponent(query)}.json?limit=1&proximity=ca&access_token=${token}`, {\n            headers: { \"User-Agent\": \"riding-lookup/1.0\" }\n          });\n          if (!resp.ok) throw new Error(`Mapbox error: ${resp.status}`);\n          const data = await resp.json() as MapboxResponse;\n          const feat = data?.features?.[0];\n          if (!feat?.center) throw new Error(\"No results from Mapbox\");\n          geocodeResult = { lon: feat.center[0], lat: feat.center[1] };\n        } else {\n          // Nominatim\n          // Default to Nominatim (OpenStreetMap)\n          const nominatimParams = new URLSearchParams({ format: \"jsonv2\", limit: \"1\", country: \"canada\" });\n          if (qp.address) nominatimParams.set(\"street\", qp.address);\n          if (qp.city) nominatimParams.set(\"city\", qp.city);\n          if (qp.state) nominatimParams.set(\"state\", qp.state);\n          if (qp.country) nominatimParams.set(\"country\", qp.country);\n          if (qp.postal) nominatimParams.set(\"postalcode\", qp.postal);\n          // Fallback free-form\n          if (![qp.address, qp.city, qp.state, qp.country, qp.postal].some(Boolean)) {\n            nominatimParams.set(\"q\", query);\n          }\n          const nominatimUrl = `https://nominatim.openstreetmap.org/search?${nominatimParams.toString()}`;\n          const resp = await fetch(nominatimUrl, { headers: { \"User-Agent\": \"riding-lookup/1.0\" } });\n          if (!resp.ok) throw new Error(`Nominatim error: ${resp.status}`);\n          const rawResults = await resp.json();\n          // Validate Nominatim response\n          const nomValidation = safeValidateNominatim(rawResults);\n          if (!nomValidation.success) {\n            console.warn(`[GEOCODING] Nominatim response validation failed:`, nomValidation.error.errors);\n            throw new Error(`Nominatim API response validation failed`);\n          }\n          const results = nomValidation.data;\n          const first = results?.[0];\n          if (!first) throw new Error(\"No results from Nominatim\");\n          geocodeResult = { lon: Number(first.lon), lat: Number(first.lat) };\n        }\n        return geocodeResult;\n      };\n\n      const retryConfig = getRetryConfig();\n      if (circuitBreaker) {\n        result = await circuitBreaker.execute(`geocoding:${provider}`, async () => {\n          return await withRetry(geocodeFn, retryConfig, `Geocoding ${provider}`);\n        });\n      } else {\n        result = await withRetry(geocodeFn, retryConfig, `Geocoding ${provider}`);\n      }\n      \n      metrics?.incrementMetric('geocodingSuccesses');\n    } catch (error) {\n      console.error(`[GEOCODING] Geocoding failed after ${Date.now() - startTime}ms:`, error instanceof Error ? error.message : 'Unknown error');\n      metrics?.incrementMetric('geocodingFailures');\n      if (error instanceof Error && error.message.includes('Circuit breaker is OPEN')) {\n        console.error(`[GEOCODING] Circuit breaker is OPEN for provider: ${provider}`);\n        metrics?.incrementMetric('geocodingCircuitBreakerTrips');\n      }\n      throw error;\n    }\n    \n    // Cache the result\n    await setCachedGeocoding(env, cacheKey, result.lon, result.lat, provider);\n    \n    metrics?.recordTiming('totalGeocodingTime', Date.now() - startTime);\n    return result;\n  })();\n\n  return withTimeout(geocodePromise, timeoutMs, \"Geocoding\");\n}\n\n// Batch geocoding with Google\nexport async function geocodeBatchWithGoogle(\n  env: Env, \n  queries: QueryParams[], \n  apiKey: string\n): Promise<GeocodeBatchResult[]> {\n  const results: GeocodeBatchResult[] = [];\n  const errors: string[] = [];\n  \n  // Convert queries to Google batch format\n  const addresses = queries.map(query => {\n    const addressParts: string[] = [];\n    \n    if (query.address) addressParts.push(query.address);\n    if (query.postal) addressParts.push(query.postal);\n    if (query.city) addressParts.push(query.city);\n    if (query.state) addressParts.push(query.state);\n    if (query.country) addressParts.push(query.country);\n    \n    return {\n      address: addressParts.join(', ')\n    };\n  });\n\n  const batchRequest: GoogleBatchGeocodeRequest = {\n    addresses\n  };\n\n  try {\n    const response = await fetch(`https://maps.googleapis.com/maps/api/geocode/json?key=${apiKey}`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'User-Agent': 'riding-lookup/1.0'\n      },\n      body: JSON.stringify(batchRequest)\n    });\n\n    if (!response.ok) {\n      const errorMsg = `Google batch geocoding HTTP error: ${response.status}`;\n      errors.push(errorMsg);\n      // Return failures for all queries\n      for (let i = 0; i < queries.length; i++) {\n        results.push({ lon: 0, lat: 0, success: false, error: errorMsg });\n      }\n      return results;\n    }\n    \n    const rawData = await response.json();\n    // Validate batch response structure\n    const validation = safeValidateGoogleBatchGeocode(rawData);\n    if (!validation.success) {\n      const errorMsg = `Google batch geocoding validation failed: ${validation.error.errors.map(e => e.message).join(', ')}`;\n      console.warn(`[GEOCODING] ${errorMsg}`);\n      errors.push(errorMsg);\n      // Return failures for all queries\n      for (let i = 0; i < queries.length; i++) {\n        results.push({ lon: 0, lat: 0, success: false, error: errorMsg });\n      }\n      return results;\n    }\n    \n    const data = validation.data;\n    \n    if (data.results && data.results.length === queries.length) {\n      // Process batch results\n      let successCount = 0;\n      let failureCount = 0;\n      \n      for (let i = 0; i < data.results.length; i++) {\n        const result = data.results[i];\n        const query = queries[i];\n        \n        if (result.geometry?.location) {\n          results.push({\n            lon: result.geometry.location.lng,\n            lat: result.geometry.location.lat,\n            success: true\n          });\n          successCount++;\n        } else {\n          const errorMsg = `No results for query: ${query.address || query.postal || query.city || 'unknown'}`;\n          results.push({\n            lon: 0,\n            lat: 0,\n            success: false,\n            error: errorMsg\n          });\n          errors.push(`Query ${i}: ${errorMsg}`);\n          failureCount++;\n        }\n      }\n      \n      if (failureCount > 0) {\n        console.warn(`Batch geocoding: ${successCount} succeeded, ${failureCount} failed out of ${queries.length} total`);\n      }\n    } else {\n      // Batch response doesn't match query count - fallback to individual\n      const errorMsg = `Batch response mismatch: expected ${queries.length} results, got ${data.results?.length || 0}`;\n      errors.push(errorMsg);\n      console.warn(errorMsg + ', falling back to individual geocoding');\n      \n      // Fallback to individual geocoding\n      for (let i = 0; i < queries.length; i++) {\n        const query = queries[i];\n        try {\n          const result = await geocodeIfNeeded(env, query);\n          results.push({ ...result, success: true });\n        } catch (error) {\n          const errorMsg = error instanceof Error ? error.message : 'Geocoding failed';\n          results.push({\n            lon: 0,\n            lat: 0,\n            success: false,\n            error: errorMsg\n          });\n          errors.push(`Query ${i}: ${errorMsg}`);\n        }\n      }\n    }\n  } catch (error) {\n    const errorMsg = error instanceof Error ? error.message : 'Unknown error';\n    console.error('Google batch geocoding failed:', errorMsg);\n    errors.push(`Batch API error: ${errorMsg}`);\n    \n    // Fallback to individual geocoding\n    for (let i = 0; i < queries.length; i++) {\n      const query = queries[i];\n      try {\n        const result = await geocodeIfNeeded(env, query);\n        results.push({ ...result, success: true });\n      } catch (individualError) {\n        const errorMsg = individualError instanceof Error ? individualError.message : 'Geocoding failed';\n        results.push({\n          lon: 0,\n          lat: 0,\n          success: false,\n          error: errorMsg\n        });\n        errors.push(`Query ${i}: ${errorMsg}`);\n      }\n    }\n  }\n\n  // Log aggregated errors if any\n  if (errors.length > 0) {\n    console.warn(`Batch geocoding errors (${errors.length}):`, errors.slice(0, 5)); // Log first 5 errors\n  }\n\n  return results;\n}\n\n// Batch geocoding function\n/**\n * Geocodes multiple addresses, using batch API when available or falling back to individual requests.\n * Automatically selects the best geocoding strategy based on configuration.\n * \n * @param env - Environment bindings (API keys, KV cache)\n * @param queries - Array of query parameter objects to geocode\n * @param request - Optional request object for extracting Google API key\n * @returns Promise resolving to array of geocoding results with error information\n */\nexport async function geocodeBatch(\n  env: Env, \n  queries: QueryParams[], \n  request?: Request,\n  metrics?: {\n    incrementMetric: (key: keyof import('./types').Metrics, value?: number) => void;\n    recordTiming: (key: keyof import('./types').Metrics, duration: number) => void;\n  },\n  circuitBreaker?: {\n    execute: (key: string, fn: () => Promise<any>) => Promise<any>;\n  }\n): Promise<GeocodeBatchResult[]> {\n  if (!BATCH_GEOCODING_CONFIG.ENABLED || queries.length === 0) {\n    return [];\n  }\n\n  const results: GeocodeBatchResult[] = [];\n  \n  // Process in batches\n  const batchSize = BATCH_GEOCODING_CONFIG.MAX_BATCH_SIZE;\n  for (let i = 0; i < queries.length; i += batchSize) {\n    const batch = queries.slice(i, i + batchSize);\n    \n    try {\n      if (BATCH_GEOCODING_CONFIG.PROVIDER === 'google' && env.GOOGLE_MAPS_KEY) {\n        const batchResults = await geocodeBatchWithGoogle(env, batch, env.GOOGLE_MAPS_KEY);\n        results.push(...batchResults);\n      } else {\n        // GeoGratis-first individual geocoding\n        for (const query of batch) {\n          try {\n            const result = await geocodeIfNeeded(env, query, request, metrics, circuitBreaker);\n            results.push({ lon: result.lon, lat: result.lat, success: true, normalizedAddress: result.normalizedAddress });\n          } catch (error) {\n            results.push({\n              lon: 0,\n              lat: 0,\n              success: false,\n              error: error instanceof Error ? error.message : 'Geocoding failed'\n            });\n          }\n        }\n      }\n    } catch (error) {\n      console.error(`Batch geocoding failed for batch ${i / BATCH_GEOCODING_CONFIG.MAX_BATCH_SIZE + 1}:`, error);\n\n      for (const query of batch) {\n        try {\n          const result = await geocodeIfNeeded(env, query, request, metrics, circuitBreaker);\n          results.push({ lon: result.lon, lat: result.lat, success: true, normalizedAddress: result.normalizedAddress });\n        } catch (individualError) {\n          results.push({\n            lon: 0,\n            lat: 0,\n            success: false,\n            error: individualError instanceof Error ? individualError.message : 'Geocoding failed'\n          });\n        }\n      }\n    }\n  }\n\n  return results;\n}\n", "import { CircuitBreakerState, Env } from './types';\n\n/**\n * Circuit breaker wrapper that uses Durable Object for shared state when available,\n * falls back to in-memory state when Durable Object is not configured.\n */\nexport class CircuitBreaker {\n  private states = new Map<string, CircuitBreakerState>();\n  private failureThreshold: number;\n  private recoveryTimeout: number;\n  private successThreshold: number;\n  private env?: Env;\n  private useDurableObject: boolean;\n\n  constructor(failureThreshold = 5, recoveryTimeout = 60000, successThreshold = 3, env?: Env) {\n    this.failureThreshold = failureThreshold;\n    this.recoveryTimeout = recoveryTimeout;\n    this.successThreshold = successThreshold;\n    this.env = env;\n    this.useDurableObject = !!env?.CIRCUIT_BREAKER_DO;\n  }\n\n  /**\n   * Get the Durable Object stub for circuit breaker state.\n   */\n  private getDOStub() {\n    if (!this.env?.CIRCUIT_BREAKER_DO) return null;\n    // Use a single Durable Object instance for all circuit breakers\n    const id = this.env.CIRCUIT_BREAKER_DO.idFromName('circuit-breaker');\n    return this.env.CIRCUIT_BREAKER_DO.get(id);\n  }\n\n  async execute<T>(key: string, operation: () => Promise<T>): Promise<T> {\n    // Use Durable Object if available, otherwise use local state\n    if (this.useDurableObject) {\n      const stub = this.getDOStub();\n      if (stub) {\n        try {\n          // Check state with Durable Object\n          const checkResponse = await stub.fetch(new Request('https://circuit-breaker/check', {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({ key })\n          }));\n          \n          if (checkResponse.ok) {\n            const checkResult = await checkResponse.json() as { allowed: boolean; state: CircuitBreakerState };\n            if (!checkResult.allowed) {\n              throw new Error(`Circuit breaker is OPEN for ${key}`);\n            }\n            \n            // Execute operation locally, then report result to DO\n            try {\n              const result = await operation();\n              await this.reportSuccess(key);\n              return result;\n            } catch (error) {\n              await this.reportFailure(key);\n              throw error;\n            }\n          }\n        } catch (error) {\n          // Fallback to local state if DO call fails\n          if (error instanceof Error && error.message.includes('Circuit breaker is OPEN')) {\n            throw error;\n          }\n          console.warn('[CircuitBreaker] Durable Object call failed, using local state:', error);\n        }\n      }\n    }\n    \n    // Fallback to local state\n    const state = this.getState(key);\n    \n    if (state.state === 'OPEN') {\n      if (Date.now() - state.lastFailureTime > this.recoveryTimeout) {\n        state.state = 'HALF_OPEN';\n        state.successCount = 0;\n      } else {\n        throw new Error(`Circuit breaker is OPEN for ${key}`);\n      }\n    }\n\n    try {\n      const result = await operation();\n      this.onSuccess(key);\n      return result;\n    } catch (error) {\n      this.onFailure(key);\n      throw error;\n    }\n  }\n\n  private getState(key: string): CircuitBreakerState {\n    if (!this.states.has(key)) {\n      this.states.set(key, {\n        state: 'CLOSED',\n        failureCount: 0,\n        lastFailureTime: 0,\n        successCount: 0,\n        nextAttemptTime: 0\n      });\n    }\n    return this.states.get(key)!;\n  }\n\n  private onSuccess(key: string): void {\n    const state = this.getState(key);\n    state.failureCount = 0;\n    \n    if (state.state === 'HALF_OPEN') {\n      state.successCount++;\n      if (state.successCount >= this.successThreshold) {\n        state.state = 'CLOSED';\n      }\n    }\n  }\n\n  private onFailure(key: string): void {\n    const state = this.getState(key);\n    state.failureCount++;\n    state.lastFailureTime = Date.now();\n    state.nextAttemptTime = Date.now() + this.recoveryTimeout;\n    \n    if (state.failureCount >= this.failureThreshold) {\n      state.state = 'OPEN';\n    }\n  }\n\n  /**\n   * Get state from Durable Object or local state.\n   */\n  private async getDOState(key: string): Promise<CircuitBreakerState | null> {\n    if (this.useDurableObject) {\n      const stub = this.getDOStub();\n      if (stub) {\n        try {\n          const response = await stub.fetch(new Request(`https://circuit-breaker/state?key=${encodeURIComponent(key)}`));\n          if (response.ok) {\n            return await response.json() as CircuitBreakerState;\n          }\n        } catch (error) {\n          console.warn('[CircuitBreaker] Failed to get state from DO:', error);\n        }\n      }\n    }\n    return this.states.get(key) || null;\n  }\n\n  /**\n   * Report success to Durable Object or update local state.\n   */\n  private async reportSuccess(key: string): Promise<void> {\n    if (this.useDurableObject) {\n      const stub = this.getDOStub();\n      if (stub) {\n        try {\n          await stub.fetch(new Request('https://circuit-breaker/success', {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({ key })\n          }));\n          return;\n        } catch (error) {\n          console.warn('[CircuitBreaker] Failed to report success to DO:', error);\n        }\n      }\n    }\n    this.onSuccess(key);\n  }\n\n  /**\n   * Report failure to Durable Object or update local state.\n   */\n  private async reportFailure(key: string): Promise<void> {\n    if (this.useDurableObject) {\n      const stub = this.getDOStub();\n      if (stub) {\n        try {\n          await stub.fetch(new Request('https://circuit-breaker/failure', {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({ key })\n          }));\n          return;\n        } catch (error) {\n          console.warn('[CircuitBreaker] Failed to report failure to DO:', error);\n        }\n      }\n    }\n    this.onFailure(key);\n  }\n\n  async getStateInfo(key: string): Promise<CircuitBreakerState | null> {\n    if (this.useDurableObject) {\n      return await this.getDOState(key);\n    }\n    return this.states.get(key) || null;\n  }\n\n  // Get all circuit breaker states for monitoring\n  async getAllStates(): Promise<Map<string, CircuitBreakerState>> {\n    if (this.useDurableObject) {\n      const stub = this.getDOStub();\n      if (stub) {\n        try {\n          const response = await stub.fetch(new Request('https://circuit-breaker/state'));\n          if (response.ok) {\n            const statesObj = await response.json() as Record<string, CircuitBreakerState>;\n            return new Map(Object.entries(statesObj));\n          }\n        } catch (error) {\n          console.warn('[CircuitBreaker] Failed to get all states from DO:', error);\n        }\n      }\n    }\n    return new Map(this.states);\n  }\n\n  // Reset a specific circuit breaker\n  async reset(key: string): Promise<void> {\n    if (this.useDurableObject) {\n      const stub = this.getDOStub();\n      if (stub) {\n        try {\n          await stub.fetch(new Request(`https://circuit-breaker/reset?key=${encodeURIComponent(key)}`, { method: 'POST' }));\n          return;\n        } catch (error) {\n          console.warn('[CircuitBreaker] Failed to reset in DO:', error);\n        }\n      }\n    }\n    this.states.delete(key);\n  }\n\n  // Reset all circuit breakers\n  async resetAll(): Promise<void> {\n    if (this.useDurableObject) {\n      const stub = this.getDOStub();\n      if (stub) {\n        try {\n          await stub.fetch(new Request('https://circuit-breaker/reset', { method: 'POST' }));\n          return;\n        } catch (error) {\n          console.warn('[CircuitBreaker] Failed to reset all in DO:', error);\n        }\n      }\n    }\n    this.states.clear();\n  }\n}\n\n/**\n * Factory function to create circuit breakers with environment support.\n */\nexport function createCircuitBreaker(failureThreshold: number, recoveryTimeout: number, successThreshold: number, env?: Env): CircuitBreaker {\n  return new CircuitBreaker(failureThreshold, recoveryTimeout, successThreshold, env);\n}\n\n// Create circuit breaker instances (will be initialized with env in worker)\nexport let geocodingCircuitBreaker: CircuitBreaker;\nexport let r2CircuitBreaker: CircuitBreaker;\n\n/**\n * Initialize circuit breakers with environment.\n * Call this from worker.ts on startup.\n */\nexport function initializeCircuitBreakers(env: Env): void {\n  geocodingCircuitBreaker = new CircuitBreaker(3, 30000, 2, env); // 3 failures, 30s timeout, 2 successes to close\n  r2CircuitBreaker = new CircuitBreaker(5, 60000, 3, env); // 5 failures, 60s timeout, 3 successes to close\n}\n", "import { Env, QueryParams, GeoJSONGeometry, GeoJSONFeature } from './types';\nimport { TIMEOUT_CONFIG, RETRY_CONFIG, getRetryConfig } from './config';\n\n// Re-export for backward compatibility\nexport const DEFAULT_TIMEOUTS = TIMEOUT_CONFIG;\nexport const DEFAULT_RETRY_CONFIG = RETRY_CONFIG;\n\nexport const DEFAULT_RATE_LIMIT = 100; // requests per minute\n\n// Rate limiting store\nconst rateLimitStore = new Map<string, { count: number; resetTime: number }>();\n\n// Cleanup expired rate limit entries to prevent memory leaks\nfunction cleanupRateLimitStore(): void {\n  const now = Date.now();\n  const entriesToDelete: string[] = [];\n  \n  for (const [clientId, entry] of rateLimitStore.entries()) {\n    // Remove entries that are expired by more than 5 minutes (safety margin)\n    if (now > entry.resetTime + 5 * 60 * 1000) {\n      entriesToDelete.push(clientId);\n    }\n  }\n  \n  for (const clientId of entriesToDelete) {\n    rateLimitStore.delete(clientId);\n  }\n  \n  // If store is getting large, do more aggressive cleanup\n  if (rateLimitStore.size > 10000) {\n    const allEntries = Array.from(rateLimitStore.entries());\n    allEntries.sort((a, b) => a[1].resetTime - b[1].resetTime);\n    // Keep only the most recent 5000 entries\n    for (let i = 0; i < allEntries.length - 5000; i++) {\n      rateLimitStore.delete(allEntries[i][0]);\n    }\n  }\n}\n\n// Validation interfaces\nexport interface ValidationResult {\n  valid: boolean;\n  sanitized?: QueryParams;\n  error?: string;\n}\n\nexport interface RetryConfig {\n  maxAttempts: number;\n  baseDelay: number;\n  maxDelay: number;\n  backoffMultiplier: number;\n  jitter: boolean;\n}\n\n/**\n * Determines if a geographic point is inside a GeoJSON polygon or multipolygon.\n * Uses ray casting algorithm with explicit boundary point handling.\n * \n * @param lon - Longitude of the point (-180 to 180)\n * @param lat - Latitude of the point (-90 to 90)\n * @param geometry - GeoJSON geometry (Polygon or MultiPolygon)\n * @returns true if point is inside the polygon (including on boundaries), false otherwise\n */\nexport function isPointInPolygon(lon: number, lat: number, geometry: GeoJSONGeometry): boolean {\n  const point = [lon, lat];\n  const type = geometry?.type;\n  const coords = geometry?.coordinates;\n  if (!type || !coords) return false;\n\n  if (type === \"Polygon\") {\n    return polygonContains(point, coords as number[][][]);\n  }\n  if (type === \"MultiPolygon\") {\n    for (const poly of coords) {\n      if (polygonContains(point, poly as number[][][])) return true;\n    }\n    return false;\n  }\n  return false;\n}\n\n/**\n * Checks if a point is contained within a polygon, handling holes.\n * Points on the outer boundary are considered inside; points inside holes are considered outside.\n * \n * @param point - [longitude, latitude] coordinates\n * @param polygon - Array of rings: [outerRing, hole1, hole2, ...] where each ring is [[lon, lat], ...]\n * @returns true if point is inside the polygon (not in any holes), false otherwise\n */\nexport function polygonContains(point: number[], polygon: number[][][]): boolean {\n  // polygon: [ [ [lon,lat], ... ] outerRing, hole1, hole2, ... ]\n  if (!Array.isArray(polygon) || polygon.length === 0) return false;\n  \n  const outerRing = polygon[0] as number[][];\n  if (!outerRing || !Array.isArray(outerRing)) return false;\n  \n  // Check if point is in outer ring (including boundary)\n  const inOuterRing = ringContains(point, outerRing);\n  if (!inOuterRing) return false;\n  \n  // Check if point is in any hole (if point is on hole boundary, it's considered outside)\n  for (let i = 1; i < polygon.length; i++) {\n    const hole = polygon[i];\n    if (!hole || !Array.isArray(hole)) continue;\n    \n    // Check if point is strictly inside a hole (not on boundary)\n    // For holes, we want to exclude points that are inside, but include points on the boundary\n    const inHole = ringContains(point, hole);\n    if (inHole) {\n      // Double-check: if point is exactly on hole boundary, it should be considered inside polygon\n      // But if it's strictly inside the hole, it's outside the polygon\n      // The ringContains function already handles boundary cases, so if it returns true\n      // and the point is on the boundary, we should still consider it inside the polygon\n      // For now, we'll be conservative: if inHole is true, exclude it\n      return false;\n    }\n  }\n  \n  return true;\n}\n\n/**\n * Checks if a point is inside a closed ring using ray casting algorithm.\n * Points exactly on the ring boundary are considered inside.\n * \n * @param point - [longitude, latitude] coordinates\n * @param ring - Array of [longitude, latitude] coordinate pairs forming a closed ring\n * @returns true if point is inside or on the ring boundary, false otherwise\n */\nexport function ringContains(point: number[], ring: number[][]): boolean {\n  if (!Array.isArray(ring) || ring.length < 3) return false;\n  \n  const [px, py] = point;\n  let inside = false;\n  \n  // First check if point is exactly on the boundary\n  for (let i = 0, j = ring.length - 1; i < ring.length; j = i++) {\n    const [x1, y1] = ring[i];\n    const [x2, y2] = ring[j];\n    \n    // Check if point is on the edge segment\n    const minX = Math.min(x1, x2);\n    const maxX = Math.max(x1, x2);\n    const minY = Math.min(y1, y2);\n    const maxY = Math.max(y1, y2);\n    \n    // Point is on boundary if it's on the line segment\n    if (px >= minX && px <= maxX && py >= minY && py <= maxY) {\n      // Check if point is collinear with the segment\n      const crossProduct = (py - y1) * (x2 - x1) - (px - x1) * (y2 - y1);\n      const tolerance = 1e-10; // Small tolerance for floating point comparison\n      if (Math.abs(crossProduct) < tolerance) {\n        return true; // Point is on boundary, consider it inside\n      }\n    }\n    \n    // Ray casting algorithm for interior points\n    const intersect = ((y1 > py) !== (y2 > py)) &&\n      (px < (x2 - x1) * (py - y1) / (y2 - y1 + 1e-10) + x1);\n    if (intersect) inside = !inside;\n  }\n  \n  return inside;\n}\n\n/**\n * Sanitizes a string input by removing control characters and limiting length.\n * \n * @param input - The string to sanitize\n * @param maxLength - Maximum allowed length (default: 1000)\n * @returns Sanitized string or undefined if input is empty/invalid\n */\nexport function sanitizeString(input: string | undefined, maxLength: number = 1000): string | undefined {\n  if (!input) return undefined;\n  \n  // Remove null bytes and control characters\n  let sanitized = input.replace(/[\\x00-\\x1F\\x7F]/g, '');\n  \n  // Trim whitespace\n  sanitized = sanitized.trim();\n  \n  // Limit length\n  if (sanitized.length > maxLength) {\n    sanitized = sanitized.substring(0, maxLength);\n  }\n  \n  return sanitized.length > 0 ? sanitized : undefined;\n}\n\n/**\n * Validates geographic coordinates.\n * \n * @param lat - Latitude (-90 to 90, inclusive)\n * @param lon - Longitude (-180 to 180, inclusive)\n * @returns Validation result with sanitized coordinates or error message\n */\nexport function validateCoordinates(lat: number | undefined, lon: number | undefined): { valid: boolean; lat?: number; lon?: number; error?: string } {\n  if (lat === undefined && lon === undefined) {\n    return { valid: true };\n  }\n  \n  if (lat === undefined || lon === undefined) {\n    return { valid: false, error: \"Both lat and lon must be provided together\" };\n  }\n  \n  // Check for valid coordinate ranges (boundaries are inclusive: -90 <= lat <= 90, -180 <= lon <= 180)\n  if (lat < -90 || lat > 90) {\n    return { valid: false, error: \"Latitude must be between -90 and 90 (inclusive)\" };\n  }\n  \n  if (lon < -180 || lon > 180) {\n    return { valid: false, error: \"Longitude must be between -180 and 180 (inclusive)\" };\n  }\n  \n  // Check for NaN or Infinity\n  if (!isFinite(lat) || !isFinite(lon)) {\n    return { valid: false, error: \"Coordinates must be finite numbers\" };\n  }\n  \n  return { valid: true, lat, lon };\n}\n\n/**\n * Validates and sanitizes postal codes.\n * Strictly validates Canadian postal codes (A1A 1A1 format), but allows\n * international postal codes to pass through for geocoding services.\n * \n * @param postal - Postal code string to validate\n * @returns Validation result with sanitized postal code or error message\n */\nexport function validatePostalCode(postal: string): { valid: boolean; sanitized?: string; error?: string } {\n  if (!postal) return { valid: true };\n  \n  // Canadian postal code pattern: A1A 1A1 or A1A1A1\n  const canadianPattern = /^[A-Za-z]\\d[A-Za-z][\\s]?\\d[A-Za-z]\\d$/;\n  const sanitized = postal.replace(/\\s+/g, '').toUpperCase();\n  \n  if (canadianPattern.test(sanitized)) {\n    // Valid Canadian postal code - format it properly\n    return { valid: true, sanitized: sanitized.substring(0, 3) + ' ' + sanitized.substring(3) };\n  }\n  \n  // Not a Canadian postal code, but allow it to pass through for geocoding\n  // Just sanitize by removing extra spaces and converting to uppercase\n  const cleaned = postal.trim().replace(/\\s+/g, ' ').toUpperCase();\n  if (cleaned.length > 0 && cleaned.length <= 20) {\n    return { valid: true, sanitized: cleaned };\n  }\n  \n  // Postal code is too long or empty after cleaning\n  return { valid: false, error: \"Postal code format is invalid or too long\" };\n}\n\n/**\n * Validates and sanitizes query parameters for riding lookup requests.\n * Ensures coordinates are valid, postal codes are properly formatted,\n * and string inputs are sanitized.\n * \n * @param query - Raw query parameters from request\n * @returns Validation result with sanitized parameters or error message\n */\nexport function validateAndSanitizeQuery(query: QueryParams): ValidationResult {\n  const sanitized: QueryParams = {};\n  \n  // Sanitize string inputs\n  sanitized.address = sanitizeString(query.address, 500);\n  sanitized.city = sanitizeString(query.city, 100);\n  sanitized.state = sanitizeString(query.state, 100);\n  sanitized.country = sanitizeString(query.country, 100);\n  \n  // Validate postal code\n  if (query.postal) {\n    const postalValidation = validatePostalCode(query.postal);\n    if (!postalValidation.valid) {\n      return { valid: false, error: postalValidation.error };\n    }\n    sanitized.postal = postalValidation.sanitized;\n  }\n  \n  // Validate coordinates\n  const coordValidation = validateCoordinates(query.lat, query.lon);\n  if (!coordValidation.valid) {\n    return { valid: false, error: coordValidation.error };\n  }\n  if (coordValidation.lat !== undefined && coordValidation.lon !== undefined) {\n    sanitized.lat = coordValidation.lat;\n    sanitized.lon = coordValidation.lon;\n  }\n  \n  // Check that at least one location parameter is provided\n  const hasLocation = sanitized.address || sanitized.postal || sanitized.city || \n                     sanitized.state || sanitized.country || \n                     (sanitized.lat !== undefined && sanitized.lon !== undefined);\n  \n  if (!hasLocation) {\n    return { valid: false, error: \"At least one location parameter must be provided\" };\n  }\n  \n  return { valid: true, sanitized };\n}\n\n/**\n * Executes an async operation with automatic retry logic using exponential backoff.\n * \n * @param operation - The async function to execute\n * @param config - Retry configuration (maxAttempts, baseDelay, maxDelay, backoffMultiplier, jitter)\n * @param context - Context string for logging purposes\n * @returns The result of the operation\n * @throws The last error if all retry attempts fail\n */\nexport async function withRetry<T>(\n  operation: () => Promise<T>,\n  config: RetryConfig = getRetryConfig(),\n  context: string = 'operation'\n): Promise<T> {\n  let lastError: Error;\n  \n  for (let attempt = 1; attempt <= config.maxAttempts; attempt++) {\n    try {\n      return await operation();\n    } catch (error) {\n      lastError = error as Error;\n      \n      if (attempt === config.maxAttempts) {\n        console.error(`${context} failed after ${config.maxAttempts} attempts:`, lastError.message);\n        throw lastError;\n      }\n      \n      // Calculate delay with exponential backoff\n      const delay = Math.min(\n        config.baseDelay * Math.pow(config.backoffMultiplier, attempt - 1),\n        config.maxDelay\n      );\n      \n      // Add jitter to prevent thundering herd\n      const jitteredDelay = config.jitter \n        ? delay + Math.random() * 1000 \n        : delay;\n      \n      console.warn(`${context} attempt ${attempt} failed, retrying in ${Math.round(jitteredDelay)}ms:`, lastError.message);\n      await new Promise(resolve => setTimeout(resolve, jitteredDelay));\n    }\n  }\n  \n  throw lastError!;\n}\n\n/**\n * Wraps a promise with a timeout, rejecting if the operation takes too long.\n * \n * @param promise - The promise to wrap\n * @param timeoutMs - Timeout duration in milliseconds\n * @param operation - Operation name for error messages\n * @returns The result of the promise if it completes within the timeout\n * @throws Error if the operation times out\n */\nexport async function withTimeout<T>(\n  promise: Promise<T>,\n  timeoutMs: number,\n  operation: string\n): Promise<T> {\n  const timeoutPromise = new Promise<never>((_, reject) => {\n    setTimeout(() => reject(new Error(`${operation} timeout after ${timeoutMs}ms`)), timeoutMs);\n  });\n  \n  return Promise.race([promise, timeoutPromise]);\n}\n\n/**\n * Checks if a client has exceeded the rate limit.\n * Uses in-memory store with automatic cleanup to prevent memory leaks.\n * \n * @param env - Environment bindings containing RATE_LIMIT configuration\n * @param clientId - Unique identifier for the client (IP address or API key)\n * @returns true if request is allowed, false if rate limit exceeded\n */\nexport function checkRateLimit(env: Env, clientId: string): boolean {\n  // Cleanup expired entries periodically (every 100th call to avoid overhead)\n  if (Math.random() < 0.01) {\n    cleanupRateLimitStore();\n  }\n  \n  const rateLimit = env.RATE_LIMIT || DEFAULT_RATE_LIMIT;\n  const now = Date.now();\n  const windowMs = 60 * 1000; // 1 minute window\n  \n  const current = rateLimitStore.get(clientId);\n  if (!current || now > current.resetTime) {\n    rateLimitStore.set(clientId, { count: 1, resetTime: now + windowMs });\n    return true;\n  }\n  \n  if (current.count >= rateLimit) {\n    return false;\n  }\n  \n  current.count++;\n  return true;\n}\n\n/**\n * Extracts a unique client identifier from the request for rate limiting.\n * Prioritizes API key, then Cloudflare connecting IP, then X-Forwarded-For header.\n * \n * @param request - The incoming HTTP request\n * @returns Client identifier string (e.g., \"api:key123\" or \"ip:1.2.3.4\")\n */\nexport function getClientId(request: Request): string {\n  // Use IP address or API key for rate limiting\n  const apiKey = request.headers.get(\"X-Google-API-Key\");\n  if (apiKey) return `api:${apiKey}`;\n  \n  const cfConnectingIp = request.headers.get(\"CF-Connecting-IP\");\n  const xForwardedFor = request.headers.get(\"X-Forwarded-For\");\n  const ip = cfConnectingIp || xForwardedFor?.split(',')[0] || \"unknown\";\n  return `ip:${ip}`;\n}\n\n// Generate correlation ID for request tracing\nexport function generateCorrelationId(): string {\n  return `req_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n}\n\n/**\n * Extracts correlation ID from request headers or generates a new one.\n * Used for request tracing and debugging across distributed systems.\n * \n * @param request - The incoming HTTP request\n * @returns Correlation ID string (from X-Correlation-ID, X-Request-ID, or newly generated)\n */\nexport function getCorrelationId(request: Request): string {\n  return request.headers.get(\"X-Correlation-ID\") || \n         request.headers.get(\"X-Request-ID\") || \n         generateCorrelationId();\n}\n\n// Dataset selection\nexport function pickDataset(pathname: string): { r2Key: string } {\n  // Map routes to R2 object keys\n  if (pathname === \"/api/qc\") return { r2Key: \"quebecridings-2025.geojson\" };\n  if (pathname === \"/api/on\") return { r2Key: \"ontarioridings-2022.geojson\" };\n  // default federal\n  return { r2Key: \"federalridings-2024.geojson\" };\n}\n\n// Query parsing\nexport function parseQuery(request: Request): { query: QueryParams; validation: ValidationResult } {\n  const url = new URL(request.url);\n  const q = url.searchParams;\n  \n  // Parse raw query parameters\n  const rawQuery: QueryParams = {\n    address: q.get(\"address\") || undefined,\n    postal: q.get(\"postal\") || q.get(\"postal_code\") || undefined,\n    city: q.get(\"city\") || undefined,\n    state: q.get(\"state\") || q.get(\"province\") || undefined,\n    country: q.get(\"country\") || undefined,\n    lat: q.get(\"lat\") ? Number(q.get(\"lat\")) : undefined,\n    lon: q.get(\"lon\") || q.get(\"lng\") || q.get(\"long\") ? Number(q.get(\"lon\") || q.get(\"lng\") || q.get(\"long\")) : undefined\n  };\n  \n  // Validate and sanitize\n  const validation = validateAndSanitizeQuery(rawQuery);\n  \n  return { query: rawQuery, validation };\n}\n\n// Standardized error response format\nexport interface ErrorResponse {\n  error: string;\n  code?: string;\n  correlationId?: string;\n  timestamp?: number;\n  details?: Record<string, unknown>;\n}\n\n// Response utility functions with standardized error format\nexport function badRequest(message: string, status = 400, code?: string, correlationId?: string, details?: Record<string, unknown>): Response {\n  const errorResponse: ErrorResponse = {\n    error: message,\n    timestamp: Date.now()\n  };\n  if (code) errorResponse.code = code;\n  if (correlationId) errorResponse.correlationId = correlationId;\n  if (details) errorResponse.details = details;\n  \n  return new Response(JSON.stringify(errorResponse), {\n    status,\n    headers: { \"content-type\": \"application/json; charset=UTF-8\" }\n  });\n}\n\nexport function unauthorizedResponse(correlationId?: string): Response {\n  const errorResponse: ErrorResponse = {\n    error: \"Unauthorized\",\n    code: \"UNAUTHORIZED\",\n    timestamp: Date.now()\n  };\n  if (correlationId) errorResponse.correlationId = correlationId;\n  \n  return new Response(JSON.stringify(errorResponse), {\n    status: 401,\n    headers: { \n      \"content-type\": \"application/json; charset=UTF-8\",\n      \"WWW-Authenticate\": \"Basic realm=\\\"Riding Lookup API\\\"\"\n    }\n  });\n}\n\nexport function rateLimitExceededResponse(correlationId?: string): Response {\n  const errorResponse: ErrorResponse = {\n    error: \"Rate limit exceeded\",\n    code: \"RATE_LIMIT_EXCEEDED\",\n    timestamp: Date.now()\n  };\n  if (correlationId) errorResponse.correlationId = correlationId;\n  \n  return new Response(JSON.stringify(errorResponse), {\n    status: 429,\n    headers: { \n      \"content-type\": \"application/json; charset=UTF-8\",\n      \"Retry-After\": \"60\"\n    }\n  });\n}\n\n// Authentication\n/**\n * Checks if the request is authorized.\n * \n * Security Model:\n * - If BASIC_AUTH is not configured, authentication is skipped (all requests allowed)\n * - If X-Google-API-Key header is provided, basic auth is bypassed (BYOK - Bring Your Own Key)\n *   This allows users to use their own Google Maps API key without needing the configured\n *   basic auth credentials. Note: If the Google API key is compromised, the attacker\n *   will have full access to the API.\n * - Otherwise, HTTP Basic Authentication is required using the configured BASIC_AUTH secret\n * \n * @param request - The incoming request\n * @param env - Environment variables including BASIC_AUTH\n * @returns true if authorized, false otherwise\n */\nexport function checkBasicAuth(request: Request, env: Env): boolean {\n  // If BASIC_AUTH is not configured, skip authentication\n  if (!env.BASIC_AUTH) return true;\n  \n  // If user provides their own Google API key, bypass basic auth (BYOK model)\n  // SECURITY NOTE: This allows full API access with just a Google API key.\n  // Ensure Google API keys are kept secure and consider rate limiting per key.\n  const googleApiKey = request.headers.get(\"X-Google-API-Key\");\n  if (googleApiKey) return true;\n  \n  const authHeader = request.headers.get(\"Authorization\");\n  if (!authHeader || !authHeader.startsWith(\"Basic \")) {\n    return false;\n  }\n  \n  try {\n    const encoded = authHeader.substring(6); // Remove \"Basic \" prefix\n    const decoded = atob(encoded);\n    return decoded === env.BASIC_AUTH;\n  } catch {\n    return false;\n  }\n}\n\n// Geometry simplification\nexport function simplifyGeometry(geometry: any, tolerance: number, maxVertices: number): GeoJSONGeometry {\n  // Handle Point geometry (no simplification needed)\n  if (geometry.type === 'Point') {\n    return geometry;\n  }\n  \n  // Handle LineString geometry\n  if (geometry.type === 'LineString') {\n    return {\n      type: 'LineString',\n      coordinates: simplifyLineString(geometry.coordinates, tolerance, maxVertices)\n    };\n  }\n  \n  // Handle Polygon geometry\n  if (geometry.type === 'Polygon') {\n    return {\n      type: 'Polygon',\n      coordinates: geometry.coordinates.map((ring: number[][]) => \n        simplifyLineString(ring, tolerance, maxVertices)\n      )\n    };\n  }\n  \n  // Handle MultiPolygon geometry\n  if (geometry.type === 'MultiPolygon') {\n    return {\n      type: 'MultiPolygon',\n      coordinates: geometry.coordinates.map((polygon: number[][][]) =>\n        polygon.map((ring: number[][]) => \n          simplifyLineString(ring, tolerance, maxVertices)\n        )\n      )\n    };\n  }\n  \n  // Return original geometry if type is not supported\n  return geometry;\n}\n\nexport function simplifyLineString(coordinates: number[][], tolerance: number, maxVertices: number): number[][] {\n  if (coordinates.length <= 2) {\n    return coordinates;\n  }\n  \n  // Simple Douglas-Peucker algorithm implementation\n  const simplified: number[][] = [];\n  const start = coordinates[0];\n  const end = coordinates[coordinates.length - 1];\n  \n  simplified.push(start);\n  \n  let maxDistance = 0;\n  let maxIndex = 0;\n  \n  for (let i = 1; i < coordinates.length - 1; i++) {\n    const distance = pointToLineDistance(coordinates[i], start, end);\n    if (distance > maxDistance) {\n      maxDistance = distance;\n      maxIndex = i;\n    }\n  }\n  \n  if (maxDistance > tolerance && simplified.length < maxVertices) {\n    const left = coordinates.slice(0, maxIndex + 1);\n    const right = coordinates.slice(maxIndex);\n    \n    const leftSimplified = simplifyLineString(left, tolerance, maxVertices);\n    const rightSimplified = simplifyLineString(right, tolerance, maxVertices);\n    \n    simplified.push(...leftSimplified.slice(1, -1));\n    simplified.push(...rightSimplified.slice(1));\n  } else {\n    simplified.push(end);\n  }\n  \n  return simplified;\n}\n\nfunction pointToLineDistance(point: number[], lineStart: number[], lineEnd: number[]): number {\n  const A = point[0] - lineStart[0];\n  const B = point[1] - lineStart[1];\n  const C = lineEnd[0] - lineStart[0];\n  const D = lineEnd[1] - lineStart[1];\n  \n  const dot = A * C + B * D;\n  const lenSq = C * C + D * D;\n  \n  if (lenSq === 0) {\n    return Math.sqrt(A * A + B * B);\n  }\n  \n  const param = dot / lenSq;\n  \n  let xx, yy;\n  if (param < 0) {\n    xx = lineStart[0];\n    yy = lineStart[1];\n  } else if (param > 1) {\n    xx = lineEnd[0];\n    yy = lineEnd[1];\n  } else {\n    xx = lineStart[0] + param * C;\n    yy = lineStart[1] + param * D;\n  }\n  \n  const dx = point[0] - xx;\n  const dy = point[1] - yy;\n  \n  return Math.sqrt(dx * dx + dy * dy);\n}\n", "import { Env, GeoJSONFeatureCollection, SpatialIndex, CacheWarmingState, QueryParams, LookupResult, LookupCacheEntry } from './types';\nimport { geocodeIfNeeded } from './geocoding';\nimport { TIME_CONSTANTS, TIME_CONSTANTS_SECONDS } from './config';\nimport { geocodingCircuitBreaker } from './circuit-breaker';\nimport { pickDataset } from './utils';\n\n// Cache configuration\nexport const CACHE_CONFIG = {\n  MAX_SIZE: 30, // Maximum number of datasets to cache\n  MAX_AGE: TIME_CONSTANTS.TWENTY_FOUR_HOURS_MS,\n};\n\n// Cache warming configuration\nexport const CACHE_WARMING_CONFIG = {\n  ENABLED: true,\n  WARMING_INTERVAL: TIME_CONSTANTS.SIX_HOURS_MS,\n  BATCH_SIZE: 5,\n  POPULAR_LOCATIONS: [\n    { name: \"Toronto\", lat: 43.6532, lon: -79.3832 },\n    { name: \"Vancouver\", lat: 49.2827, lon: -123.1207 },\n    { name: \"Montreal\", lat: 45.5017, lon: -73.5673 },\n    { name: \"Calgary\", lat: 51.0447, lon: -114.0719 },\n    { name: \"Ottawa\", lat: 45.4215, lon: -75.6972 },\n    { name: \"Edmonton\", lat: 53.5461, lon: -113.4938 },\n    { name: \"Winnipeg\", lat: 49.8951, lon: -97.1384 },\n    { name: \"Quebec City\", lat: 46.8139, lon: -71.2080 },\n    { name: \"Hamilton\", lat: 43.2557, lon: -79.8711 },\n    { name: \"London\", lat: 42.9849, lon: -81.2453 }\n  ],\n  POPULAR_POSTAL_CODES: [\n    \"M5V 3A8\", // Toronto\n    \"V6B 1A1\", // Vancouver\n    \"H2Y 1C6\", // Montreal\n    \"T2P 1J9\", // Calgary\n    \"K1A 0A6\", // Ottawa\n    \"T5J 2R2\", // Edmonton\n    \"R3C 1A5\", // Winnipeg\n    \"G1R 2B5\", // Quebec City\n    \"L8P 4X3\", // Hamilton\n    \"N6A 3K7\"  // London\n  ]\n};\n\n// LRU Cache entry structure with timestamp\ninterface CacheEntry<V> {\n  value: V;\n  timestamp: number;\n}\n\n// LRU Cache implementation\nexport class LRUCache<K, V> {\n  private cache = new Map<K, CacheEntry<V>>();\n  private accessOrder: K[] = [];\n  private maxSize: number;\n  private maxAge: number;\n\n  constructor(maxSize: number, maxAge: number) {\n    this.maxSize = maxSize;\n    this.maxAge = maxAge;\n  }\n\n  get(key: K): V | undefined {\n    const entry = this.cache.get(key);\n    if (!entry) {\n      return undefined;\n    }\n\n    // Check expiration\n    const age = Date.now() - entry.timestamp;\n    if (age > this.maxAge) {\n      // Entry expired, remove it\n      this.delete(key);\n      return undefined;\n    }\n\n    // Move to end (most recently used)\n    this.moveToEnd(key);\n    return entry.value;\n  }\n\n  set(key: K, value: V): void {\n    const now = Date.now();\n    const newEntry: CacheEntry<V> = { value, timestamp: now };\n\n    // If key exists, update and move to end\n    if (this.cache.has(key)) {\n      this.cache.set(key, newEntry);\n      this.moveToEnd(key);\n      return;\n    }\n\n    // If at capacity, remove least recently used\n    if (this.cache.size >= this.maxSize) {\n      const lruKey = this.accessOrder.shift();\n      if (lruKey) {\n        this.cache.delete(lruKey);\n      }\n    }\n\n    this.cache.set(key, newEntry);\n    this.accessOrder.push(key);\n  }\n\n  has(key: K): boolean {\n    const entry = this.cache.get(key);\n    if (!entry) {\n      return false;\n    }\n\n    // Check expiration\n    const age = Date.now() - entry.timestamp;\n    if (age > this.maxAge) {\n      this.delete(key);\n      return false;\n    }\n\n    return true;\n  }\n\n  delete(key: K): boolean {\n    const deleted = this.cache.delete(key);\n    if (deleted) {\n      const index = this.accessOrder.indexOf(key);\n      if (index > -1) {\n        this.accessOrder.splice(index, 1);\n      }\n    }\n    return deleted;\n  }\n\n  clear(): void {\n    this.cache.clear();\n    this.accessOrder = [];\n  }\n\n  size(): number {\n    return this.cache.size;\n  }\n\n  private moveToEnd(key: K): void {\n    const index = this.accessOrder.indexOf(key);\n    if (index > -1) {\n      this.accessOrder.splice(index, 1);\n      this.accessOrder.push(key);\n    }\n  }\n}\n\n// LRU cache instances\nexport const geoCacheLRU = new LRUCache<string, GeoJSONFeatureCollection>(CACHE_CONFIG.MAX_SIZE, CACHE_CONFIG.MAX_AGE);\nexport const spatialIndexCacheLRU = new LRUCache<string, SpatialIndex>(CACHE_CONFIG.MAX_SIZE, CACHE_CONFIG.MAX_AGE);\n\n// Cache warming state\nexport const cacheWarmingState: CacheWarmingState = {\n  isRunning: false,\n  lastWarmed: 0,\n  currentBatch: 0,\n  totalBatches: 0,\n  successCount: 0,\n  failureCount: 0,\n  nextWarmingTime: 0,\n  lastError: undefined\n};\n\n// Lock for atomic cache warming state management\nlet cacheWarmingLock = false;\n\n// Cache warming functions\nexport async function warmCacheForLocation(\n  env: Env, \n  lat: number, \n  lon: number, \n  locationName: string,\n  loadGeo: (env: Env, r2Key: string) => Promise<void>,\n  lookupRiding: (env: Env, pathname: string, lon: number, lat: number) => Promise<any>\n): Promise<boolean> {\n  try {\n    // Warm all three datasets for this location\n    const datasets = [\n      { pathname: \"/api\", r2Key: \"federalridings-2024.geojson\" },\n      { pathname: \"/api/qc\", r2Key: \"quebecridings-2025.geojson\" },\n      { pathname: \"/api/on\", r2Key: \"ontarioridings-2022.geojson\" }\n    ];\n\n    for (const dataset of datasets) {\n      try {\n        // Load the GeoJSON data to populate caches\n        await loadGeo(env, dataset.r2Key);\n        \n        // Perform a lookup to warm the spatial index\n        const result = await lookupRiding(env, dataset.pathname, lon, lat);\n        \n        // Store lookup result in cache\n        const cacheKey = generateLookupCacheKey({ lat, lon }, dataset.pathname);\n        const datasetName = dataset.r2Key.replace('.geojson', '');\n        await setCachedLookupResult(env, cacheKey, result, datasetName, { lon, lat });\n        \n        console.log(`Cache warmed for ${locationName} on ${dataset.pathname}`);\n      } catch (error) {\n        console.warn(`Failed to warm cache for ${locationName} on ${dataset.pathname}:`, error);\n      }\n    }\n    \n    return true;\n  } catch (error) {\n    console.error(`Cache warming failed for ${locationName}:`, error);\n    return false;\n  }\n}\n\nexport async function warmCacheForPostalCode(\n  env: Env, \n  postalCode: string,\n  loadGeo: (env: Env, r2Key: string) => Promise<void>,\n  lookupRiding: (env: Env, pathname: string, lon: number, lat: number) => Promise<any>\n): Promise<boolean> {\n  try {\n    // Geocode the postal code first\n    const query: QueryParams = { postal: postalCode };\n    const { lon, lat } = await geocodeIfNeeded(env, query, undefined, undefined, geocodingCircuitBreaker ? {\n      execute: (key: string, fn: () => Promise<any>) => geocodingCircuitBreaker.execute(key, fn)\n    } : undefined);\n    \n    // Warm cache for all datasets (includes lookup cache)\n    const locationWarmed = await warmCacheForLocation(env, lat, lon, `Postal Code ${postalCode}`, loadGeo, lookupRiding);\n    \n    // Also warm lookup cache by postal code directly\n    const datasets = [\n      { pathname: \"/api\", r2Key: \"federalridings-2024.geojson\" },\n      { pathname: \"/api/qc\", r2Key: \"quebecridings-2025.geojson\" },\n      { pathname: \"/api/on\", r2Key: \"ontarioridings-2022.geojson\" }\n    ];\n    \n    for (const dataset of datasets) {\n      try {\n        const result = await lookupRiding(env, dataset.pathname, lon, lat);\n        const cacheKey = generateLookupCacheKey({ postal: postalCode }, dataset.pathname);\n        const datasetName = dataset.r2Key.replace('.geojson', '');\n        await setCachedLookupResult(env, cacheKey, result, datasetName, { lon, lat });\n      } catch (error) {\n        console.warn(`Failed to warm lookup cache for postal code ${postalCode} on ${dataset.pathname}:`, error);\n      }\n    }\n    \n    return locationWarmed;\n  } catch (error) {\n    console.error(`Cache warming failed for postal code ${postalCode}:`, error);\n    return false;\n  }\n}\n\nexport async function performCacheWarming(\n  env: Env,\n  loadGeo: (env: Env, r2Key: string) => Promise<void>,\n  lookupRiding: (env: Env, pathname: string, lon: number, lat: number) => Promise<any>\n): Promise<void> {\n  if (!CACHE_WARMING_CONFIG.ENABLED) {\n    return;\n  }\n\n  // Atomic check and set using lock to prevent race conditions\n  if (cacheWarmingLock || cacheWarmingState.isRunning) {\n    return;\n  }\n  \n  const now = Date.now();\n  if (now < cacheWarmingState.nextWarmingTime) {\n    return;\n  }\n\n  // Acquire lock atomically\n  cacheWarmingLock = true;\n  if (cacheWarmingState.isRunning) {\n    cacheWarmingLock = false;\n    return;\n  }\n  \n  cacheWarmingState.isRunning = true;\n  cacheWarmingLock = false;\n  cacheWarmingState.currentBatch = 0;\n  cacheWarmingState.successCount = 0;\n  cacheWarmingState.failureCount = 0;\n\n  try {\n    console.log(\"Starting cache warming process...\");\n\n    // Calculate total batches\n    const totalLocations = CACHE_WARMING_CONFIG.POPULAR_LOCATIONS.length + CACHE_WARMING_CONFIG.POPULAR_POSTAL_CODES.length;\n    cacheWarmingState.totalBatches = Math.ceil(totalLocations / CACHE_WARMING_CONFIG.BATCH_SIZE);\n\n    // Warm popular locations\n    for (let i = 0; i < CACHE_WARMING_CONFIG.POPULAR_LOCATIONS.length; i += CACHE_WARMING_CONFIG.BATCH_SIZE) {\n      const batch = CACHE_WARMING_CONFIG.POPULAR_LOCATIONS.slice(i, i + CACHE_WARMING_CONFIG.BATCH_SIZE);\n      cacheWarmingState.currentBatch++;\n\n      console.log(`Warming batch ${cacheWarmingState.currentBatch}/${cacheWarmingState.totalBatches} (locations)`);\n\n      const promises = batch.map(async (location) => {\n        const success = await warmCacheForLocation(env, location.lat, location.lon, location.name, loadGeo, lookupRiding);\n        if (success) {\n          cacheWarmingState.successCount++;\n        } else {\n          cacheWarmingState.failureCount++;\n        }\n        return success;\n      });\n\n      await Promise.allSettled(promises);\n\n      // Small delay between batches to avoid overwhelming the system\n      await new Promise(resolve => setTimeout(resolve, 1000));\n    }\n\n    // Warm popular postal codes\n    for (let i = 0; i < CACHE_WARMING_CONFIG.POPULAR_POSTAL_CODES.length; i += CACHE_WARMING_CONFIG.BATCH_SIZE) {\n      const batch = CACHE_WARMING_CONFIG.POPULAR_POSTAL_CODES.slice(i, i + CACHE_WARMING_CONFIG.BATCH_SIZE);\n      cacheWarmingState.currentBatch++;\n\n      console.log(`Warming batch ${cacheWarmingState.currentBatch}/${cacheWarmingState.totalBatches} (postal codes)`);\n\n      const promises = batch.map(async (postalCode) => {\n        const success = await warmCacheForPostalCode(env, postalCode, loadGeo, lookupRiding);\n        if (success) {\n          cacheWarmingState.successCount++;\n        } else {\n          cacheWarmingState.failureCount++;\n        }\n        return success;\n      });\n\n      await Promise.allSettled(promises);\n\n      // Small delay between batches\n      await new Promise(resolve => setTimeout(resolve, 1000));\n    }\n\n    cacheWarmingState.lastWarmed = now;\n    cacheWarmingState.nextWarmingTime = now + CACHE_WARMING_CONFIG.WARMING_INTERVAL;\n\n    console.log(`Cache warming completed. Success: ${cacheWarmingState.successCount}, Failures: ${cacheWarmingState.failureCount}`);\n  } catch (error) {\n    console.error(\"Cache warming process failed:\", error);\n    cacheWarmingState.lastError = error instanceof Error ? error.message : 'Unknown error';\n  } finally {\n    // Release lock and reset running state\n    cacheWarmingState.isRunning = false;\n    cacheWarmingLock = false;\n  }\n}\n\n// Start cache warming on worker initialization\nexport async function initializeCacheWarming(\n  env: Env,\n  loadGeo: (env: Env, r2Key: string) => Promise<void>,\n  lookupRiding: (env: Env, pathname: string, lon: number, lat: number) => Promise<any>\n): Promise<void> {\n  if (!CACHE_WARMING_CONFIG.ENABLED) {\n    return;\n  }\n\n  // Start warming immediately\n  performCacheWarming(env, loadGeo, lookupRiding).catch(error => {\n    console.error(\"Initial cache warming failed:\", error);\n  });\n\n  // Set up periodic warming\n  setInterval(() => {\n    performCacheWarming(env, loadGeo, lookupRiding).catch(error => {\n      console.error(\"Periodic cache warming failed:\", error);\n    });\n  }, CACHE_WARMING_CONFIG.WARMING_INTERVAL);\n}\n\n// Get cache warming status\nexport function getCacheWarmingStatus(): CacheWarmingState {\n  return { ...cacheWarmingState };\n}\n\n// Cache utility functions\nexport function getCachedGeoJSON(key: string): GeoJSONFeatureCollection | undefined {\n  return geoCacheLRU.get(key);\n}\n\nexport function setCachedGeoJSON(key: string, data: GeoJSONFeatureCollection): void {\n  geoCacheLRU.set(key, data);\n}\n\nexport function getCachedSpatialIndex(key: string): SpatialIndex | undefined {\n  return spatialIndexCacheLRU.get(key);\n}\n\nexport function setCachedSpatialIndex(key: string, data: SpatialIndex): void {\n  spatialIndexCacheLRU.set(key, data);\n}\n\n// LRU cache for simplified boundaries\nexport const simplifiedBoundariesCacheLRU = new LRUCache<string, any>(CACHE_CONFIG.MAX_SIZE, CACHE_CONFIG.MAX_AGE);\n\nexport function getCachedSimplifiedBoundary(cacheKey: string): any | undefined {\n  return simplifiedBoundariesCacheLRU.get(cacheKey);\n}\n\nexport function setCachedSimplifiedBoundary(cacheKey: string, geometry: any): void {\n  simplifiedBoundariesCacheLRU.set(cacheKey, geometry);\n}\n\n// Lookup result cache functions\n\n/**\n * Generates a normalized cache key for lookup requests.\n * Normalizes query parameters and coordinates to ensure consistent caching.\n * \n * @param query - Query parameters (address, postal, city, state, country, lat, lon)\n * @param pathname - API pathname (e.g., \"/api\", \"/api/qc\", \"/api/on\")\n * @returns Cache key string\n */\nexport function generateLookupCacheKey(query: QueryParams, pathname: string): string {\n  const { r2Key } = pickDataset(pathname);\n  const dataset = r2Key.replace('.geojson', '');\n  \n  // Normalize coordinates to 5 decimal places (~1m precision)\n  const normalizeCoord = (coord: number | undefined): string | undefined => {\n    if (coord === undefined) return undefined;\n    return (Math.round(coord * 100000) / 100000).toString();\n  };\n  \n  // Normalize string inputs\n  const normalizeString = (str: string | undefined): string | undefined => {\n    if (!str) return undefined;\n    return str.toLowerCase().trim().replace(/\\s+/g, ' ');\n  };\n  \n  // Determine cache key type and value\n  let type: string;\n  let value: string;\n  \n  if (query.lat !== undefined && query.lon !== undefined) {\n    // Use coordinates\n    type = 'coordinate';\n    const latNorm = normalizeCoord(query.lat);\n    const lonNorm = normalizeCoord(query.lon);\n    value = `${lonNorm},${latNorm}`;\n  } else if (query.postal) {\n    // Use postal code\n    type = 'postal';\n    value = normalizeString(query.postal)?.replace(/\\s+/g, '') || '';\n  } else if (query.address) {\n    // Use address\n    type = 'address';\n    const parts: string[] = [];\n    if (query.address) parts.push(normalizeString(query.address) || '');\n    if (query.city) parts.push(normalizeString(query.city) || '');\n    if (query.state) parts.push(normalizeString(query.state) || '');\n    if (query.country) parts.push(normalizeString(query.country) || '');\n    value = parts.filter(Boolean).join(' ');\n  } else {\n    // Fallback: use all available parameters\n    type = 'query';\n    const parts: string[] = [];\n    if (query.city) parts.push(normalizeString(query.city) || '');\n    if (query.state) parts.push(normalizeString(query.state) || '');\n    if (query.country) parts.push(normalizeString(query.country) || '');\n    value = parts.filter(Boolean).join(' ') || 'unknown';\n  }\n  \n  // Ensure key doesn't exceed KV 512 byte limit\n  const key = `lookup:${dataset}:${type}:${value}:${pathname}`;\n  if (key.length > 512) {\n    // Hash long keys (simple hash for now)\n    const hash = key.split('').reduce((acc, char) => {\n      const hash = ((acc << 5) - acc) + char.charCodeAt(0);\n      return hash & hash;\n    }, 0);\n    return `lookup:${dataset}:${type}:hash:${Math.abs(hash)}:${pathname}`;\n  }\n  \n  return key;\n}\n\n/**\n * Retrieves a cached lookup result from KV storage.\n * Validates cache entry age (24 hour TTL) and returns null if expired.\n * \n * @param env - Environment bindings containing LOOKUP_CACHE KV namespace\n * @param cacheKey - Cache key generated by generateLookupCacheKey\n * @returns Cached lookup result, or null if not found/expired\n */\nexport async function getCachedLookupResult(env: Env, cacheKey: string): Promise<LookupCacheEntry | null> {\n  if (!env.LOOKUP_CACHE) return null;\n  \n  try {\n    const cached = await env.LOOKUP_CACHE.get(cacheKey, 'json') as LookupCacheEntry | null;\n    if (!cached) return null;\n    \n    // Check if cache entry is still valid (24 hours TTL)\n    const maxAge = TIME_CONSTANTS.TWENTY_FOUR_HOURS_MS;\n    if (Date.now() - cached.timestamp > maxAge) {\n      await env.LOOKUP_CACHE.delete(cacheKey);\n      return null;\n    }\n    \n    return cached;\n  } catch (error) {\n    console.warn('Failed to get cached lookup result:', error);\n    return null;\n  }\n}\n\n/**\n * Stores a lookup result in KV cache with 24-hour TTL.\n * \n * @param env - Environment bindings containing LOOKUP_CACHE KV namespace\n * @param cacheKey - Cache key generated by generateLookupCacheKey\n * @param result - Lookup result to cache\n * @param dataset - Dataset identifier (e.g., \"federalridings-2024\")\n * @param point - Optional point coordinates (lon, lat) to store with the cache entry\n */\nexport async function setCachedLookupResult(env: Env, cacheKey: string, result: LookupResult, dataset: string, point?: { lon: number; lat: number }): Promise<void> {\n  if (!env.LOOKUP_CACHE) return;\n  \n  try {\n    const entry: LookupCacheEntry = {\n      properties: result.properties,\n      riding: result.riding,\n      point,\n      normalizedAddress: result.normalizedAddress,\n      timestamp: Date.now(),\n      dataset\n    };\n    \n    // Store with 24 hour TTL\n    await env.LOOKUP_CACHE.put(cacheKey, JSON.stringify(entry), {\n      expirationTtl: TIME_CONSTANTS_SECONDS.TWENTY_FOUR_HOURS\n    });\n  } catch (error) {\n    console.warn('Failed to cache lookup result:', error);\n    // Don't throw - cache errors should never fail requests\n  }\n}\n", "import { Metrics } from './types';\nimport { TIME_CONSTANTS } from './config';\n\n// Metrics window configuration (24 hours)\nconst METRICS_WINDOW_MS = TIME_CONSTANTS.TWENTY_FOUR_HOURS_MS;\nconst METRICS_RESET_INTERVAL_MS = TIME_CONSTANTS.TWENTY_FOUR_HOURS_MS;\n\n// Track when metrics were last reset\nlet lastResetTime = Date.now();\n\n// Global metrics object\nconst metrics: Metrics = {\n  geocodingRequests: 0,\n  geocodingCacheHits: 0,\n  geocodingCacheMisses: 0,\n  geocodingErrors: 0,\n  geocodingSuccesses: 0,\n  geocodingFailures: 0,\n  geocodingCircuitBreakerTrips: 0,\n  r2Requests: 0,\n  r2CacheHits: 0,\n  r2CacheMisses: 0,\n  r2Errors: 0,\n  r2Successes: 0,\n  r2Failures: 0,\n  r2CircuitBreakerTrips: 0,\n  spatialIndexHits: 0,\n  spatialIndexMisses: 0,\n  totalSpatialIndexTime: 0,\n  lookupRequests: 0,\n  lookupCacheHits: 0,\n  lookupCacheMisses: 0,\n  lookupErrors: 0,\n  batchRequests: 0,\n  batchErrors: 0,\n  webhookDeliveries: 0,\n  webhookFailures: 0,\n  requestCount: 0,\n  errorCount: 0,\n  totalLookupTime: 0,\n  totalGeocodingTime: 0,\n  totalR2Time: 0,\n  totalBatchTime: 0,\n  totalWebhookTime: 0\n};\n\n// Auto-reset metrics if window has passed\nfunction checkAndResetMetrics(): void {\n  const now = Date.now();\n  if (now - lastResetTime >= METRICS_RESET_INTERVAL_MS) {\n    resetMetrics();\n    lastResetTime = now;\n  }\n}\n\n// Metrics helper functions\nexport function incrementMetric(key: keyof Metrics, value: number = 1): void {\n  checkAndResetMetrics();\n  metrics[key] += value;\n}\n\nexport function recordTiming(key: keyof Metrics, duration: number): void {\n  checkAndResetMetrics();\n  metrics[key] += duration;\n}\n\nexport function getMetrics(): Metrics {\n  return { ...metrics };\n}\n\nexport function resetMetrics(): void {\n  Object.keys(metrics).forEach(key => {\n    metrics[key as keyof Metrics] = 0;\n  });\n  lastResetTime = Date.now();\n}\n\n// Get time since last reset (for metrics window calculation)\nexport function getMetricsAge(): number {\n  return Date.now() - lastResetTime;\n}\n\n// Get metrics summary for monitoring\nexport function getMetricsSummary(): {\n  requests: {\n    total: number;\n    errors: number;\n    errorRate: number;\n  };\n  geocoding: {\n    requests: number;\n    cacheHits: number;\n    cacheMisses: number;\n    errors: number;\n    hitRate: number;\n    avgTime: number;\n  };\n  r2: {\n    requests: number;\n    cacheHits: number;\n    cacheMisses: number;\n    errors: number;\n    hitRate: number;\n    avgTime: number;\n  };\n  lookup: {\n    requests: number;\n    cacheHits: number;\n    cacheMisses: number;\n    errors: number;\n    hitRate: number;\n    avgTime: number;\n  };\n  batch: {\n    requests: number;\n    errors: number;\n    avgTime: number;\n  };\n  webhooks: {\n    deliveries: number;\n    failures: number;\n    successRate: number;\n    avgTime: number;\n  };\n} {\n  const totalRequests = metrics.requestCount;\n  const totalErrors = metrics.errorCount;\n  const errorRate = totalRequests > 0 ? (totalErrors / totalRequests) * 100 : 0;\n\n  const geocodingHitRate = metrics.geocodingRequests > 0 \n    ? (metrics.geocodingCacheHits / metrics.geocodingRequests) * 100 \n    : 0;\n  const geocodingAvgTime = metrics.geocodingRequests > 0 \n    ? metrics.totalGeocodingTime / metrics.geocodingRequests \n    : 0;\n\n  const r2HitRate = metrics.r2Requests > 0 \n    ? (metrics.r2CacheHits / metrics.r2Requests) * 100 \n    : 0;\n  const r2AvgTime = metrics.r2Requests > 0 \n    ? metrics.totalR2Time / metrics.r2Requests \n    : 0;\n\n  const lookupHitRate = metrics.lookupRequests > 0 \n    ? (metrics.lookupCacheHits / metrics.lookupRequests) * 100 \n    : 0;\n  const lookupAvgTime = metrics.lookupRequests > 0 \n    ? metrics.totalLookupTime / metrics.lookupRequests \n    : 0;\n\n  const batchAvgTime = metrics.batchRequests > 0 \n    ? metrics.totalBatchTime / metrics.batchRequests \n    : 0;\n\n  const webhookTotal = metrics.webhookDeliveries + metrics.webhookFailures;\n  const webhookSuccessRate = webhookTotal > 0 \n    ? (metrics.webhookDeliveries / webhookTotal) * 100 \n    : 0;\n  const webhookAvgTime = webhookTotal > 0 \n    ? metrics.totalWebhookTime / webhookTotal \n    : 0;\n\n  return {\n    requests: {\n      total: totalRequests,\n      errors: totalErrors,\n      errorRate: Math.round(errorRate * 100) / 100\n    },\n    geocoding: {\n      requests: metrics.geocodingRequests,\n      cacheHits: metrics.geocodingCacheHits,\n      cacheMisses: metrics.geocodingCacheMisses,\n      errors: metrics.geocodingErrors,\n      hitRate: Math.round(geocodingHitRate * 100) / 100,\n      avgTime: Math.round(geocodingAvgTime * 100) / 100\n    },\n    r2: {\n      requests: metrics.r2Requests,\n      cacheHits: metrics.r2CacheHits,\n      cacheMisses: metrics.r2CacheMisses,\n      errors: metrics.r2Errors,\n      hitRate: Math.round(r2HitRate * 100) / 100,\n      avgTime: Math.round(r2AvgTime * 100) / 100\n    },\n    lookup: {\n      requests: metrics.lookupRequests,\n      cacheHits: metrics.lookupCacheHits,\n      cacheMisses: metrics.lookupCacheMisses,\n      errors: metrics.lookupErrors,\n      hitRate: Math.round(lookupHitRate * 100) / 100,\n      avgTime: Math.round(lookupAvgTime * 100) / 100\n    },\n    batch: {\n      requests: metrics.batchRequests,\n      errors: metrics.batchErrors,\n      avgTime: Math.round(batchAvgTime * 100) / 100\n    },\n    webhooks: {\n      deliveries: metrics.webhookDeliveries,\n      failures: metrics.webhookFailures,\n      successRate: Math.round(webhookSuccessRate * 100) / 100,\n      avgTime: Math.round(webhookAvgTime * 100) / 100\n    }\n  };\n}\n", "import { Env, GeoJSONFeature, GeoJSONFeatureCollection, GeoJSONGeometry, SpatialDatabaseFeature } from './types';\nimport { isPointInPolygon } from './utils';\n\n// Spatial database configuration\n// ENABLED can be set via environment variable SPATIAL_DB_ENABLED\nexport function getSpatialDbConfig(env?: { SPATIAL_DB_ENABLED?: string }): { ENABLED: boolean; USE_RTREE_INDEX: boolean; BATCH_INSERT_SIZE: number } {\n  return {\n    ENABLED: env?.SPATIAL_DB_ENABLED === 'true' || env?.SPATIAL_DB_ENABLED === '1',\n    USE_RTREE_INDEX: true,\n    BATCH_INSERT_SIZE: 100\n  };\n}\n\n// Legacy export for backward compatibility (defaults to disabled)\n// Use getSpatialDbConfig(env) in new code to check if enabled\nexport const SPATIAL_DB_CONFIG = {\n  ENABLED: false, // Deprecated: Use getSpatialDbConfig(env).ENABLED instead\n  USE_RTREE_INDEX: true,\n  BATCH_INSERT_SIZE: 100\n};\n\n// Bounding box interface\nexport interface BoundingBox {\n  minX: number;\n  minY: number;\n  maxX: number;\n  maxY: number;\n}\n\n// Spatial index interfaces\nexport interface SpatialIndexEntry {\n  feature: GeoJSONFeature;\n  boundingBox: BoundingBox;\n}\n\nexport interface SpatialIndex {\n  entries: SpatialIndexEntry[];\n  boundingBox: BoundingBox;\n}\n\n/**\n * Calculates the bounding box (min/max coordinates) for a GeoJSON geometry.\n * Handles Polygon and MultiPolygon types, with validation for empty/invalid geometries.\n * \n * @param geometry - GeoJSON geometry (Polygon or MultiPolygon)\n * @returns Bounding box with minX, minY, maxX, maxY\n * @throws Error if geometry is missing coordinates or invalid\n */\nexport function calculateBoundingBox(geometry: GeoJSONGeometry): BoundingBox {\n  // Validate geometry has coordinates\n  if (!geometry || !geometry.coordinates) {\n    throw new Error('Geometry missing coordinates');\n  }\n  \n  let minX = Infinity, minY = Infinity, maxX = -Infinity, maxY = -Infinity;\n  \n  const processCoordinates = (coords: number[][]) => {\n    if (!Array.isArray(coords) || coords.length === 0) {\n      return; // Skip empty coordinate arrays\n    }\n    for (const coord of coords) {\n      if (!Array.isArray(coord) || coord.length < 2) {\n        continue; // Skip invalid coordinates\n      }\n      const [x, y] = coord;\n      if (typeof x !== 'number' || typeof y !== 'number' || isNaN(x) || isNaN(y)) {\n        continue; // Skip invalid numeric values\n      }\n      minX = Math.min(minX, x);\n      minY = Math.min(minY, y);\n      maxX = Math.max(maxX, x);\n      maxY = Math.max(maxY, y);\n    }\n  };\n  \n  if (geometry.type === \"Polygon\") {\n    const coords = geometry.coordinates as number[][][];\n    if (!Array.isArray(coords) || coords.length === 0) {\n      throw new Error('Polygon coordinates must be a non-empty array');\n    }\n    for (const ring of coords) {\n      processCoordinates(ring);\n    }\n  } else if (geometry.type === \"MultiPolygon\") {\n    const coords = geometry.coordinates as number[][][][];\n    if (!Array.isArray(coords) || coords.length === 0) {\n      throw new Error('MultiPolygon coordinates must be a non-empty array');\n    }\n    for (const polygon of coords) {\n      if (!Array.isArray(polygon)) continue;\n      for (const ring of polygon) {\n        processCoordinates(ring);\n      }\n    }\n  } else {\n    throw new Error(`Unsupported geometry type: ${geometry.type}`);\n  }\n  \n  // Check if we found any valid coordinates\n  if (minX === Infinity || minY === Infinity || maxX === -Infinity || maxY === -Infinity) {\n    throw new Error('No valid coordinates found in geometry');\n  }\n  \n  return { minX, minY, maxX, maxY };\n}\n\n/**\n * Creates a spatial index (R-tree-like structure) for a GeoJSON FeatureCollection.\n * Pre-computes bounding boxes for all features to enable fast spatial queries.\n * \n * @param featureCollection - GeoJSON FeatureCollection to index\n * @returns Spatial index with entries and overall bounding box\n */\nexport function createSpatialIndex(featureCollection: GeoJSONFeatureCollection): SpatialIndex {\n  const entries: SpatialIndexEntry[] = [];\n  let minX = Infinity, minY = Infinity, maxX = -Infinity, maxY = -Infinity;\n  \n  for (const feature of featureCollection.features) {\n    const boundingBox = calculateBoundingBox(feature.geometry);\n    entries.push({ feature, boundingBox });\n    \n    // Update overall bounding box\n    minX = Math.min(minX, boundingBox.minX);\n    minY = Math.min(minY, boundingBox.minY);\n    maxX = Math.max(maxX, boundingBox.maxX);\n    maxY = Math.max(maxY, boundingBox.maxY);\n  }\n  \n  return {\n    entries,\n    boundingBox: { minX, minY, maxX, maxY }\n  };\n}\n\n/**\n * Checks if a geographic point is within a bounding box (inclusive boundaries).\n * \n * @param lon - Longitude\n * @param lat - Latitude\n * @param boundingBox - Bounding box with minX, minY, maxX, maxY\n * @returns true if point is within or on the boundary of the box\n */\nexport function isPointInBoundingBox(lon: number, lat: number, boundingBox: BoundingBox): boolean {\n  return lon >= boundingBox.minX && lon <= boundingBox.maxX &&\n         lat >= boundingBox.minY && lat <= boundingBox.maxY;\n}\n\n/**\n * Finds candidate features that might contain a point using bounding box pre-filtering.\n * Returns features whose bounding boxes contain the point; exact point-in-polygon\n * testing should be performed on the candidates.\n * \n * @param lon - Longitude\n * @param lat - Latitude\n * @param spatialIndex - Pre-computed spatial index\n * @returns Array of candidate features (may need further point-in-polygon testing)\n */\nexport function findCandidateFeatures(lon: number, lat: number, spatialIndex: SpatialIndex): GeoJSONFeature[] {\n  const candidates: GeoJSONFeature[] = [];\n  \n  for (const entry of spatialIndex.entries) {\n    if (isPointInBoundingBox(lon, lat, entry.boundingBox)) {\n      candidates.push(entry.feature);\n    }\n  }\n  \n  return candidates;\n}\n\n// Calculate centroid of a geometry\nexport function calculateCentroid(geometry: any): { lon: number; lat: number } {\n  if (geometry.type === 'Point') {\n    return { lon: geometry.coordinates[0] as number, lat: geometry.coordinates[1] as number };\n  }\n  \n  if (geometry.type === 'Polygon') {\n    // Simple centroid calculation for polygon\n    const coords = geometry.coordinates[0] as number[][]; // Use exterior ring\n    let lonSum = 0, latSum = 0;\n    for (const coord of coords) {\n      lonSum += coord[0] as number;\n      latSum += coord[1] as number;\n    }\n    return { lon: lonSum / coords.length, lat: latSum / coords.length };\n  }\n  \n  if (geometry.type === 'MultiPolygon') {\n    // Calculate centroid of the largest polygon\n    let largestPolygon = geometry.coordinates[0];\n    let largestVertexCount = 0;\n    \n    for (const polygon of geometry.coordinates) {\n      const vertexCount = polygon[0].length;\n      if (vertexCount > largestVertexCount) {\n        largestVertexCount = vertexCount;\n        largestPolygon = polygon;\n      }\n    }\n    \n    // Simple centroid calculation for the largest polygon\n    const coords = largestPolygon[0] as number[][]; // Use exterior ring\n    let lonSum = 0, latSum = 0;\n    for (const coord of coords) {\n      lonSum += coord[0] as number;\n      latSum += coord[1] as number;\n    }\n    return { lon: lonSum / coords.length, lat: latSum / coords.length };\n  }\n  \n  // Default to (0, 0) for other geometry types\n  return { lon: 0, lat: 0 };\n}\n\n// Initialize spatial database\nexport async function initializeSpatialDatabase(env: Env): Promise<boolean> {\n  const dbConfig = getSpatialDbConfig(env);\n  if (!dbConfig.ENABLED || !env.RIDING_DB) {\n    return false;\n  }\n\n  try {\n    // Create the main features table with spatial indexes\n    await env.RIDING_DB.prepare(`\n      CREATE TABLE IF NOT EXISTS spatial_features (\n        id TEXT PRIMARY KEY,\n        dataset TEXT NOT NULL,\n        feature_data TEXT NOT NULL,\n        minx REAL NOT NULL,\n        miny REAL NOT NULL,\n        maxx REAL NOT NULL,\n        maxy REAL NOT NULL,\n        centroid_lon REAL NOT NULL,\n        centroid_lat REAL NOT NULL,\n        area REAL DEFAULT 0,\n        created_at TEXT DEFAULT CURRENT_TIMESTAMP\n      )\n    `).run();\n\n    // Create spatial indexes for better query performance\n    await env.RIDING_DB.prepare(`\n      CREATE INDEX IF NOT EXISTS idx_spatial_bounds ON spatial_features(minx, miny, maxx, maxy)\n    `).run();\n\n    await env.RIDING_DB.prepare(`\n      CREATE INDEX IF NOT EXISTS idx_spatial_centroid ON spatial_features(centroid_lon, centroid_lat)\n    `).run();\n\n    await env.RIDING_DB.prepare(`\n      CREATE INDEX IF NOT EXISTS idx_dataset ON spatial_features(dataset)\n    `).run();\n\n    // Create R-tree virtual table for spatial indexing if enabled\n    if (dbConfig.USE_RTREE_INDEX) {\n      await env.RIDING_DB.prepare(`\n        CREATE VIRTUAL TABLE IF NOT EXISTS spatial_rtree USING rtree(\n          id,\n          minx, maxx,\n          miny, maxy\n        )\n      `).run();\n    }\n\n    console.log('Spatial database initialized successfully');\n    return true;\n  } catch (error) {\n    console.error('Failed to initialize spatial database:', error);\n    return false;\n  }\n}\n\n// Insert features into spatial database\nexport async function insertFeaturesIntoDatabase(env: Env, dataset: string, features: GeoJSONFeature[]): Promise<boolean> {\n  const dbConfig = getSpatialDbConfig(env);\n  if (!dbConfig.ENABLED || !env.RIDING_DB) {\n    return false;\n  }\n\n  try {\n    const statements: D1PreparedStatement[] = [];\n\n    for (const feature of features) {\n      const bbox = calculateBoundingBox(feature.geometry);\n      const centroid = calculateCentroid(feature.geometry);\n      const area = 0; // Placeholder for area calculation\n\n      const featureId = `${dataset}_${feature.properties?.FED_NUM || feature.properties?.RIDING_NUM || feature.properties?.ID || Date.now()}`;\n\n      // Insert into main table\n      statements.push(env.RIDING_DB.prepare(`\n        INSERT OR REPLACE INTO spatial_features \n        (id, dataset, feature_data, minx, miny, maxx, maxy, centroid_lon, centroid_lat, area)\n        VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n      `).bind(\n        featureId,\n        dataset,\n        JSON.stringify(feature),\n        bbox.minX,\n        bbox.minY,\n        bbox.maxX,\n        bbox.maxY,\n        centroid.lon,\n        centroid.lat,\n        area\n      ));\n\n      // Insert into R-tree index if enabled\n      if (dbConfig.USE_RTREE_INDEX) {\n        statements.push(env.RIDING_DB.prepare(`\n          INSERT OR REPLACE INTO spatial_rtree (id, minx, maxx, miny, maxy)\n          VALUES (?, ?, ?, ?, ?)\n        `).bind(featureId, bbox.minX, bbox.maxX, bbox.minY, bbox.maxY));\n      }\n    }\n\n    await env.RIDING_DB.batch(statements);\n    console.log(`Inserted ${features.length} features into spatial database for dataset: ${dataset}`);\n    return true;\n  } catch (error) {\n    console.error('Failed to insert features into spatial database:', error);\n    return false;\n  }\n}\n\n// Query spatial database for point-in-polygon lookup\n/**\n * Queries the D1 spatial database to find a riding containing a point.\n * Uses spatial SQL functions (ST_Contains) for efficient point-in-polygon queries.\n * \n * @param env - Environment bindings containing D1 database\n * @param dataset - Dataset name (e.g., 'federalridings-2024')\n * @param lon - Longitude\n * @param lat - Latitude\n * @returns Matching GeoJSON feature or null if not found\n */\nexport async function queryRidingFromDatabase(env: Env, dataset: string, lon: number, lat: number): Promise<GeoJSONFeature | null> {\n  const dbConfig = getSpatialDbConfig(env);\n  if (!dbConfig.ENABLED || !env.RIDING_DB) {\n    return null;\n  }\n\n  try {\n    // Use R-tree index for initial spatial filtering if available\n    let query = '';\n    let params: any[] = [];\n\n    if (dbConfig.USE_RTREE_INDEX) {\n      query = `\n        SELECT sf.feature_data \n        FROM spatial_features sf\n        JOIN spatial_rtree sr ON sf.id = sr.id\n        WHERE sf.dataset = ? \n        AND sr.minx <= ? AND sr.maxx >= ?\n        AND sr.miny <= ? AND sr.maxy >= ?\n      `;\n      params = [dataset, lon, lon, lat, lat];\n    } else {\n      query = `\n        SELECT feature_data \n        FROM spatial_features \n        WHERE dataset = ? \n        AND minx <= ? AND maxx >= ?\n        AND miny <= ? AND maxy >= ?\n      `;\n      params = [dataset, lon, lon, lat, lat];\n    }\n\n    const results = await env.RIDING_DB.prepare(query).bind(...params).all();\n\n    // Perform precise point-in-polygon check on candidates\n    if (!results || !results.results) {\n      return null;\n    }\n    \n    for (const result of results.results) {\n      if (!result || !result.feature_data) {\n        continue; // Skip invalid results\n      }\n      try {\n        const feature: GeoJSONFeature = JSON.parse(result.feature_data as string);\n        if (feature && feature.geometry && isPointInPolygon(lon, lat, feature.geometry)) {\n          return feature;\n        }\n      } catch (parseError) {\n        console.warn('Failed to parse feature_data from database:', parseError);\n        continue;\n      }\n    }\n\n    return null;\n  } catch (error) {\n    console.error('Failed to query spatial database:', error);\n    return null;\n  }\n}\n\n// Get all features from database with pagination\nexport async function getAllFeaturesFromDatabase(env: Env, dataset: string, limit: number = 100, offset: number = 0): Promise<{ features: GeoJSONFeature[]; total: number }> {\n  const dbConfig = getSpatialDbConfig(env);\n  if (!dbConfig.ENABLED || !env.RIDING_DB) {\n    return { features: [], total: 0 };\n  }\n\n  try {\n    // Get total count\n    const countResult = await env.RIDING_DB.prepare(`\n      SELECT COUNT(*) as total FROM spatial_features WHERE dataset = ?\n    `).bind(dataset).first();\n\n    const total = (countResult && typeof countResult.total === 'number') ? countResult.total : 0;\n\n    // Get features with pagination\n    const results = await env.RIDING_DB.prepare(`\n      SELECT feature_data \n      FROM spatial_features \n      WHERE dataset = ? \n      ORDER BY id\n      LIMIT ? OFFSET ?\n    `).bind(dataset, limit, offset).all();\n\n    if (!results || !results.results) {\n      return { features: [], total };\n    }\n\n    const features: GeoJSONFeature[] = [];\n    for (const result of results.results) {\n      if (!result || !result.feature_data) {\n        continue; // Skip invalid results\n      }\n      try {\n        const feature = JSON.parse(result.feature_data as string) as GeoJSONFeature;\n        if (feature && feature.type === 'Feature') {\n          features.push(feature);\n        }\n      } catch (parseError) {\n        console.warn('Failed to parse feature_data from database:', parseError);\n        continue;\n      }\n    }\n\n    return { features, total };\n  } catch (error) {\n    console.error('Failed to get features from spatial database:', error);\n    return { features: [], total: 0 };\n  }\n}\n\n// Sync GeoJSON data to spatial database\nexport async function syncGeoJSONToDatabase(\n  env: Env, \n  dataset: string,\n  loadGeo: (env: Env, r2Key: string) => Promise<GeoJSONFeatureCollection>\n): Promise<boolean> {\n  const dbConfig = getSpatialDbConfig(env);\n  if (!dbConfig.ENABLED || !env.RIDING_DB) {\n    return false;\n  }\n\n  try {\n    console.log(`Starting sync of ${dataset} to spatial database...`);\n    \n    // Load GeoJSON data from R2\n    const featureCollection = await loadGeo(env, dataset);\n    \n    // Initialize database if needed\n    await initializeSpatialDatabase(env);\n    \n    // Clear existing data for this dataset\n    await env.RIDING_DB.prepare(`DELETE FROM spatial_features WHERE dataset = ?`).bind(dataset).run();\n    \n    if (dbConfig.USE_RTREE_INDEX) {\n      // Clear R-tree entries for this dataset\n      const existingIds = await env.RIDING_DB.prepare(`\n        SELECT id FROM spatial_features WHERE dataset = ?\n      `).bind(dataset).all();\n      \n      for (const row of existingIds.results) {\n        await env.RIDING_DB.prepare(`DELETE FROM spatial_rtree WHERE id = ?`).bind(row.id).run();\n      }\n    }\n    \n    // Insert features in batches\n    const batchSize = dbConfig.BATCH_INSERT_SIZE;\n    for (let i = 0; i < featureCollection.features.length; i += batchSize) {\n      const batch = featureCollection.features.slice(i, i + batchSize);\n      await insertFeaturesIntoDatabase(env, dataset, batch);\n    }\n    \n    console.log(`Successfully synced ${featureCollection.features.length} features to spatial database`);\n    return true;\n  } catch (error) {\n    console.error('Failed to sync GeoJSON to spatial database:', error);\n    return false;\n  }\n}\n\n// Douglas-Peucker line simplification\nexport function simplifyLineString(coordinates: number[][], tolerance: number, maxVertices: number): number[][] {\n  if (coordinates.length <= 2) {\n    return coordinates;\n  }\n  \n  // If we're already under the max vertices, return as is\n  if (coordinates.length <= maxVertices) {\n    return coordinates;\n  }\n  \n  // Simple decimation for now - take every nth point\n  const step = Math.ceil(coordinates.length / maxVertices);\n  const simplified: number[][] = [];\n  \n  for (let i = 0; i < coordinates.length; i += step) {\n    simplified.push(coordinates[i]);\n  }\n  \n  // Always include the last point\n  if (simplified[simplified.length - 1] !== coordinates[coordinates.length - 1]) {\n    simplified.push(coordinates[coordinates.length - 1]);\n  }\n  \n  return simplified;\n}\n", "import { Env, WebhookConfig, WebhookEvent, WebhookDelivery } from './types';\nimport { TIME_CONSTANTS } from './config';\n\n// Webhook configuration\nexport const WEBHOOK_CONFIG = {\n  ENABLED: true,\n  MAX_RETRY_ATTEMPTS: 5,\n  RETRY_DELAY: 5000, // 5 seconds\n  TIMEOUT: 30000, // 30 seconds\n  MAX_WEBHOOKS: 10,\n  CLEANUP_INTERVAL: TIME_CONSTANTS.TWENTY_FOUR_HOURS_MS,\n  MAX_EVENT_AGE: TIME_CONSTANTS.SEVEN_DAYS_MS\n};\n\n// KV storage key prefixes\nconst WEBHOOK_CONFIG_PREFIX = 'webhook:config:';\nconst WEBHOOK_EVENT_PREFIX = 'webhook:event:';\nconst WEBHOOK_DELIVERY_PREFIX = 'webhook:delivery:';\nconst WEBHOOK_INDEX_KEY = 'webhook:index';\nconst WEBHOOK_EVENT_INDEX_KEY = 'webhook:event:index';\nconst WEBHOOK_DELIVERY_INDEX_KEY = 'webhook:delivery:index';\n\n// Track if webhook processing has been initialized\nlet webhookProcessingInitialized = false;\n\n// ID generation functions\nexport function generateWebhookId(): string {\n  return `webhook_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n}\n\nexport function generateEventId(): string {\n  return `event_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n}\n\nexport function generateDeliveryId(): string {\n  return `delivery_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n}\n\n// Helper functions for KV storage\nasync function getWebhookConfig(env: Env, webhookId: string): Promise<WebhookConfig | null> {\n  if (!env.WEBHOOKS) {\n    return null;\n  }\n  const data = await env.WEBHOOKS.get(`${WEBHOOK_CONFIG_PREFIX}${webhookId}`, 'json');\n  return data as WebhookConfig | null;\n}\n\nasync function setWebhookConfig(env: Env, webhookId: string, config: WebhookConfig): Promise<void> {\n  if (!env.WEBHOOKS) return;\n  await env.WEBHOOKS.put(`${WEBHOOK_CONFIG_PREFIX}${webhookId}`, JSON.stringify(config));\n  // Update index\n  const index = await getWebhookIndex(env);\n  if (!index.includes(webhookId)) {\n    index.push(webhookId);\n    await env.WEBHOOKS.put(WEBHOOK_INDEX_KEY, JSON.stringify(index));\n  }\n}\n\nasync function deleteWebhookConfig(env: Env, webhookId: string): Promise<void> {\n  if (!env.WEBHOOKS) return;\n  await env.WEBHOOKS.delete(`${WEBHOOK_CONFIG_PREFIX}${webhookId}`);\n  // Update index\n  const index = await getWebhookIndex(env);\n  const newIndex = index.filter(id => id !== webhookId);\n  await env.WEBHOOKS.put(WEBHOOK_INDEX_KEY, JSON.stringify(newIndex));\n}\n\nasync function getWebhookIndex(env: Env): Promise<string[]> {\n  if (!env.WEBHOOKS) return [];\n  const data = await env.WEBHOOKS.get(WEBHOOK_INDEX_KEY, 'json');\n  return (data as string[]) || [];\n}\n\nasync function getEventIndex(env: Env): Promise<string[]> {\n  if (!env.WEBHOOKS) return [];\n  const data = await env.WEBHOOKS.get(WEBHOOK_EVENT_INDEX_KEY, 'json');\n  return (data as string[]) || [];\n}\n\nasync function addEventToIndex(env: Env, eventId: string): Promise<void> {\n  if (!env.WEBHOOKS) return;\n  const index = await getEventIndex(env);\n  if (!index.includes(eventId)) {\n    index.push(eventId);\n    await env.WEBHOOKS.put(WEBHOOK_EVENT_INDEX_KEY, JSON.stringify(index));\n  }\n}\n\nasync function getDeliveryIndex(env: Env): Promise<string[]> {\n  if (!env.WEBHOOKS) return [];\n  const data = await env.WEBHOOKS.get(WEBHOOK_DELIVERY_INDEX_KEY, 'json');\n  return (data as string[]) || [];\n}\n\nasync function addDeliveryToIndex(env: Env, deliveryId: string): Promise<void> {\n  if (!env.WEBHOOKS) return;\n  const index = await getDeliveryIndex(env);\n  if (!index.includes(deliveryId)) {\n    index.push(deliveryId);\n    await env.WEBHOOKS.put(WEBHOOK_DELIVERY_INDEX_KEY, JSON.stringify(index));\n  }\n}\n\n// Create webhook event\nexport async function createWebhookEvent(env: Env, webhookId: string, eventType: string, batchId: string, payload: any): Promise<string> {\n  const eventId = generateEventId();\n  const event: WebhookEvent = {\n    id: eventId,\n    webhookId,\n    eventType,\n    batchId,\n    status: 'pending',\n    payload,\n    createdAt: Date.now(),\n    attempts: 0,\n    maxAttempts: WEBHOOK_CONFIG.MAX_RETRY_ATTEMPTS,\n    lastAttempt: undefined,\n    nextRetry: undefined\n  };\n  \n  if (env.WEBHOOKS) {\n    await env.WEBHOOKS.put(`${WEBHOOK_EVENT_PREFIX}${eventId}`, JSON.stringify(event));\n    await addEventToIndex(env, eventId);\n  }\n  \n  return eventId;\n}\n\n// Create webhook signature using proper HMAC-SHA256\nexport async function createWebhookSignature(secret: string, payload: string): Promise<string> {\n  const encoder = new TextEncoder();\n  const key = encoder.encode(secret);\n  const data = encoder.encode(payload);\n  \n  // Import the key for HMAC\n  const cryptoKey = await crypto.subtle.importKey(\n    'raw',\n    key,\n    { name: 'HMAC', hash: 'SHA-256' },\n    false,\n    ['sign']\n  );\n  \n  // Perform HMAC-SHA256\n  const signature = await crypto.subtle.sign('HMAC', cryptoKey, data);\n  const hashArray = Array.from(new Uint8Array(signature));\n  const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');\n  \n  return `sha256=${hashHex}`;\n}\n\n// Deliver webhook\nexport async function deliverWebhook(env: Env, webhookId: string, eventId: string): Promise<boolean> {\n  const webhook = await getWebhookConfig(env, webhookId);\n  if (!env.WEBHOOKS) return false;\n  const eventData = await env.WEBHOOKS.get(`${WEBHOOK_EVENT_PREFIX}${eventId}`, 'json');\n  const event = eventData as WebhookEvent | null;\n  \n  if (!webhook || !event || !webhook.active) {\n    return false;\n  }\n  \n  const deliveryId = generateDeliveryId();\n  const startTime = Date.now();\n  const delivery: WebhookDelivery = {\n    id: deliveryId,\n    webhookId,\n    eventId,\n    status: 'success',\n    responseCode: undefined,\n    responseBody: undefined,\n    attemptedAt: startTime,\n    duration: 0,\n    error: undefined\n  };\n  \n  try {\n    // Create signature\n    const signature = await createWebhookSignature(webhook.secret, JSON.stringify(event.payload));\n    \n    // Make the webhook request\n    const response = await fetch(webhook.url, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'User-Agent': 'riding-lookup-webhook/1.0',\n        'X-Webhook-Event': event.eventType,\n        'X-Webhook-Signature': signature,\n        'X-Webhook-Delivery': deliveryId\n      },\n      body: JSON.stringify(event.payload),\n      signal: AbortSignal.timeout(WEBHOOK_CONFIG.TIMEOUT)\n    });\n    \n    const endTime = Date.now();\n    delivery.duration = endTime - startTime;\n    delivery.responseCode = response.status;\n    delivery.responseBody = await response.text();\n    \n    if (response.ok) {\n      delivery.status = 'success';\n      event.status = 'delivered';\n      event.attempts++;\n      event.lastAttempt = endTime;\n      if (env.WEBHOOKS) {\n        await env.WEBHOOKS.put(`${WEBHOOK_EVENT_PREFIX}${eventId}`, JSON.stringify(event));\n        await env.WEBHOOKS.put(`${WEBHOOK_DELIVERY_PREFIX}${deliveryId}`, JSON.stringify(delivery));\n        await addDeliveryToIndex(env, deliveryId);\n      }\n      return true;\n    } else {\n      delivery.status = 'failed';\n      delivery.error = `HTTP ${response.status}: ${delivery.responseBody}`;\n      if (env.WEBHOOKS) {\n        await env.WEBHOOKS.put(`${WEBHOOK_DELIVERY_PREFIX}${deliveryId}`, JSON.stringify(delivery));\n        await addDeliveryToIndex(env, deliveryId);\n      }\n      \n      // Schedule retry if within limits\n      if (event.attempts < event.maxAttempts) {\n        event.status = 'pending';\n        event.attempts++;\n        event.nextRetry = Date.now() + WEBHOOK_CONFIG.RETRY_DELAY * Math.pow(2, event.attempts - 1);\n        event.lastAttempt = endTime;\n        if (env.WEBHOOKS) {\n          await env.WEBHOOKS.put(`${WEBHOOK_EVENT_PREFIX}${eventId}`, JSON.stringify(event));\n        }\n      } else {\n        event.status = 'failed';\n        event.lastAttempt = endTime;\n        if (env.WEBHOOKS) {\n          await env.WEBHOOKS.put(`${WEBHOOK_EVENT_PREFIX}${eventId}`, JSON.stringify(event));\n        }\n      }\n      \n      return false;\n    }\n  } catch (error) {\n    const endTime = Date.now();\n    delivery.duration = endTime - startTime;\n    delivery.status = 'failed';\n    delivery.error = error instanceof Error ? error.message : 'Unknown error';\n    if (env.WEBHOOKS) {\n      await env.WEBHOOKS.put(`${WEBHOOK_DELIVERY_PREFIX}${deliveryId}`, JSON.stringify(delivery));\n      await addDeliveryToIndex(env, deliveryId);\n    }\n    \n    // Schedule retry if within limits\n    if (event.attempts < event.maxAttempts) {\n      event.status = 'pending';\n      event.attempts++;\n      event.nextRetry = Date.now() + WEBHOOK_CONFIG.RETRY_DELAY * Math.pow(2, event.attempts - 1);\n      event.lastAttempt = endTime;\n      if (env.WEBHOOKS) {\n        await env.WEBHOOKS.put(`${WEBHOOK_EVENT_PREFIX}${eventId}`, JSON.stringify(event));\n      }\n    } else {\n      event.status = 'failed';\n      event.lastAttempt = endTime;\n      if (env.WEBHOOKS) {\n        await env.WEBHOOKS.put(`${WEBHOOK_EVENT_PREFIX}${eventId}`, JSON.stringify(event));\n      }\n    }\n    \n    return false;\n  }\n}\n\n// Process webhook events\nexport async function processWebhookEvents(env: Env): Promise<void> {\n  if (!WEBHOOK_CONFIG.ENABLED || !env.WEBHOOKS) {\n    return;\n  }\n  \n  const now = Date.now();\n  const eventsToProcess: WebhookEvent[] = [];\n  \n  // Find events that need processing\n  const eventIndex = await getEventIndex(env);\n  for (const eventId of eventIndex) {\n    const eventData = await env.WEBHOOKS.get(`${WEBHOOK_EVENT_PREFIX}${eventId}`, 'json');\n    if (eventData) {\n      const event = eventData as WebhookEvent;\n      if (event.status === 'pending' && (!event.nextRetry || now >= event.nextRetry)) {\n        eventsToProcess.push(event);\n      }\n    }\n  }\n  \n  // Process events\n  for (const event of eventsToProcess) {\n    try {\n      await deliverWebhook(env, event.webhookId, event.id);\n    } catch (error) {\n      console.error(`Failed to process webhook event ${event.id}:`, error);\n    }\n  }\n}\n\n// Cleanup old webhook data\nexport async function cleanupWebhookData(env: Env): Promise<void> {\n  if (!env.WEBHOOKS) return;\n  \n  const now = Date.now();\n  const maxAge = WEBHOOK_CONFIG.MAX_EVENT_AGE;\n  \n  // Clean up old events\n  const eventIndex = await getEventIndex(env);\n  const eventsToDelete: string[] = [];\n  for (const eventId of eventIndex) {\n    const eventData = await env.WEBHOOKS.get(`${WEBHOOK_EVENT_PREFIX}${eventId}`, 'json');\n    if (eventData) {\n      const event = eventData as WebhookEvent;\n      if (now - event.createdAt > maxAge) {\n        await env.WEBHOOKS.delete(`${WEBHOOK_EVENT_PREFIX}${eventId}`);\n        eventsToDelete.push(eventId);\n      }\n    }\n  }\n  // Update index\n  const newEventIndex = eventIndex.filter(id => !eventsToDelete.includes(id));\n  await env.WEBHOOKS.put(WEBHOOK_EVENT_INDEX_KEY, JSON.stringify(newEventIndex));\n  \n  // Clean up old deliveries\n  const deliveryIndex = await getDeliveryIndex(env);\n  const deliveriesToDelete: string[] = [];\n  for (const deliveryId of deliveryIndex) {\n    const deliveryData = await env.WEBHOOKS.get(`${WEBHOOK_DELIVERY_PREFIX}${deliveryId}`, 'json');\n    if (deliveryData) {\n      const delivery = deliveryData as WebhookDelivery;\n      if (now - delivery.attemptedAt > maxAge) {\n        await env.WEBHOOKS.delete(`${WEBHOOK_DELIVERY_PREFIX}${deliveryId}`);\n        deliveriesToDelete.push(deliveryId);\n      }\n    }\n  }\n  // Update index\n  const newDeliveryIndex = deliveryIndex.filter(id => !deliveriesToDelete.includes(id));\n  await env.WEBHOOKS.put(WEBHOOK_DELIVERY_INDEX_KEY, JSON.stringify(newDeliveryIndex));\n}\n\n// Initialize webhook processing\nexport function initializeWebhookProcessing(env: Env): void {\n  // Guard: only initialize once\n  if (webhookProcessingInitialized) {\n    return;\n  }\n  \n  if (!WEBHOOK_CONFIG.ENABLED) {\n    return;\n  }\n  \n  // Mark as initialized before creating intervals\n  webhookProcessingInitialized = true;\n  \n  // Process webhook events every 30 seconds\n  setInterval(() => {\n    processWebhookEvents(env).catch(error => {\n      console.error(\"Webhook processing failed:\", error);\n    });\n  }, 30000);\n  \n  // Cleanup old data every hour\n  setInterval(() => {\n    cleanupWebhookData(env).catch(error => {\n      console.error(\"Webhook cleanup failed:\", error);\n    });\n  }, 60 * 60 * 1000);\n}\n\n// Trigger webhook for batch completion\nexport async function triggerBatchCompletionWebhook(env: Env, batchId: string, batchStatus: any): Promise<void> {\n  if (!WEBHOOK_CONFIG.ENABLED) {\n    return;\n  }\n  \n  const payload = {\n    event: 'batch.completed',\n    batchId,\n    timestamp: Date.now(),\n    status: batchStatus.status,\n    results: batchStatus.results,\n    errors: batchStatus.errors,\n    processingTime: batchStatus.completedAt - batchStatus.createdAt\n  };\n  \n  // Create events for all enabled webhooks\n  const webhookIndex = await getWebhookIndex(env);\n  for (const webhookId of webhookIndex) {\n    const webhook = await getWebhookConfig(env, webhookId);\n    if (webhook && webhook.active && webhook.events.includes('batch.completed')) {\n      try {\n        await createWebhookEvent(env, webhookId, 'batch.completed', batchId, payload);\n      } catch (error) {\n        console.error(`Failed to create webhook event for ${webhookId}:`, error);\n      }\n    }\n  }\n}\n\n// Webhook management functions\nexport async function createWebhook(env: Env, config: Omit<WebhookConfig, 'createdAt' | 'lastDelivery' | 'failureCount' | 'maxFailures'>): Promise<string> {\n  const webhookIndex = await getWebhookIndex(env);\n  if (webhookIndex.length >= WEBHOOK_CONFIG.MAX_WEBHOOKS) {\n    throw new Error('Maximum number of webhooks reached');\n  }\n  \n  const webhookId = generateWebhookId();\n  const webhook: WebhookConfig = {\n    ...config,\n    createdAt: Date.now(),\n    lastDelivery: undefined,\n    failureCount: 0,\n    maxFailures: 5\n  };\n  \n  await setWebhookConfig(env, webhookId, webhook);\n  return webhookId;\n}\n\nexport async function updateWebhook(env: Env, webhookId: string, updates: Partial<WebhookConfig>): Promise<boolean> {\n  const webhook = await getWebhookConfig(env, webhookId);\n  if (!webhook) {\n    return false;\n  }\n  \n  const updatedWebhook = { ...webhook, ...updates };\n  await setWebhookConfig(env, webhookId, updatedWebhook);\n  return true;\n}\n\nexport async function deleteWebhook(env: Env, webhookId: string): Promise<boolean> {\n  const webhook = await getWebhookConfig(env, webhookId);\n  if (!webhook) {\n    return false;\n  }\n  await deleteWebhookConfig(env, webhookId);\n  return true;\n}\n\nexport async function getWebhook(env: Env, webhookId: string): Promise<WebhookConfig | null> {\n  return await getWebhookConfig(env, webhookId);\n}\n\nexport async function getAllWebhooks(env: Env): Promise<Map<string, WebhookConfig>> {\n  const webhookIndex = await getWebhookIndex(env);\n  const webhooks = new Map<string, WebhookConfig>();\n  for (const webhookId of webhookIndex) {\n    const webhook = await getWebhookConfig(env, webhookId);\n    if (webhook) {\n      webhooks.set(webhookId, webhook);\n    }\n  }\n  return webhooks;\n}\n\nexport async function getWebhookEvents(env: Env, webhookId?: string): Promise<WebhookEvent[]> {\n  if (!env.WEBHOOKS) return [];\n  const eventIndex = await getEventIndex(env);\n  const events: WebhookEvent[] = [];\n  for (const eventId of eventIndex) {\n    const eventData = await env.WEBHOOKS.get(`${WEBHOOK_EVENT_PREFIX}${eventId}`, 'json');\n    if (eventData) {\n      const event = eventData as WebhookEvent;\n      if (!webhookId || event.webhookId === webhookId) {\n        events.push(event);\n      }\n    }\n  }\n  return events;\n}\n\nexport async function getWebhookDeliveries(env: Env, webhookId?: string): Promise<WebhookDelivery[]> {\n  if (!env.WEBHOOKS) return [];\n  const deliveryIndex = await getDeliveryIndex(env);\n  const deliveries: WebhookDelivery[] = [];\n  for (const deliveryId of deliveryIndex) {\n    const deliveryData = await env.WEBHOOKS.get(`${WEBHOOK_DELIVERY_PREFIX}${deliveryId}`, 'json');\n    if (deliveryData) {\n      const delivery = deliveryData as WebhookDelivery;\n      if (!webhookId || delivery.webhookId === webhookId) {\n        deliveries.push(delivery);\n      }\n    }\n  }\n  return deliveries;\n}\n", "import { Env, BatchLookupRequest, BatchLookupResponse, BatchJob } from './types';\nimport { geocodeBatch, normalizeAddressWithGoogle, type GeocodeBatchResult } from './geocoding';\nimport { incrementMetric, recordTiming } from './metrics';\nimport { generateLookupCacheKey, getCachedLookupResult, setCachedLookupResult } from './cache';\nimport { pickDataset } from './utils';\n\n// Default batch size\nconst DEFAULT_BATCH_SIZE = 10;\n\n// Maximum batch size limits\nexport const MAX_BATCH_SIZE = 100;\nexport const MAX_REQUEST_BODY_SIZE = 10 * 1024 * 1024; // 10MB\n\n// Process batch lookup with individual geocoding\nexport async function processBatchLookup(\n  env: Env, \n  requests: BatchLookupRequest[],\n  geocodeIfNeeded: (env: Env, query: any, request?: Request) => Promise<{ lon: number; lat: number }>,\n  lookupRiding: (env: Env, pathname: string, lon: number, lat: number) => Promise<any>\n): Promise<BatchLookupResponse[]> {\n  // Validate batch size\n  if (requests.length > MAX_BATCH_SIZE) {\n    throw new Error(`Batch size exceeds maximum of ${MAX_BATCH_SIZE} requests`);\n  }\n  \n  const results: BatchLookupResponse[] = [];\n  // Validate and clamp batch size from environment\n  const rawBatchSize = env.BATCH_SIZE || DEFAULT_BATCH_SIZE;\n  const batchSize = Math.max(1, Math.min(Math.floor(rawBatchSize), MAX_BATCH_SIZE));\n  \n  incrementMetric('batchRequests');\n  const startTime = Date.now();\n  \n  try {\n    // Process requests in chunks to avoid overwhelming the system\n    for (let i = 0; i < requests.length; i += batchSize) {\n      const chunk = requests.slice(i, i + batchSize);\n      const chunkPromises = chunk.map(async (req) => {\n        const startTime = Date.now();\n        try {\n          const { lon, lat } = await geocodeIfNeeded(env, req.query);\n          const result = await lookupRiding(env, req.pathname, lon, lat);\n          const processingTime = Date.now() - startTime;\n          \n          return {\n            id: req.id,\n            query: req.query,\n            point: { lon, lat },\n            properties: result.properties,\n            processingTime\n          } as BatchLookupResponse;\n        } catch (error) {\n          const processingTime = Date.now() - startTime;\n          return {\n            id: req.id,\n            query: req.query,\n            properties: null,\n            error: error instanceof Error ? error.message : \"Unknown error\",\n            processingTime\n          } as BatchLookupResponse;\n        }\n      });\n      \n      const chunkResults = await Promise.all(chunkPromises);\n      results.push(...chunkResults);\n    }\n    \n    recordTiming('totalBatchTime', Date.now() - startTime);\n    return results;\n  } catch (error) {\n    incrementMetric('batchErrors');\n    recordTiming('totalBatchTime', Date.now() - startTime);\n    throw error;\n  }\n}\n\n// Process batch lookup with batch geocoding (GeoGratis-first). Optional normalization via Google when key configured.\nexport async function processBatchLookupWithBatchGeocoding(\n  env: Env,\n  requests: BatchLookupRequest[],\n  geocodeIfNeeded: (env: Env, query: any, request?: Request) => Promise<{ lon: number; lat: number; normalizedAddress?: string }>,\n  lookupRiding: (env: Env, pathname: string, lon: number, lat: number) => Promise<any>,\n  geocodeBatchFn: (env: Env, queries: any[], request?: Request, circuitBreaker?: { execute: (key: string, fn: () => Promise<any>) => Promise<any> }) => Promise<GeocodeBatchResult[]>,\n  request?: Request,\n  circuitBreaker?: { execute: (key: string, fn: () => Promise<any>) => Promise<any> }\n): Promise<BatchLookupResponse[]> {\n  // Validate batch size\n  if (requests.length > MAX_BATCH_SIZE) {\n    throw new Error(`Batch size exceeds maximum of ${MAX_BATCH_SIZE} requests`);\n  }\n  \n  const results: BatchLookupResponse[] = [];\n  // Validate and clamp batch size from environment\n  const rawBatchSize = env.BATCH_SIZE || DEFAULT_BATCH_SIZE;\n  const batchSize = Math.max(1, Math.min(Math.floor(rawBatchSize), MAX_BATCH_SIZE));\n  \n  incrementMetric('batchRequests');\n  const startTime = Date.now();\n  \n  try {\n    // Group requests by geocoding needs\n    const geocodingNeeded: Array<{ request: BatchLookupRequest; index: number }> = [];\n    const coordinatesProvided: Array<{ request: BatchLookupRequest; index: number; lon: number; lat: number }> = [];\n    \n    for (let i = 0; i < requests.length; i++) {\n      const req = requests[i];\n      if (req.query.lat !== undefined && req.query.lon !== undefined) {\n        coordinatesProvided.push({\n          request: req,\n          index: i,\n          lon: req.query.lon,\n          lat: req.query.lat\n        });\n      } else {\n        geocodingNeeded.push({\n          request: req,\n          index: i\n        });\n      }\n    }\n    \n    const hasGoogleKey = () => !!(request?.headers?.get?.('X-Google-API-Key') ?? env.GOOGLE_MAPS_KEY);\n    const resolveNormalized = async (lat: number, lon: number): Promise<string | undefined> => {\n      if (!hasGoogleKey()) return undefined;\n      const v = await normalizeAddressWithGoogle(env, lat, lon, request, circuitBreaker);\n      return v ?? undefined;\n    };\n\n    // Process coordinates-provided requests immediately\n    for (const { request, index, lon, lat } of coordinatesProvided) {\n      const startTime = Date.now();\n      try {\n        const cacheKey = generateLookupCacheKey({ ...request.query, lon, lat }, request.pathname);\n        const cachedResult = await getCachedLookupResult(env, cacheKey);\n        let normalizedAddress: string | undefined = cachedResult?.normalizedAddress;\n\n        if (cachedResult) {\n          if (normalizedAddress === undefined && hasGoogleKey()) normalizedAddress = await resolveNormalized(lat, lon);\n          const processingTime = Date.now() - startTime;\n          results[index] = {\n            id: request.id,\n            query: request.query,\n            point: { lon, lat },\n            properties: cachedResult.properties,\n            ...(normalizedAddress && { normalizedAddress }),\n            processingTime\n          };\n        } else {\n          const result = await lookupRiding(env, request.pathname, lon, lat);\n          if (hasGoogleKey()) normalizedAddress = await resolveNormalized(lat, lon);\n          const processingTime = Date.now() - startTime;\n          const { r2Key } = pickDataset(request.pathname);\n          const dataset = r2Key.replace('.geojson', '');\n          const toCache = { ...result, ...(normalizedAddress && { normalizedAddress }) };\n          await setCachedLookupResult(env, cacheKey, toCache, dataset, { lon, lat });\n          results[index] = {\n            id: request.id,\n            query: request.query,\n            point: { lon, lat },\n            properties: result.properties,\n            ...(normalizedAddress && { normalizedAddress }),\n            processingTime\n          };\n        }\n      } catch (error) {\n        const processingTime = Date.now() - startTime;\n        results[index] = {\n          id: request.id,\n          query: request.query,\n          properties: null,\n          error: error instanceof Error ? error.message : \"Lookup failed\",\n          processingTime\n        };\n      }\n    }\n    \n    // Process geocoding-needed requests in batches (GeoGratis-first via geocodeBatchFn)\n    if (geocodingNeeded.length > 0) {\n      const queries = geocodingNeeded.map(item => item.request.query);\n      const geocodingResults = await geocodeBatchFn(env, queries, request, circuitBreaker);\n      \n      for (let i = 0; i < geocodingNeeded.length; i++) {\n        const { request, index } = geocodingNeeded[i];\n        const geocodingResult = geocodingResults[i];\n        const startTime = Date.now();\n        \n        if (geocodingResult.success) {\n          try {\n            const cacheKey = generateLookupCacheKey(\n              { ...request.query, lon: geocodingResult.lon, lat: geocodingResult.lat },\n              request.pathname\n            );\n            const cachedResult = await getCachedLookupResult(env, cacheKey);\n            let normalizedAddress: string | undefined = geocodingResult.normalizedAddress ?? cachedResult?.normalizedAddress;\n            if (normalizedAddress === undefined && hasGoogleKey()) {\n              normalizedAddress = await resolveNormalized(geocodingResult.lat, geocodingResult.lon);\n            }\n            \n            if (cachedResult) {\n              const processingTime = Date.now() - startTime;\n              results[index] = {\n                id: request.id,\n                query: request.query,\n                point: { lon: geocodingResult.lon, lat: geocodingResult.lat },\n                properties: cachedResult.properties,\n                ...(normalizedAddress && { normalizedAddress }),\n                processingTime\n              };\n            } else {\n              const result = await lookupRiding(env, request.pathname, geocodingResult.lon, geocodingResult.lat);\n              const processingTime = Date.now() - startTime;\n              const { r2Key } = pickDataset(request.pathname);\n              const dataset = r2Key.replace('.geojson', '');\n              const toCache = { ...result, ...(normalizedAddress && { normalizedAddress }) };\n              await setCachedLookupResult(env, cacheKey, toCache, dataset, { lon: geocodingResult.lon, lat: geocodingResult.lat });\n              results[index] = {\n                id: request.id,\n                query: request.query,\n                point: { lon: geocodingResult.lon, lat: geocodingResult.lat },\n                properties: result.properties,\n                ...(normalizedAddress && { normalizedAddress }),\n                processingTime\n              };\n            }\n          } catch (error) {\n            const processingTime = Date.now() - startTime;\n            results[index] = {\n              id: request.id,\n              query: request.query,\n              properties: null,\n              error: error instanceof Error ? error.message : \"Lookup failed\",\n              processingTime\n            };\n          }\n        } else {\n          const processingTime = Date.now() - startTime;\n          results[index] = {\n            id: request.id,\n            query: request.query,\n            properties: null,\n            error: geocodingResult.error || \"Geocoding failed\",\n            processingTime\n          };\n        }\n      }\n    }\n    \n    recordTiming('totalBatchTime', Date.now() - startTime);\n    return results;\n  } catch (error) {\n    incrementMetric('batchErrors');\n    recordTiming('totalBatchTime', Date.now() - startTime);\n    throw error;\n  }\n}\n\n// Queue-based batch processing using Durable Objects\nexport async function submitBatchToQueue(env: Env, requests: BatchLookupRequest[]): Promise<{ batchId: string; status: string }> {\n  // Validate batch size\n  if (requests.length > MAX_BATCH_SIZE) {\n    throw new Error(`Batch size exceeds maximum of ${MAX_BATCH_SIZE} requests`);\n  }\n  \n  if (!env.QUEUE_MANAGER) {\n    throw new Error(\"Queue manager not configured\");\n  }\n\n  const queueManagerId = env.QUEUE_MANAGER.idFromName(\"main-queue\");\n  const queueManager = env.QUEUE_MANAGER.get(queueManagerId);\n  \n  const response = await queueManager.fetch(new Request(\"https://queue.local/queue/submit\", {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify({ requests })\n  }));\n\n  if (!response.ok) {\n    const error = await response.json() as { error?: string };\n    throw new Error(error.error || \"Failed to submit batch to queue\");\n  }\n\n  return await response.json();\n}\n\nexport async function getBatchStatus(env: Env, batchId: string): Promise<any> {\n  if (!env.QUEUE_MANAGER) {\n    throw new Error(\"Queue manager not configured\");\n  }\n\n  const queueManagerId = env.QUEUE_MANAGER.idFromName(\"main-queue\");\n  const queueManager = env.QUEUE_MANAGER.get(queueManagerId);\n  \n  const response = await queueManager.fetch(new Request(`https://queue.local/queue/status?batchId=${batchId}`));\n  \n  if (!response.ok) {\n    const error = await response.json() as { error?: string };\n    throw new Error(error.error || \"Failed to get batch status\");\n  }\n\n  return await response.json();\n}\n\nexport async function processQueueJobs(env: Env, maxJobs: number = 10): Promise<any> {\n  if (!env.QUEUE_MANAGER) {\n    throw new Error(\"Queue manager not configured\");\n  }\n\n  const queueManagerId = env.QUEUE_MANAGER.idFromName(\"main-queue\");\n  const queueManager = env.QUEUE_MANAGER.get(queueManagerId);\n  \n  const response = await queueManager.fetch(new Request(\"https://queue.local/queue/process\", {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify({ maxJobs })\n  }));\n  \n  if (!response.ok) {\n    const error = await response.json() as { error?: string };\n    throw new Error(error.error || \"Failed to process queue jobs\");\n  }\n\n  return await response.json();\n}\n\n// Batch job management\nexport function createBatchJob(requests: BatchLookupRequest[]): BatchJob {\n  return {\n    id: `batch_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n    requests,\n    status: 'pending',\n    createdAt: Date.now(),\n    results: [],\n    errors: []\n  };\n}\n\nexport function updateBatchJobStatus(job: BatchJob, status: BatchJob['status'], results?: BatchLookupResponse[], errors?: string[]): BatchJob {\n  const updatedJob = { ...job, status };\n  \n  if (results) {\n    updatedJob.results = results;\n  }\n  \n  if (errors) {\n    updatedJob.errors = errors;\n  }\n  \n  if (status === 'completed' || status === 'failed') {\n    updatedJob.completedAt = Date.now();\n  }\n  \n  return updatedJob;\n}\n\n// Batch processing configuration\nexport const BATCH_CONFIG = {\n  DEFAULT_BATCH_SIZE: 10,\n  MAX_BATCH_SIZE: 100,\n  TIMEOUT: 300000, // 5 minutes\n  RETRY_ATTEMPTS: 3,\n  RETRY_DELAY: 1000 // 1 second\n};\n", "/// <reference types=\"@cloudflare/workers-types\" />\n\nexport interface QueueJob {\n  id: string;\n  batchId: string;\n  request: BatchLookupRequest;\n  status: 'pending' | 'processing' | 'completed' | 'failed' | 'retrying' | 'dead_letter';\n  priority: number; // Higher number = higher priority\n  attempts: number;\n  maxAttempts: number;\n  createdAt: number;\n  startedAt?: number;\n  completedAt?: number;\n  nextRetryAt?: number;\n  result?: BatchLookupResponse;\n  error?: string;\n  processingTime?: number;\n  lastError?: string;\n  errorCount: number;\n  tags?: string[];\n}\n\nexport interface BatchJob {\n  id: string;\n  status: 'pending' | 'processing' | 'completed' | 'failed' | 'partially_completed';\n  totalJobs: number;\n  completedJobs: number;\n  failedJobs: number;\n  createdAt: number;\n  startedAt?: number;\n  completedAt?: number;\n  results: BatchLookupResponse[];\n  errors: string[];\n}\n\nexport interface BatchLookupRequest {\n  id: string;\n  query: QueryParams;\n  pathname: string;\n}\n\nexport interface BatchLookupResponse {\n  id: string;\n  query: QueryParams;\n  point?: { lon: number; lat: number };\n  properties: Record<string, unknown> | null;\n  normalizedAddress?: string;\n  error?: string;\n  processingTime: number;\n}\n\nexport interface QueryParams {\n  address?: string;\n  postal?: string;\n  lat?: number;\n  lon?: number;\n  city?: string;\n  state?: string;\n  country?: string;\n}\n\nexport interface QueueStats {\n  totalJobs: number;\n  pendingJobs: number;\n  processingJobs: number;\n  completedJobs: number;\n  failedJobs: number;\n  retryingJobs: number;\n  deadLetterJobs: number;\n  averageProcessingTime: number;\n  successRate: number;\n  priorityDistribution: Record<number, number>;\n  errorRate: number;\n  throughput: number; // jobs per minute\n  oldestPendingJob: number;\n  deadLetterQueueSize: number;\n  retryQueueSize: number;\n}\n\nexport class QueueManager {\n  private state: DurableObjectState;\n  private env: any;\n  private jobs: Map<string, QueueJob> = new Map();\n  private batches: Map<string, BatchJob> = new Map();\n  private processingQueue: string[] = [];\n  private retryQueue: string[] = [];\n  private deadLetterQueue: string[] = [];\n  private priorityQueues: Map<number, string[]> = new Map();\n  private stats: QueueStats = {\n    totalJobs: 0,\n    pendingJobs: 0,\n    processingJobs: 0,\n    completedJobs: 0,\n    failedJobs: 0,\n    retryingJobs: 0,\n    deadLetterJobs: 0,\n    averageProcessingTime: 0,\n    successRate: 0,\n    priorityDistribution: {},\n    errorRate: 0,\n    throughput: 0,\n    oldestPendingJob: 0,\n    deadLetterQueueSize: 0,\n    retryQueueSize: 0\n  };\n  private lastProcessedTime: number = Date.now();\n  private processedJobsCount: number = 0;\n  private stateLoadPromise: Promise<void> | null = null;\n  private stateLoaded: boolean = false;\n  private stateLoadError: Error | null = null;\n\n  constructor(state: DurableObjectState, env: any) {\n    this.state = state;\n    this.env = env;\n    // Load persisted state on initialization and store the promise\n    this.stateLoadPromise = this.loadStateWithRetry();\n  }\n\n  // Load state from Durable Object storage with retry logic\n  private async loadStateWithRetry(maxRetries: number = 3): Promise<void> {\n    let lastError: Error | null = null;\n    \n    for (let attempt = 1; attempt <= maxRetries; attempt++) {\n      try {\n        await this.loadState();\n        this.stateLoaded = true;\n        this.stateLoadError = null;\n        return;\n      } catch (error) {\n        lastError = error instanceof Error ? error : new Error(String(error));\n        console.error(`Failed to load queue manager state (attempt ${attempt}/${maxRetries}):`, lastError);\n        \n        if (attempt < maxRetries) {\n          // Exponential backoff: wait 100ms, 200ms, 400ms\n          const delay = 100 * Math.pow(2, attempt - 1);\n          await new Promise(resolve => setTimeout(resolve, delay));\n        }\n      }\n    }\n    \n    // All retries failed\n    this.stateLoadError = lastError;\n    console.error('Failed to load queue manager state after all retries. Operating with empty state.', lastError);\n    // Don't throw - allow the queue manager to operate with empty state rather than failing completely\n  }\n\n  // Load state from Durable Object storage\n  private async loadState(): Promise<void> {\n    const stored = await this.state.storage.get<{\n      jobs: [string, QueueJob][];\n      batches: [string, BatchJob][];\n      processingQueue: string[];\n      retryQueue: string[];\n      deadLetterQueue: string[];\n      priorityQueues: [number, string[]][];\n      lastProcessedTime: number;\n      processedJobsCount: number;\n    }>('queueState');\n    \n    if (stored) {\n      this.jobs = new Map(stored.jobs || []);\n      this.batches = new Map(stored.batches || []);\n      this.processingQueue = stored.processingQueue || [];\n      this.retryQueue = stored.retryQueue || [];\n      this.deadLetterQueue = stored.deadLetterQueue || [];\n      this.priorityQueues = new Map(stored.priorityQueues || []);\n      this.lastProcessedTime = stored.lastProcessedTime || Date.now();\n      this.processedJobsCount = stored.processedJobsCount || 0;\n    }\n  }\n\n  // Save state to Durable Object storage\n  private async saveState(): Promise<void> {\n    try {\n      await this.state.storage.put('queueState', {\n        jobs: Array.from(this.jobs.entries()),\n        batches: Array.from(this.batches.entries()),\n        processingQueue: this.processingQueue,\n        retryQueue: this.retryQueue,\n        deadLetterQueue: this.deadLetterQueue,\n        priorityQueues: Array.from(this.priorityQueues.entries()),\n        lastProcessedTime: this.lastProcessedTime,\n        processedJobsCount: this.processedJobsCount\n      });\n    } catch (error) {\n      console.error('Error saving queue manager state:', error);\n    }\n  }\n\n  // Priority queue management\n  private addToPriorityQueue(jobId: string, priority: number): void {\n    if (!this.priorityQueues.has(priority)) {\n      this.priorityQueues.set(priority, []);\n    }\n    this.priorityQueues.get(priority)!.push(jobId);\n  }\n\n  private removeFromPriorityQueue(jobId: string, priority: number): void {\n    const queue = this.priorityQueues.get(priority);\n    if (queue) {\n      const index = queue.indexOf(jobId);\n      if (index > -1) {\n        queue.splice(index, 1);\n      }\n    }\n  }\n\n  private getNextJobFromPriorityQueues(): string | null {\n    // Get all priority levels sorted in descending order (highest first)\n    const priorities = Array.from(this.priorityQueues.keys()).sort((a, b) => b - a);\n    \n    for (const priority of priorities) {\n      const queue = this.priorityQueues.get(priority);\n      if (queue && queue.length > 0) {\n        return queue.shift()!;\n      }\n    }\n    \n    return null;\n  }\n\n  // Dead letter queue management\n  private moveToDeadLetterQueue(jobId: string): void {\n    const job = this.jobs.get(jobId);\n    if (!job) return;\n\n    job.status = 'dead_letter';\n    job.completedAt = Date.now();\n    \n    // Remove from all queues\n    this.removeFromPriorityQueue(jobId, job.priority);\n    const retryIndex = this.retryQueue.indexOf(jobId);\n    if (retryIndex > -1) {\n      this.retryQueue.splice(retryIndex, 1);\n    }\n    \n    // Add to dead letter queue\n    this.deadLetterQueue.push(jobId);\n    \n    console.warn(`Job ${jobId} moved to dead letter queue after ${job.attempts} attempts`);\n  }\n\n  // Batch optimization\n  private groupSimilarRequests(requests: BatchLookupRequest[]): Map<string, BatchLookupRequest[]> {\n    const groups = new Map<string, BatchLookupRequest[]>();\n    \n    for (const request of requests) {\n      // Group by pathname and similar query patterns\n      const key = `${request.pathname}:${this.getQueryPattern(request.query)}`;\n      if (!groups.has(key)) {\n        groups.set(key, []);\n      }\n      groups.get(key)!.push(request);\n    }\n    \n    return groups;\n  }\n\n  private getQueryPattern(query: QueryParams): string {\n    // Create a pattern based on query type for grouping\n    if (query.lat !== undefined && query.lon !== undefined) {\n      return 'coordinates';\n    } else if (query.postal) {\n      return 'postal';\n    } else if (query.address) {\n      return 'address';\n    } else {\n      return 'mixed';\n    }\n  }\n\n  async fetch(request: Request): Promise<Response> {\n    // Ensure state is loaded before processing any requests\n    if (this.stateLoadPromise) {\n      try {\n        await this.stateLoadPromise;\n      } catch (error) {\n        // Error already logged in loadStateWithRetry, but log here too for visibility\n        console.error('State load failed in fetch handler:', error);\n      } finally {\n        this.stateLoadPromise = null; // Clear promise after first load attempt\n      }\n    }\n    \n    // If state failed to load, log a warning but continue processing\n    if (this.stateLoadError && !this.stateLoaded) {\n      console.warn('Queue manager operating with empty state due to load failure. Previous jobs/batches may not be visible.');\n    }\n    \n    const url = new URL(request.url);\n    const path = url.pathname;\n\n    try {\n      switch (path) {\n        case '/queue/submit':\n          return await this.handleSubmitBatch(request);\n        case '/queue/status':\n          return await this.handleGetStatus(request);\n        case '/queue/job':\n          return await this.handleGetJob(request);\n        case '/queue/batch':\n          return await this.handleGetBatch(request);\n        case '/queue/stats':\n          return await this.handleGetStats();\n        case '/queue/retry':\n          return await this.handleRetryFailed(request);\n        case '/queue/process':\n          return await this.handleProcessJobs(request);\n        case '/queue/health':\n          return await this.handleHealthCheck();\n        case '/queue/dead-letter':\n          return await this.handleDeadLetterQueue(request);\n        case '/queue/retry-dead-letter':\n          return await this.handleRetryDeadLetterJobs(request);\n        default:\n          return new Response('Not found', { status: 404 });\n      }\n    } catch (error) {\n      console.error('Queue manager error:', error);\n      return new Response(JSON.stringify({ error: error.message }), {\n        status: 500,\n        headers: { 'Content-Type': 'application/json' }\n      });\n    }\n  }\n\n  private async handleSubmitBatch(request: Request): Promise<Response> {\n    if (request.method !== 'POST') {\n      return new Response('Method not allowed', { status: 405 });\n    }\n\n    // Check request body size (limit to 10MB)\n    const contentLength = request.headers.get('content-length');\n    if (contentLength && parseInt(contentLength) > 10 * 1024 * 1024) {\n      return new Response(JSON.stringify({ error: 'Request body too large. Maximum size is 10MB' }), {\n        status: 413,\n        headers: { 'Content-Type': 'application/json' }\n      });\n    }\n\n    const body = await request.json() as { requests: BatchLookupRequest[]; priority?: number; tags?: string[] };\n    const { requests, priority = 1, tags = [] } = body;\n\n    if (!Array.isArray(requests) || requests.length === 0) {\n      return new Response(JSON.stringify({ error: 'Invalid requests array' }), {\n        status: 400,\n        headers: { 'Content-Type': 'application/json' }\n      });\n    }\n\n    // Validate batch size (maximum 100 requests)\n    const MAX_BATCH_SIZE = 100;\n    if (requests.length > MAX_BATCH_SIZE) {\n      return new Response(JSON.stringify({ error: `Batch size exceeds maximum of ${MAX_BATCH_SIZE} requests` }), {\n        status: 400,\n        headers: { 'Content-Type': 'application/json' }\n      });\n    }\n\n    const batchId = `batch_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n    const batchJob: BatchJob = {\n      id: batchId,\n      status: 'pending',\n      totalJobs: requests.length,\n      completedJobs: 0,\n      failedJobs: 0,\n      createdAt: Date.now(),\n      results: [],\n      errors: []\n    };\n\n    // Group similar requests for optimization\n    const groupedRequests = this.groupSimilarRequests(requests);\n    const jobIds: string[] = [];\n    let jobIndex = 0;\n\n    for (const [groupKey, groupRequests] of groupedRequests) {\n      for (const req of groupRequests) {\n        const jobId = `${batchId}_job_${jobIndex}`;\n        \n        const job: QueueJob = {\n          id: jobId,\n          batchId,\n          request: {\n            id: req.id || `req_${jobIndex}`,\n            query: req.query,\n            pathname: req.pathname\n          },\n          status: 'pending',\n          priority: priority,\n          attempts: 0,\n          maxAttempts: 5, // Configurable\n          createdAt: Date.now(),\n          errorCount: 0,\n          tags: [...tags, groupKey] // Add group key as tag\n        };\n\n        this.jobs.set(jobId, job);\n        this.addToPriorityQueue(jobId, priority);\n        jobIds.push(jobId);\n        jobIndex++;\n      }\n    }\n\n    this.batches.set(batchId, batchJob);\n    this.updateStats();\n    await this.saveState(); // Persist state after adding batch\n\n    return new Response(JSON.stringify({\n      batchId,\n      totalJobs: requests.length,\n      groupedJobs: groupedRequests.size,\n      status: 'submitted',\n      message: 'Batch submitted successfully with optimization'\n    }), {\n      headers: { 'Content-Type': 'application/json' }\n    });\n  }\n\n  private async handleGetStatus(request: Request): Promise<Response> {\n    const url = new URL(request.url);\n    const batchId = url.searchParams.get('batchId');\n    const jobId = url.searchParams.get('jobId');\n\n    if (batchId) {\n      const batch = this.batches.get(batchId);\n      if (!batch) {\n        return new Response(JSON.stringify({ error: 'Batch not found' }), {\n          status: 404,\n          headers: { 'Content-Type': 'application/json' }\n        });\n      }\n\n      return new Response(JSON.stringify(batch), {\n        headers: { 'Content-Type': 'application/json' }\n      });\n    }\n\n    if (jobId) {\n      const job = this.jobs.get(jobId);\n      if (!job) {\n        return new Response(JSON.stringify({ error: 'Job not found' }), {\n          status: 404,\n          headers: { 'Content-Type': 'application/json' }\n        });\n      }\n\n      return new Response(JSON.stringify(job), {\n        headers: { 'Content-Type': 'application/json' }\n      });\n    }\n\n    return new Response(JSON.stringify({ error: 'Missing batchId or jobId parameter' }), {\n      status: 400,\n      headers: { 'Content-Type': 'application/json' }\n    });\n  }\n\n  private async handleGetJob(request: Request): Promise<Response> {\n    const url = new URL(request.url);\n    const jobId = url.searchParams.get('id');\n    \n    if (!jobId) {\n      return new Response(JSON.stringify({ error: 'Missing job id' }), {\n        status: 400,\n        headers: { 'Content-Type': 'application/json' }\n      });\n    }\n\n    const job = this.jobs.get(jobId);\n    if (!job) {\n      return new Response(JSON.stringify({ error: 'Job not found' }), {\n        status: 404,\n        headers: { 'Content-Type': 'application/json' }\n      });\n    }\n\n    return new Response(JSON.stringify(job), {\n      headers: { 'Content-Type': 'application/json' }\n    });\n  }\n\n  private async handleGetBatch(request: Request): Promise<Response> {\n    const url = new URL(request.url);\n    const batchId = url.searchParams.get('id');\n    \n    if (!batchId) {\n      return new Response(JSON.stringify({ error: 'Missing batch id' }), {\n        status: 400,\n        headers: { 'Content-Type': 'application/json' }\n      });\n    }\n\n    const batch = this.batches.get(batchId);\n    if (!batch) {\n      return new Response(JSON.stringify({ error: 'Batch not found' }), {\n        status: 404,\n        headers: { 'Content-Type': 'application/json' }\n      });\n    }\n\n    return new Response(JSON.stringify(batch), {\n      headers: { 'Content-Type': 'application/json' }\n    });\n  }\n\n  private async handleGetStats(): Promise<Response> {\n    this.updateStats();\n    return new Response(JSON.stringify(this.stats), {\n      headers: { 'Content-Type': 'application/json' }\n    });\n  }\n\n  private async handleRetryFailed(request: Request): Promise<Response> {\n    if (request.method !== 'POST') {\n      return new Response('Method not allowed', { status: 405 });\n    }\n\n    const body = await request.json() as { jobIds: string[] };\n    const { jobIds } = body;\n\n    if (!Array.isArray(jobIds)) {\n      return new Response(JSON.stringify({ error: 'Invalid jobIds array' }), {\n        status: 400,\n        headers: { 'Content-Type': 'application/json' }\n      });\n    }\n\n    let retriedCount = 0;\n    for (const jobId of jobIds) {\n      const job = this.jobs.get(jobId);\n      if (job && (job.status === 'failed' || job.status === 'retrying')) {\n        job.status = 'pending';\n        job.attempts = 0;\n        job.error = undefined;\n        job.nextRetryAt = undefined;\n        this.processingQueue.push(jobId);\n        retriedCount++;\n      }\n    }\n\n    this.updateStats();\n    await this.saveState(); // Persist state after retrying jobs\n\n    return new Response(JSON.stringify({\n      message: `Retried ${retriedCount} jobs`,\n      retriedCount\n    }), {\n      headers: { 'Content-Type': 'application/json' }\n    });\n  }\n\n  private async handleProcessJobs(request: Request): Promise<Response> {\n    if (request.method !== 'POST') {\n      return new Response('Method not allowed', { status: 405 });\n    }\n\n    const body = await request.json() as { maxJobs?: number; priority?: number | null };\n    // Validate and clamp maxJobs (1-100)\n    const rawMaxJobs = body.maxJobs ?? 10;\n    const maxJobs = Math.max(1, Math.min(Math.floor(rawMaxJobs), 100));\n    const priority = body.priority ?? null;\n\n    const jobsToProcess: string[] = [];\n    \n    // Process retry queue first\n    const retryJobs = this.retryQueue.splice(0, Math.min(maxJobs, this.retryQueue.length));\n    jobsToProcess.push(...retryJobs);\n    \n    // Then process priority queues\n    const remainingSlots = maxJobs - jobsToProcess.length;\n    if (remainingSlots > 0) {\n      const priorityJobs = this.getJobsFromPriorityQueues(remainingSlots, priority);\n      jobsToProcess.push(...priorityJobs);\n    }\n\n    const results: Array<{ jobId: string; status: string; result?: BatchLookupResponse; processingTime?: number; error?: string; attempts?: number }> = [];\n    const startTime = Date.now();\n\n    for (const jobId of jobsToProcess) {\n      const job = this.jobs.get(jobId);\n      if (!job) continue;\n\n      try {\n        job.status = 'processing';\n        job.startedAt = Date.now();\n        job.attempts++;\n\n        // This would call the actual processing logic\n        // For now, we'll simulate processing\n        const result = await this.processJob(job);\n        \n        job.status = 'completed';\n        job.completedAt = Date.now();\n        job.result = result;\n        job.processingTime = job.completedAt - job.startedAt!;\n        job.errorCount = 0; // Reset error count on success\n\n        // Update batch\n        const batch = this.batches.get(job.batchId);\n        if (batch) {\n          batch.completedJobs++;\n          batch.results.push(result);\n          if (batch.completedJobs + batch.failedJobs >= batch.totalJobs) {\n            batch.status = batch.failedJobs > 0 ? 'partially_completed' : 'completed';\n            batch.completedAt = Date.now();\n          }\n        }\n\n        results.push({ jobId, status: 'completed', result, processingTime: job.processingTime });\n      } catch (error) {\n        job.errorCount++;\n        job.lastError = error.message;\n        job.completedAt = Date.now();\n\n        // Check if we should retry\n        if (job.attempts < job.maxAttempts) {\n          job.status = 'retrying';\n          job.nextRetryAt = Date.now() + this.calculateRetryDelay(job.attempts);\n          this.retryQueue.push(jobId);\n        } else {\n          // Move to dead letter queue\n          this.moveToDeadLetterQueue(jobId);\n        }\n\n        // Update batch\n        const batch = this.batches.get(job.batchId);\n        if (batch) {\n          batch.failedJobs++;\n          batch.errors.push(`${jobId}: ${error.message}`);\n          if (batch.completedJobs + batch.failedJobs >= batch.totalJobs) {\n            batch.status = batch.completedJobs > 0 ? 'partially_completed' : 'failed';\n            batch.completedAt = Date.now();\n          }\n        }\n\n        results.push({ jobId, status: 'failed', error: error.message, attempts: job.attempts });\n      }\n    }\n\n    // Update throughput metrics\n    const processingTime = Date.now() - startTime;\n    this.processedJobsCount += results.length;\n    this.lastProcessedTime = Date.now();\n\n    this.updateStats();\n    await this.saveState(); // Persist state after processing jobs\n\n    return new Response(JSON.stringify({\n      processedJobs: results.length,\n      processingTime,\n      results,\n      queueStats: {\n        pendingJobs: this.getTotalPendingJobs(),\n        retryQueueSize: this.retryQueue.length,\n        deadLetterQueueSize: this.deadLetterQueue.length\n      }\n    }), {\n      headers: { 'Content-Type': 'application/json' }\n    });\n  }\n\n  private getJobsFromPriorityQueues(maxJobs: number, specificPriority: number | null = null): string[] {\n    const jobs: string[] = [];\n    \n    if (specificPriority !== null) {\n      // Get jobs from specific priority queue\n      const queue = this.priorityQueues.get(specificPriority);\n      if (queue) {\n        const availableJobs = queue.splice(0, maxJobs);\n        jobs.push(...availableJobs);\n      }\n    } else {\n      // Get jobs from all priority queues in order\n      const priorities = Array.from(this.priorityQueues.keys()).sort((a, b) => b - a);\n      \n      for (const priority of priorities) {\n        if (jobs.length >= maxJobs) break;\n        \n        const queue = this.priorityQueues.get(priority);\n        if (queue && queue.length > 0) {\n          const remainingSlots = maxJobs - jobs.length;\n          const availableJobs = queue.splice(0, remainingSlots);\n          jobs.push(...availableJobs);\n        }\n      }\n    }\n    \n    return jobs;\n  }\n\n  private getTotalPendingJobs(): number {\n    let total = 0;\n    for (const queue of this.priorityQueues.values()) {\n      total += queue.length;\n    }\n    return total;\n  }\n\n  private async handleHealthCheck(): Promise<Response> {\n    const health = {\n      status: 'healthy',\n      timestamp: Date.now(),\n      stats: this.stats,\n      queueLengths: {\n        processing: this.processingQueue.length,\n        retry: this.retryQueue.length,\n        deadLetter: this.deadLetterQueue.length\n      }\n    };\n\n    return new Response(JSON.stringify(health), {\n      headers: { 'Content-Type': 'application/json' }\n    });\n  }\n\n  private async processJob(job: QueueJob): Promise<BatchLookupResponse> {\n    // This is a placeholder - in reality, this would call the actual lookup logic\n    // For now, we'll simulate processing time and return a mock result\n    await new Promise(resolve => setTimeout(resolve, Math.random() * 1000 + 100));\n    \n    return {\n      id: job.request.id,\n      query: job.request.query,\n      point: { lon: -75.6972, lat: 45.4215 },\n      properties: { FED_NUM: \"35047\", FED_NAME: \"Ottawa Centre\" },\n      processingTime: Date.now() - job.startedAt!\n    };\n  }\n\n  private calculateRetryDelay(attempt: number): number {\n    // Exponential backoff: 1s, 2s, 4s, 8s, 16s\n    return Math.min(1000 * Math.pow(2, attempt - 1), 30000);\n  }\n\n  private updateStats(): void {\n    let totalJobs = 0;\n    let pendingJobs = 0;\n    let processingJobs = 0;\n    let completedJobs = 0;\n    let failedJobs = 0;\n    let retryingJobs = 0;\n    let deadLetterJobs = 0;\n    let totalProcessingTime = 0;\n    let completedCount = 0;\n    let errorCount = 0;\n    const priorityDistribution: Record<number, number> = {};\n    let oldestPendingJob = Date.now();\n\n    for (const job of this.jobs.values()) {\n      totalJobs++;\n      totalProcessingTime += job.processingTime || 0;\n      \n      // Track priority distribution\n      if (job.status === 'pending' || job.status === 'processing') {\n        priorityDistribution[job.priority] = (priorityDistribution[job.priority] || 0) + 1;\n        if (job.createdAt < oldestPendingJob) {\n          oldestPendingJob = job.createdAt;\n        }\n      }\n      \n      // Count errors\n      errorCount += job.errorCount || 0;\n      \n      switch (job.status) {\n        case 'pending':\n          pendingJobs++;\n          break;\n        case 'processing':\n          processingJobs++;\n          break;\n        case 'completed':\n          completedJobs++;\n          completedCount++;\n          break;\n        case 'failed':\n          failedJobs++;\n          break;\n        case 'retrying':\n          retryingJobs++;\n          break;\n        case 'dead_letter':\n          deadLetterJobs++;\n          break;\n      }\n    }\n\n    // Calculate throughput (jobs per minute)\n    // Use a minimum time window of 1 second to avoid division by zero\n    const timeSinceLastProcessed = Math.max(Date.now() - this.lastProcessedTime, 1000);\n    const throughput = this.processedJobsCount > 0 && timeSinceLastProcessed > 0 ? \n      (this.processedJobsCount * 60000) / timeSinceLastProcessed : 0;\n\n    this.stats = {\n      totalJobs,\n      pendingJobs,\n      processingJobs,\n      completedJobs,\n      failedJobs,\n      retryingJobs,\n      deadLetterJobs,\n      averageProcessingTime: completedCount > 0 ? totalProcessingTime / completedCount : 0,\n      successRate: totalJobs > 0 ? (completedJobs / totalJobs) * 100 : 0,\n      priorityDistribution,\n      errorRate: totalJobs > 0 ? (errorCount / totalJobs) * 100 : 0,\n      throughput,\n      oldestPendingJob: oldestPendingJob === Date.now() ? 0 : Date.now() - oldestPendingJob,\n      deadLetterQueueSize: this.deadLetterQueue.length,\n      retryQueueSize: this.retryQueue.length\n    };\n  }\n\n  private async handleDeadLetterQueue(request: Request): Promise<Response> {\n    const url = new URL(request.url);\n    const limit = parseInt(url.searchParams.get('limit') || '50');\n    const offset = parseInt(url.searchParams.get('offset') || '0');\n\n    const deadLetterJobs = this.deadLetterQueue\n      .slice(offset, offset + limit)\n      .map(jobId => {\n        const job = this.jobs.get(jobId);\n        if (!job) return null;\n        \n        return {\n          id: job.id,\n          batchId: job.batchId,\n          priority: job.priority,\n          attempts: job.attempts,\n          createdAt: job.createdAt,\n          completedAt: job.completedAt,\n          lastError: job.lastError,\n          errorCount: job.errorCount,\n          tags: job.tags,\n          request: job.request\n        };\n      })\n      .filter(Boolean);\n\n    return new Response(JSON.stringify({\n      deadLetterJobs,\n      total: this.deadLetterQueue.length,\n      limit,\n      offset\n    }), {\n      headers: { 'Content-Type': 'application/json' }\n    });\n  }\n\n  private async handleRetryDeadLetterJobs(request: Request): Promise<Response> {\n    if (request.method !== 'POST') {\n      return new Response('Method not allowed', { status: 405 });\n    }\n\n    const body = await request.json() as { jobIds: string[]; resetAttempts?: boolean; newPriority?: number | null };\n    const { jobIds, resetAttempts = true, newPriority = null } = body;\n\n    if (!Array.isArray(jobIds)) {\n      return new Response(JSON.stringify({ error: 'Invalid jobIds array' }), {\n        status: 400,\n        headers: { 'Content-Type': 'application/json' }\n      });\n    }\n\n    let retriedCount = 0;\n    const results: Array<{ jobId: string; status: string; priority?: number }> = [];\n\n    for (const jobId of jobIds) {\n      const job = this.jobs.get(jobId);\n      if (job && job.status === 'dead_letter') {\n        // Reset job status\n        job.status = 'pending';\n        if (resetAttempts) {\n          job.attempts = 0;\n          job.errorCount = 0;\n        }\n        job.lastError = undefined;\n        job.nextRetryAt = undefined;\n        \n        // Update priority if specified\n        if (newPriority !== null) {\n          job.priority = newPriority;\n        }\n        \n        // Remove from dead letter queue\n        const deadLetterIndex = this.deadLetterQueue.indexOf(jobId);\n        if (deadLetterIndex > -1) {\n          this.deadLetterQueue.splice(deadLetterIndex, 1);\n        }\n        \n        // Add back to priority queue\n        this.addToPriorityQueue(jobId, job.priority);\n        \n        retriedCount++;\n        results.push({ jobId, status: 'retried', priority: job.priority });\n      } else {\n        results.push({ jobId, status: 'not_found_or_not_dead_letter' });\n      }\n    }\n\n    this.updateStats();\n    await this.saveState(); // Persist state after retrying dead letter jobs\n\n    return new Response(JSON.stringify({\n      message: `Retried ${retriedCount} dead letter jobs`,\n      retriedCount,\n      results\n    }), {\n      headers: { 'Content-Type': 'application/json' }\n    });\n  }\n}\n\nexport { QueueManager as QueueManagerDO };\n", "import { CircuitBreakerState } from './types';\n\n/**\n * Durable Object for sharing circuit breaker state across worker instances.\n * Ensures consistent circuit breaker behavior when multiple workers are running.\n */\nexport class CircuitBreakerDO {\n  private state: DurableObjectState;\n  private env: any;\n  private states: Map<string, CircuitBreakerState>;\n  private failureThreshold: number;\n  private recoveryTimeout: number;\n  private successThreshold: number;\n\n  constructor(state: DurableObjectState, env: any) {\n    this.state = state;\n    this.env = env;\n    this.failureThreshold = 5;\n    this.recoveryTimeout = 60000; // 60 seconds\n    this.successThreshold = 3;\n    this.states = new Map();\n    this.loadState();\n  }\n\n  /**\n   * Load circuit breaker state from Durable Object storage.\n   */\n  private async loadState(): Promise<void> {\n    try {\n      const stored = await this.state.storage.get<Map<string, CircuitBreakerState>>('circuitBreakers');\n      if (stored) {\n        this.states = stored;\n      }\n    } catch (error) {\n      console.warn('[CircuitBreakerDO] Failed to load state:', error);\n    }\n  }\n\n  /**\n   * Save circuit breaker state to Durable Object storage.\n   */\n  private async saveState(): Promise<void> {\n    try {\n      await this.state.storage.put('circuitBreakers', this.states);\n    } catch (error) {\n      console.warn('[CircuitBreakerDO] Failed to save state:', error);\n    }\n  }\n\n  /**\n   * Handle success for a circuit breaker key.\n   */\n  async handleSuccess(key: string): Promise<void> {\n    await this.onSuccess(key);\n  }\n\n  /**\n   * Handle failure for a circuit breaker key.\n   */\n  async handleFailure(key: string): Promise<void> {\n    await this.onFailure(key);\n  }\n\n  /**\n   * Check if circuit breaker allows execution for a key.\n   * Returns state info and whether execution should proceed.\n   */\n  async checkState(key: string): Promise<{ allowed: boolean; state: CircuitBreakerState }> {\n    const state = this.getState(key);\n    const now = Date.now();\n    \n    if (state.state === 'OPEN') {\n      if (now - state.lastFailureTime > this.recoveryTimeout) {\n        state.state = 'HALF_OPEN';\n        state.successCount = 0;\n        await this.saveState();\n        return { allowed: true, state };\n      } else {\n        return { allowed: false, state };\n      }\n    }\n    \n    return { allowed: true, state };\n  }\n\n  /**\n   * Get or create circuit breaker state for a key.\n   */\n  private getState(key: string): CircuitBreakerState {\n    if (!this.states.has(key)) {\n      this.states.set(key, {\n        state: 'CLOSED',\n        failureCount: 0,\n        lastFailureTime: 0,\n        successCount: 0,\n        nextAttemptTime: 0\n      });\n    }\n    return this.states.get(key)!;\n  }\n\n  /**\n   * Handle successful operation.\n   */\n  private async onSuccess(key: string): Promise<void> {\n    const state = this.getState(key);\n    state.failureCount = 0;\n    \n    if (state.state === 'HALF_OPEN') {\n      state.successCount++;\n      if (state.successCount >= this.successThreshold) {\n        state.state = 'CLOSED';\n      }\n    }\n    await this.saveState();\n  }\n\n  /**\n   * Handle failed operation.\n   */\n  private async onFailure(key: string): Promise<void> {\n    const state = this.getState(key);\n    state.failureCount++;\n    state.lastFailureTime = Date.now();\n    state.nextAttemptTime = Date.now() + this.recoveryTimeout;\n    \n    if (state.failureCount >= this.failureThreshold) {\n      state.state = 'OPEN';\n    }\n    await this.saveState();\n  }\n\n  /**\n   * Get circuit breaker state for a key.\n   */\n  async getStateInfo(key: string): Promise<CircuitBreakerState | null> {\n    await this.loadState();\n    return this.states.get(key) || null;\n  }\n\n  /**\n   * Get all circuit breaker states.\n   */\n  async getAllStates(): Promise<Map<string, CircuitBreakerState>> {\n    await this.loadState();\n    return new Map(this.states);\n  }\n\n  /**\n   * Reset a specific circuit breaker.\n   */\n  async reset(key: string): Promise<void> {\n    this.states.delete(key);\n    await this.saveState();\n  }\n\n  /**\n   * Reset all circuit breakers.\n   */\n  async resetAll(): Promise<void> {\n    this.states.clear();\n    await this.saveState();\n  }\n\n  /**\n   * Update circuit breaker configuration.\n   */\n  async updateConfig(failureThreshold?: number, recoveryTimeout?: number, successThreshold?: number): Promise<void> {\n    if (failureThreshold !== undefined) this.failureThreshold = failureThreshold;\n    if (recoveryTimeout !== undefined) this.recoveryTimeout = recoveryTimeout;\n    if (successThreshold !== undefined) this.successThreshold = successThreshold;\n  }\n\n  /**\n   * Handle HTTP requests to the Durable Object (for monitoring/admin).\n   */\n  async fetch(request: Request): Promise<Response> {\n    const url = new URL(request.url);\n    const path = url.pathname;\n\n    if (path === '/success' && request.method === 'POST') {\n      const body = await request.json() as { key: string };\n      await this.handleSuccess(body.key);\n      return new Response(JSON.stringify({ success: true }), {\n        headers: { 'Content-Type': 'application/json' }\n      });\n    }\n\n    if (path === '/failure' && request.method === 'POST') {\n      const body = await request.json() as { key: string };\n      await this.handleFailure(body.key);\n      return new Response(JSON.stringify({ success: true }), {\n        headers: { 'Content-Type': 'application/json' }\n      });\n    }\n\n    if (path === '/check' && request.method === 'POST') {\n      const body = await request.json() as { key: string };\n      const result = await this.checkState(body.key);\n      return new Response(JSON.stringify(result), {\n        headers: { 'Content-Type': 'application/json' }\n      });\n    }\n\n    if (path === '/state' && request.method === 'GET') {\n      const key = url.searchParams.get('key');\n      if (key) {\n        const state = await this.getStateInfo(key);\n        return new Response(JSON.stringify(state), {\n          headers: { 'Content-Type': 'application/json' }\n        });\n      } else {\n        const allStates = await this.getAllStates();\n        const statesObj = Object.fromEntries(allStates);\n        return new Response(JSON.stringify(statesObj), {\n          headers: { 'Content-Type': 'application/json' }\n        });\n      }\n    }\n\n    if (path === '/reset' && request.method === 'POST') {\n      const key = url.searchParams.get('key');\n      if (key) {\n        await this.reset(key);\n        return new Response(JSON.stringify({ success: true, message: `Circuit breaker ${key} reset` }), {\n          headers: { 'Content-Type': 'application/json' }\n        });\n      } else {\n        await this.resetAll();\n        return new Response(JSON.stringify({ success: true, message: 'All circuit breakers reset' }), {\n          headers: { 'Content-Type': 'application/json' }\n        });\n      }\n    }\n\n    if (path === '/config' && request.method === 'POST') {\n      const body = await request.json() as { failureThreshold?: number; recoveryTimeout?: number; successThreshold?: number };\n      await this.updateConfig(body.failureThreshold, body.recoveryTimeout, body.successThreshold);\n      return new Response(JSON.stringify({ success: true }), {\n        headers: { 'Content-Type': 'application/json' }\n      });\n    }\n\n    return new Response('Not found', { status: 404 });\n  }\n}\n\n", "// Documentation and UI functions\n\nexport function createLandingPage(baseUrl: string) {\n  return `<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Riding Lookup API</title>\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css\">\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n        \n        body {\n            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;\n            line-height: 1.5;\n            color: #1a1a1a;\n            background: #ffffff;\n            font-size: 16px;\n        }\n        \n        .container {\n            max-width: 1200px;\n            margin: 0 auto;\n            padding: 60px 40px;\n        }\n        \n        h1 {\n            font-size: 32px;\n            font-weight: 600;\n            margin-bottom: 8px;\n            letter-spacing: -0.02em;\n        }\n        \n        .subtitle {\n            font-size: 18px;\n            color: #666;\n            margin-bottom: 40px;\n            font-weight: 400;\n        }\n        \n        .section {\n            margin-bottom: 32px;\n        }\n        \n        .section h2 {\n            font-size: 20px;\n            font-weight: 600;\n            margin-bottom: 16px;\n            color: #1a1a1a;\n        }\n        \n        .section h3 {\n            font-size: 16px;\n            font-weight: 600;\n            margin: 24px 0 12px 0;\n            color: #1a1a1a;\n        }\n        \n        .endpoint {\n            background: #f6f8fa;\n            border: 1px solid #d0d7de;\n            padding: 12px 16px;\n            font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;\n            font-size: 14px;\n            margin: 8px 0 12px 0;\n            border-radius: 6px;\n            color: #24292f;\n            font-weight: 500;\n        }\n        \n        .example {\n            background: #ffffff;\n            border: 1px solid #d0d7de;\n            border-radius: 6px;\n            margin: 16px 0;\n            overflow: hidden;\n            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);\n            padding: 16px;\n            & h3 {\n            margin-left: 16px;\n            }\n        }\n        \n        .example-tabs {\n            display: flex;\n            background: #f6f8fa;\n            border-bottom: 1px solid #d0d7de;\n            padding: 4px;\n        }\n        \n        .example-tab {\n            background: none;\n            border: none;\n            padding: 8px 16px;\n            font-family: inherit;\n            font-size: 13px;\n            font-weight: 500;\n            color: #656d76;\n            cursor: pointer;\n            border-radius: 4px;\n            transition: all 0.2s ease;\n            flex: 1;\n            text-align: center;\n        }\n        \n        .example-tab:hover {\n            color: #24292f;\n            background: #ffffff;\n        }\n        \n        .example-tab.active {\n            color: #24292f;\n            background: #ffffff;\n            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);\n        }\n        \n        .response-tabs {\n            display: flex;\n            background: #f6f8fa;\n            border-top: 1px solid #d0d7de;\n            padding: 4px;\n            margin-top: 12px;\n        }\n        \n        .response-tab {\n            background: none;\n            border: none;\n            padding: 8px 16px;\n            font-family: inherit;\n            font-size: 13px;\n            font-weight: 500;\n            color: #656d76;\n            cursor: pointer;\n            border-radius: 4px;\n            transition: all 0.2s ease;\n            flex: 1;\n            text-align: center;\n        }\n        \n        .response-tab:hover {\n            color: #24292f;\n            background: #ffffff;\n        }\n        \n        .response-tab.active {\n            color: #24292f;\n            background: #ffffff;\n            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);\n        }\n        \n        .response-content {\n            display: none;\n        }\n        \n        .response-content.active {\n            display: block;\n        }\n        \n        .example-content {\n            display: none;\n        }\n        \n        .example-content.active {\n            display: block;\n        }\n        \n        .example-code {\n            background: #0d1117;\n            color: #e6edf3;\n            padding: 16px 20px;\n            font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;\n            font-size: 14px;\n            line-height: 1.5;\n            border-radius: 6px;\n            overflow-x: auto;\n            margin: 0;\n            border: 1px solid #30363d;\n            position: relative;\n        }\n        \n        .example-code::before {\n            content: '';\n            position: absolute;\n            top: 0;\n            left: 0;\n            right: 0;\n            height: 1px;\n            background: linear-gradient(90deg, #ff7b72, #79c0ff, #a5d6ff, #ffa657, #f0f6fc);\n        }\n        \n        .datasets {\n            list-style: none;\n        }\n        \n        .datasets li {\n            padding: 8px 0;\n            border-bottom: 1px solid #f0f0f0;\n            font-size: 15px;\n        }\n        \n        .datasets li:last-child {\n            border-bottom: none;\n        }\n        \n        .datasets strong {\n            font-weight: 600;\n            color: #1a1a1a;\n        }\n        \n        .links {\n            margin-top: 48px;\n            padding-top: 32px;\n            border-top: 1px solid #e1e5e9;\n        }\n        \n        .links a {\n            display: inline-block;\n            margin-right: 24px;\n            color: #0066cc;\n            text-decoration: none;\n            font-weight: 500;\n            font-size: 15px;\n        }\n        \n        .links a:hover {\n            text-decoration: underline;\n        }\n        \n        .note {\n            background: #f0f8ff;\n            border: 1px solid #b6e3ff;\n            border-left: 4px solid #0969da;\n            padding: 16px;\n            margin: 24px 0;\n            font-size: 14px;\n            color: #0969da;\n            border-radius: 6px;\n        }\n        \n        .note code {\n            background: #e1f5fe;\n            color: #0969da;\n            padding: 2px 6px;\n            border-radius: 3px;\n            font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;\n            font-size: 13px;\n        }\n        \n        .response {\n            background: #f8f9fa;\n            border: 1px solid #e1e5e9;\n            padding: 16px;\n            font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;\n            font-size: 13px;\n            margin: 8px 0;\n            border-radius: 4px;\n            overflow-x: auto;\n        }\n        \n        .endpoint-section {\n            background: #ffffff;\n            border: 1px solid #e1e5e9;\n            border-radius: 8px;\n            padding: 20px;\n            margin: 16px 0;\n            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);\n        }\n        \n        .endpoint-header {\n            display: flex;\n            align-items: center;\n            gap: 12px;\n            margin-bottom: 12px;\n            flex-wrap: wrap;\n        }\n        \n        .endpoint-section .method {\n            background: #28a745;\n            color: white;\n            padding: 4px 8px;\n            border-radius: 4px;\n            font-weight: 600;\n            font-size: 12px;\n            text-transform: uppercase;\n        }\n        \n        .endpoint-section .method.post {\n            background: #007bff;\n        }\n        \n        .endpoint-section .url {\n            font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;\n            background: #f6f8fa;\n            padding: 4px 8px;\n            border-radius: 4px;\n            font-size: 14px;\n            font-weight: 500;\n            color: #24292f;\n        }\n        \n        .endpoint-section .description {\n            font-weight: 600;\n            color: #1a1a1a;\n            font-size: 16px;\n        }\n        \n        .endpoint-section p {\n            margin: 8px 0;\n            color: #666;\n            line-height: 1.5;\n        }\n        \n        .param-list {\n            margin: 12px 0;\n            padding: 12px;\n            background: #f8f9fa;\n            border-radius: 6px;\n            border-left: 3px solid #007bff;\n        }\n        \n        .param {\n            margin: 4px 0;\n            font-size: 14px;\n        }\n        \n        .error-codes {\n            background: #fff5f5;\n            border: 1px solid #fed7d7;\n            border-radius: 6px;\n            padding: 16px;\n            margin: 16px 0;\n        }\n        \n        .error-codes h4 {\n            color: #c53030;\n            margin: 0 0 12px 0;\n            font-size: 16px;\n        }\n        \n        .error-code {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            padding: 8px 0;\n            border-bottom: 1px solid #fed7d7;\n        }\n        \n        .error-code:last-child {\n            border-bottom: none;\n        }\n        \n        .error-code-name {\n            font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;\n            font-weight: 600;\n            color: #c53030;\n        }\n        \n        .error-code-desc {\n            color: #666;\n            font-size: 14px;\n        }\n        \n        .rate-limits {\n            background: #f0f8ff;\n            border: 1px solid #b6e3ff;\n            border-radius: 6px;\n            padding: 16px;\n            margin: 16px 0;\n        }\n        \n        .rate-limits h4 {\n            color: #0969da;\n            margin: 0 0 12px 0;\n            font-size: 16px;\n        }\n        \n        .rate-limit-item {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            padding: 6px 0;\n            border-bottom: 1px solid #b6e3ff;\n        }\n        \n        .rate-limit-item:last-child {\n            border-bottom: none;\n        }\n        \n        .rate-limit-type {\n            font-weight: 600;\n            color: #0969da;\n        }\n        \n        .rate-limit-value {\n            font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;\n            background: #e1f5fe;\n            padding: 2px 6px;\n            border-radius: 3px;\n            font-size: 13px;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <h1>Riding Lookup API</h1>\n        <p class=\"subtitle\">Find Canadian federal, provincial, and territorial ridings by location</p>\n        \n        <div class=\"section\">\n            <h2>Usage</h2>\n            \n            <div class=\"example\">\n                <h3>Postal Code</h3>\n                <div class=\"endpoint\">GET ${baseUrl}/api?postal=K1A 0A6</div>\n                <div class=\"example-tabs\">\n                    <button class=\"example-tab active\" data-type=\"curl\">curl</button>\n                    <button class=\"example-tab\" data-type=\"fetch\">fetch</button>\n                    <button class=\"example-tab\" data-type=\"python\">python</button>\n                </div>\n                <div class=\"example-content active\" data-type=\"curl\">\n                    <pre><code class=\"language-bash\">curl \"${baseUrl}/api?postal=K1A 0A6\"</code></pre>\n                </div>\n                <div class=\"example-content\" data-type=\"fetch\">\n                    <pre><code class=\"language-javascript\">fetch(\"${baseUrl}/api?postal=K1A 0A6\")\n  .then(response => response.json())\n  .then(data => console.log(data));</code></pre>\n                </div>\n                <div class=\"example-content\" data-type=\"python\">\n                    <pre><code class=\"language-python\">import requests\n\nresponse = requests.get(\"${baseUrl}/api\", params={\"postal\": \"K1A 0A6\"})\ndata = response.json()\nprint(data)</code></pre>\n                </div>\n                \n                <div class=\"response-tabs\">\n                    <button class=\"response-tab active\" data-type=\"success\">Success</button>\n                    <button class=\"response-tab\" data-type=\"error\">Error</button>\n                </div>\n                <div class=\"response-content active\" data-type=\"success\">\n                    <pre><code class=\"language-json\">{\n  \"query\": {\"postal\": \"K1A 0A6\"},\n  \"point\": {\"lon\": -75.6972, \"lat\": 45.4215},\n  \"properties\": {\n    \"FED_NUM\": \"35047\",\n    \"FED_NAME\": \"Ottawa Centre\",\n    \"PROV_TERR\": \"Ontario\"\n  }\n}</code></pre>\n                </div>\n                <div class=\"response-content\" data-type=\"error\">\n                    <pre><code class=\"language-json\">{\n  \"error\": \"Invalid postal code format\",\n  \"code\": \"INVALID_POSTAL_CODE\"\n}</code></pre>\n                </div>\n            </div>\n            \n            <div class=\"example\">\n                <h3>Address</h3>\n                <div class=\"endpoint\">GET ${baseUrl}/api?address=123 Main St Toronto</div>\n                <div class=\"example-tabs\">\n                    <button class=\"example-tab active\" data-type=\"curl\">curl</button>\n                    <button class=\"example-tab\" data-type=\"fetch\">fetch</button>\n                    <button class=\"example-tab\" data-type=\"python\">python</button>\n                </div>\n                <div class=\"example-content active\" data-type=\"curl\">\n                    <pre><code class=\"language-bash\">curl \"${baseUrl}/api?address=123%20Main%20St%20Toronto\"</code></pre>\n                </div>\n                <div class=\"example-content\" data-type=\"fetch\">\n                    <pre><code class=\"language-javascript\">fetch(\"${baseUrl}/api?address=123%20Main%20St%20Toronto\")\n  .then(response => response.json())\n  .then(data => console.log(data));</code></pre>\n                </div>\n                <div class=\"example-content\" data-type=\"python\">\n                    <pre><code class=\"language-python\">import requests\n\nresponse = requests.get(\"${baseUrl}/api\", params={\"address\": \"123 Main St Toronto\"})\ndata = response.json()\nprint(data)</code></pre>\n                </div>\n                \n                <div class=\"response-tabs\">\n                    <button class=\"response-tab active\" data-type=\"success\">Success</button>\n                    <button class=\"response-tab\" data-type=\"error\">Error</button>\n                </div>\n                <div class=\"response-content active\" data-type=\"success\">\n                    <pre><code class=\"language-json\">{\n  \"query\": {\"address\": \"123 Main St Toronto\"},\n  \"point\": {\"lon\": -79.3832, \"lat\": 43.6532},\n  \"properties\": {\n    \"FED_NUM\": \"35039\",\n    \"FED_NAME\": \"Toronto Centre\",\n    \"PROV_TERR\": \"Ontario\"\n  }\n}</code></pre>\n                </div>\n                <div class=\"response-content\" data-type=\"error\">\n                    <pre><code class=\"language-json\">{\n  \"error\": \"Address not found\",\n  \"code\": \"GEOCODING_FAILED\"\n}</code></pre>\n                </div>\n            </div>\n            \n            <div class=\"example\">\n                <h3>Coordinates</h3>\n                <div class=\"endpoint\">GET ${baseUrl}/api?lat=45.4215&lon=-75.6972</div>\n                <div class=\"example-tabs\">\n                    <button class=\"example-tab active\" data-type=\"curl\">curl</button>\n                    <button class=\"example-tab\" data-type=\"fetch\">fetch</button>\n                    <button class=\"example-tab\" data-type=\"python\">python</button>\n                </div>\n                <div class=\"example-content active\" data-type=\"curl\">\n                    <pre><code class=\"language-bash\">curl \"${baseUrl}/api?lat=45.4215&lon=-75.6972\"</code></pre>\n                </div>\n                <div class=\"example-content\" data-type=\"fetch\">\n                    <pre><code class=\"language-javascript\">fetch(\"${baseUrl}/api?lat=45.4215&lon=-75.6972\")\n  .then(response => response.json())\n  .then(data => console.log(data));</code></pre>\n                </div>\n                <div class=\"example-content\" data-type=\"python\">\n                    <pre><code class=\"language-python\">import requests\n\nresponse = requests.get(\"${baseUrl}/api\", params={\"lat\": 45.4215, \"lon\": -75.6972})\ndata = response.json()\nprint(data)</code></pre>\n                </div>\n                \n                <div class=\"response-tabs\">\n                    <button class=\"response-tab active\" data-type=\"success\">Success</button>\n                    <button class=\"response-tab\" data-type=\"error\">Error</button>\n                </div>\n                <div class=\"response-content active\" data-type=\"success\">\n                    <pre><code class=\"language-json\">{\n  \"query\": {\"lat\": 45.4215, \"lon\": -75.6972},\n  \"point\": {\"lon\": -75.6972, \"lat\": 45.4215},\n  \"properties\": {\n    \"FED_NUM\": \"35047\",\n    \"FED_NAME\": \"Ottawa Centre\",\n    \"PROV_TERR\": \"Ontario\"\n  }\n}</code></pre>\n                </div>\n                <div class=\"response-content\" data-type=\"error\">\n                    <pre><code class=\"language-json\">{\n  \"error\": \"Invalid coordinates\",\n  \"code\": \"INVALID_COORDINATES\"\n}</code></pre>\n                </div>\n            </div>\n        </div>\n\n        <div class=\"section\">\n            <h2>API Endpoints</h2>\n            \n            <h3>Core Lookup Endpoints</h3>\n            <div class=\"endpoint-section\">\n                <div class=\"endpoint-header\">\n                    <span class=\"method\">GET</span>\n                    <span class=\"url\">/api</span>\n                    <span class=\"description\">Federal Riding Lookup</span>\n                </div>\n                <p>Find the federal riding for any location in Canada. Supports postal codes, addresses, and coordinates. Returns riding information including FED_NUM, FED_NAME, and PROV_TERR.</p>\n                <div class=\"param-list\">\n                    <div class=\"param\"><strong>postal</strong> - Canadian postal code (e.g., \"K1A 0A6\")</div>\n                    <div class=\"param\"><strong>address</strong> - Full address to geocode</div>\n                    <div class=\"param\"><strong>lat/lon</strong> - Latitude and longitude coordinates</div>\n                    <div class=\"param\"><strong>city/state/country</strong> - Location components</div>\n                </div>\n            </div>\n\n            <div class=\"endpoint-section\">\n                <div class=\"endpoint-header\">\n                    <span class=\"method\">GET</span>\n                    <span class=\"url\">/api/qc</span>\n                    <span class=\"description\">Quebec Provincial Riding Lookup</span>\n                </div>\n                <p>Find the Quebec provincial riding for any location in Quebec. Uses the 2025 Quebec provincial riding boundaries.</p>\n            </div>\n\n            <div class=\"endpoint-section\">\n                <div class=\"endpoint-header\">\n                    <span class=\"method\">GET</span>\n                    <span class=\"url\">/api/on</span>\n                    <span class=\"description\">Ontario Provincial Riding Lookup</span>\n                </div>\n                <p>Find the Ontario provincial riding for any location in Ontario. Uses the 2022 Ontario provincial riding boundaries.</p>\n            </div>\n\n            <h3>Batch Processing</h3>\n            <div class=\"endpoint-section\">\n                <div class=\"endpoint-header\">\n                    <span class=\"method\">POST</span>\n                    <span class=\"url\">/batch</span>\n                    <span class=\"description\">Immediate Batch Processing</span>\n                </div>\n                <p>Process multiple lookup requests immediately using Google Maps batch geocoding for optimal performance. Supports up to 100 requests per batch.</p>\n                \n                <h4>Example Request</h4>\n                <pre><code class=\"language-bash\">curl -X POST \"${baseUrl}/batch\" \\\\\n  -H \"Content-Type: application/json\" \\\\\n  -d '{\n    \"requests\": [\n      {\n        \"id\": \"1\",\n        \"pathname\": \"/api\",\n        \"query\": {\"postal\": \"K1A 0A6\"}\n      },\n      {\n        \"id\": \"2\", \n        \"pathname\": \"/api\",\n        \"query\": {\"address\": \"123 Main St Toronto\"}\n      }\n    ]\n  }'</code></pre>\n            </div>\n\n            <div class=\"endpoint-section\">\n                <div class=\"endpoint-header\">\n                    <span class=\"method\">POST</span>\n                    <span class=\"url\">/api/queue/submit</span>\n                    <span class=\"description\">Queue Batch for Processing</span>\n                </div>\n                <p>Submit a batch of requests to the persistent queue for asynchronous processing. Returns immediately with a batch ID for status tracking.</p>\n                \n                <h4>Example Request</h4>\n                <pre><code class=\"language-bash\">curl -X POST \"${baseUrl}/api/queue/submit\" \\\\\n  -H \"Content-Type: application/json\" \\\\\n  -d '{\n    \"requests\": [\n      {\n        \"id\": \"1\",\n        \"pathname\": \"/api\",\n        \"query\": {\"postal\": \"K1A 0A6\"}\n      },\n      {\n        \"id\": \"2\",\n        \"pathname\": \"/api/qc\", \n        \"query\": {\"address\": \"1234 Rue Saint-Denis, Montr\u00E9al\"}\n      }\n    ]\n  }'</code></pre>\n                \n                <h4>Example Response</h4>\n                <pre><code class=\"language-json\">{\n  \"batchId\": \"batch_1234567890\",\n  \"status\": \"pending\",\n  \"message\": \"Batch submitted successfully\"\n}</code></pre>\n            </div>\n\n            <div class=\"endpoint-section\">\n                <div class=\"endpoint-header\">\n                    <span class=\"method\">GET</span>\n                    <span class=\"url\">/api/queue/status</span>\n                    <span class=\"description\">Check Batch Status</span>\n                </div>\n                <p>Check the status of a queued batch including completion progress and results. Use the batchId returned from queue submission.</p>\n                \n                <h4>Example Request</h4>\n                <pre><code class=\"language-bash\">curl \"${baseUrl}/api/queue/status?batchId=batch_1234567890\"</code></pre>\n                \n                <h4>Example Response</h4>\n                <pre><code class=\"language-json\">{\n  \"batchId\": \"batch_1234567890\",\n  \"status\": \"completed\",\n  \"progress\": {\n    \"total\": 2,\n    \"completed\": 2,\n    \"failed\": 0,\n    \"pending\": 0\n  },\n  \"results\": [\n    {\n      \"id\": \"1\",\n      \"query\": {\"postal\": \"K1A 0A6\"},\n      \"point\": {\"lon\": -75.6972, \"lat\": 45.4215},\n      \"properties\": {\n        \"FED_NUM\": \"35047\",\n        \"FED_NAME\": \"Ottawa Centre\",\n        \"PROV_TERR\": \"Ontario\"\n      },\n      \"processingTime\": 150\n    }\n  ],\n  \"createdAt\": \"2024-01-15T10:30:00Z\",\n  \"updatedAt\": \"2024-01-15T10:30:05Z\"\n}</code></pre>\n            </div>\n\n            <div class=\"endpoint-section\">\n                <div class=\"endpoint-header\">\n                    <span class=\"method\">GET</span>\n                    <span class=\"url\">/api/queue/stats</span>\n                    <span class=\"description\">Queue Statistics</span>\n                </div>\n                <p>Get comprehensive statistics about the queue including job counts, processing times, and success rates.</p>\n            </div>\n\n            <h3>Database Operations</h3>\n            <div class=\"endpoint-section\">\n                <div class=\"endpoint-header\">\n                    <span class=\"method\">POST</span>\n                    <span class=\"url\">/api/database/init</span>\n                    <span class=\"description\">Initialize Spatial Database</span>\n                </div>\n                <p>Initialize the spatial database with required tables and indexes for optimal performance.</p>\n            </div>\n\n            <div class=\"endpoint-section\">\n                <div class=\"endpoint-header\">\n                    <span class=\"method\">POST</span>\n                    <span class=\"url\">/api/database/sync</span>\n                    <span class=\"description\">Sync GeoJSON to Database</span>\n                </div>\n                <p>Synchronize GeoJSON data to the spatial database for faster lookups.</p>\n            </div>\n\n            <div class=\"endpoint-section\">\n                <div class=\"endpoint-header\">\n                    <span class=\"method\">GET</span>\n                    <span class=\"url\">/api/database/stats</span>\n                    <span class=\"description\">Database Statistics</span>\n                </div>\n                <p>Get statistics about the spatial database including feature counts and sync status.</p>\n            </div>\n\n            <h3>Boundary Data</h3>\n            <div class=\"endpoint-section\">\n                <div class=\"endpoint-header\">\n                    <span class=\"method\">GET</span>\n                    <span class=\"url\">/api/boundaries/lookup</span>\n                    <span class=\"description\">Lookup Boundaries by Coordinates</span>\n                </div>\n                <p>Find boundaries using coordinates with optional dataset selection. Useful for direct database queries.</p>\n            </div>\n\n            <div class=\"endpoint-section\">\n                <div class=\"endpoint-header\">\n                    <span class=\"method\">GET</span>\n                    <span class=\"url\">/api/boundaries/all</span>\n                    <span class=\"description\">Get All Boundaries</span>\n                </div>\n                <p>Retrieve all boundaries from the database with pagination support.</p>\n            </div>\n\n            <h3>System & Monitoring</h3>\n            <div class=\"endpoint-section\">\n                <div class=\"endpoint-header\">\n                    <span class=\"method\">GET</span>\n                    <span class=\"url\">/health</span>\n                    <span class=\"description\">Health Check</span>\n                </div>\n                <p>Get comprehensive health status including metrics, circuit breakers, and cache warming status.</p>\n            </div>\n\n            <div class=\"endpoint-section\">\n                <div class=\"endpoint-header\">\n                    <span class=\"method\">GET</span>\n                    <span class=\"url\">/metrics</span>\n                    <span class=\"description\">Performance Metrics</span>\n                </div>\n                <p>Get detailed performance metrics and statistics for monitoring and optimization.</p>\n            </div>\n\n            <div class=\"endpoint-section\">\n                <div class=\"endpoint-header\">\n                    <span class=\"method\">GET</span>\n                    <span class=\"url\">/cache-warming</span>\n                    <span class=\"description\">Cache Warming Status</span>\n                </div>\n                <p>Get current cache warming status and configuration for performance optimization.</p>\n            </div>\n\n            <h3>Webhook Management</h3>\n            <div class=\"endpoint-section\">\n                <div class=\"endpoint-header\">\n                    <span class=\"method\">GET/POST</span>\n                    <span class=\"url\">/api/webhooks</span>\n                    <span class=\"description\">Webhook Management</span>\n                </div>\n                <p>List and create webhook configurations for event notifications.</p>\n            </div>\n\n            <div class=\"endpoint-section\">\n                <div class=\"endpoint-header\">\n                    <span class=\"method\">GET</span>\n                    <span class=\"url\">/api/webhooks/events</span>\n                    <span class=\"description\">Webhook Events</span>\n                </div>\n                <p>Get webhook events with optional filtering by status and webhook ID.</p>\n            </div>\n\n            <div class=\"endpoint-section\">\n                <div class=\"endpoint-header\">\n                    <span class=\"method\">GET</span>\n                    <span class=\"url\">/api/webhooks/deliveries</span>\n                    <span class=\"description\">Webhook Deliveries</span>\n                </div>\n                <p>Get webhook delivery attempts with detailed status information.</p>\n            </div>\n        </div>\n\n        <div class=\"section\">\n            <h2>Datasets</h2>\n            <ul class=\"datasets\">\n                <li><strong>/api</strong> \u2014 Federal ridings (338 ridings)</li>\n                <li><strong>/api/qc</strong> \u2014 Quebec provincial ridings (125 ridings)</li>\n                <li><strong>/api/on</strong> \u2014 Ontario provincial ridings (124 ridings)</li>\n            </ul>\n            <p>Have a dataset you'd like to see supported? <a href=\"https://github.com/wra-sol/ridingLookup/issues/new\">Open an issue</a> and we'll add it to the list.</p>\n            <p>Want to contribute a dataset? <a href=\"https://github.com/wra-sol/ridingLookup/blob/main/docs/CONTRIBUTING.md\">Read the contribution guidelines</a> and submit a pull request.</p>\n        </div>\n\n        <div class=\"section\">\n            <h2>Authentication</h2>\n            <p>This API supports two authentication methods:</p>\n            \n            <h3>Basic Authentication</h3>\n            <pre><code class=\"language-bash\">curl -u \"username:password\" \"${baseUrl}/api?postal=K1A 0A6\"</code></pre>\n            \n            <h3>Google Maps API Key (BYOK)</h3>\n            <p>Use your own Google Maps API key to bypass basic authentication:</p>\n            <pre><code class=\"language-bash\">curl -H \"X-Google-API-Key: YOUR_KEY\" \"${baseUrl}/api?address=123 Main St\"</code></pre>\n            \n            <div class=\"note\">\n                <strong>Note:</strong> When using the X-Google-API-Key header, basic authentication is automatically bypassed, allowing users to use their own Google API key without needing the configured basic auth credentials.\n            </div>\n        </div>\n\n        <div class=\"section\">\n            <h2>Rate Limiting & Performance</h2>\n            <div class=\"rate-limits\">\n                <h4>Rate Limits</h4>\n                <div class=\"rate-limit-item\">\n                    <span class=\"rate-limit-type\">Standard Requests</span>\n                    <span class=\"rate-limit-value\">100 requests/minute</span>\n                </div>\n                <div class=\"rate-limit-item\">\n                    <span class=\"rate-limit-type\">Batch Processing</span>\n                    <span class=\"rate-limit-value\">10 requests per batch</span>\n                </div>\n                <div class=\"rate-limit-item\">\n                    <span class=\"rate-limit-type\">Queue Processing</span>\n                    <span class=\"rate-limit-value\">Unlimited (async)</span>\n                </div>\n            </div>\n            \n            <h3>Timeouts</h3>\n            <ul>\n                <li><strong>Single lookups:</strong> 10s for geocoding, 5s for riding lookup</li>\n                <li><strong>Batch operations:</strong> 30s total processing time</li>\n                <li><strong>Maximum request timeout:</strong> 60s</li>\n            </ul>\n        </div>\n\n        <div class=\"section\">\n            <h2>Error Codes</h2>\n            <div class=\"error-codes\">\n                <h4>Common Error Responses</h4>\n                <div class=\"error-code\">\n                    <span class=\"error-code-name\">INVALID_POSTAL_CODE</span>\n                    <span class=\"error-code-desc\">Postal code format is invalid</span>\n                </div>\n                <div class=\"error-code\">\n                    <span class=\"error-code-name\">GEOCODING_FAILED</span>\n                    <span class=\"error-code-desc\">Address could not be geocoded</span>\n                </div>\n                <div class=\"error-code\">\n                    <span class=\"error-code-name\">INVALID_COORDINATES</span>\n                    <span class=\"error-code-desc\">Latitude/longitude values are invalid</span>\n                </div>\n                <div class=\"error-code\">\n                    <span class=\"error-code-name\">RIDING_NOT_FOUND</span>\n                    <span class=\"error-code-desc\">No riding found for the given location</span>\n                </div>\n                <div class=\"error-code\">\n                    <span class=\"error-code-name\">RATE_LIMIT_EXCEEDED</span>\n                    <span class=\"error-code-desc\">Too many requests, please slow down</span>\n                </div>\n                <div class=\"error-code\">\n                    <span class=\"error-code-name\">AUTHENTICATION_REQUIRED</span>\n                    <span class=\"error-code-desc\">Valid credentials or API key required</span>\n                </div>\n                <div class=\"error-code\">\n                    <span class=\"error-code-name\">BATCH_SIZE_EXCEEDED</span>\n                    <span class=\"error-code-desc\">Batch contains too many requests (max 100)</span>\n                </div>\n                <div class=\"error-code\">\n                    <span class=\"error-code-name\">CIRCUIT_BREAKER_OPEN</span>\n                    <span class=\"error-code-desc\">Service temporarily unavailable due to high error rate</span>\n                </div>\n            </div>\n        </div>\n\n\n        <div class=\"links\">\n            <a href=\"${baseUrl}/swagger\" target=\"_blank\">API Documentation</a>\n            <a href=\"${baseUrl}/api/docs\" target=\"_blank\">OpenAPI Spec</a>\n            <a href=\"https://github.com/wra-sol/ridingLookup\" target=\"_blank\">GitHub</a>\n        </div>\n    </div>\n\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js\"></script>\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js\"></script>\n    <script>\n        // Tab switching functionality\n        document.addEventListener('DOMContentLoaded', function() {\n            // Initialize Prism syntax highlighting\n            if (typeof Prism !== 'undefined') {\n                Prism.highlightAll();\n            }\n            // Get preferred language from URL params, default to curl\n            const urlParams = new URLSearchParams(window.location.search);\n            const preferredLang = urlParams.get('lang') || 'curl';\n            \n            // Function to set all examples to a specific language\n            function setAllExamplesToLanguage(lang) {\n                document.querySelectorAll('.example').forEach(example => {\n                    const tabs = example.querySelectorAll('.example-tab');\n                    const contents = example.querySelectorAll('.example-content');\n                    \n                    // Remove active classes\n                    tabs.forEach(tab => tab.classList.remove('active'));\n                    contents.forEach(content => content.classList.remove('active'));\n                    \n                    // Set preferred language as active\n                    const activeTab = example.querySelector('[data-type=\"' + lang + '\"]');\n                    const activeContent = example.querySelector('[data-type=\"' + lang + '\"].example-content');\n                    \n                    if (activeTab && activeContent) {\n                        activeTab.classList.add('active');\n                        activeContent.classList.add('active');\n                    } else {\n                        // Fallback to curl if preferred language not found\n                        const curlTab = example.querySelector('[data-type=\"curl\"]');\n                        const curlContent = example.querySelector('[data-type=\"curl\"].example-content');\n                        if (curlTab && curlContent) {\n                            curlTab.classList.add('active');\n                            curlContent.classList.add('active');\n                        }\n                    }\n                });\n            }\n            \n            // Initialize with preferred language\n            setAllExamplesToLanguage(preferredLang);\n            \n            // Add click handlers to all example tabs\n            document.querySelectorAll('.example-tab').forEach(tab => {\n                tab.addEventListener('click', function() {\n                    const type = this.getAttribute('data-type');\n                    \n                    // Update URL with language preference\n                    const url = new URL(window.location);\n                    url.searchParams.set('lang', type);\n                    window.history.replaceState({}, '', url);\n                    \n                    // Update ALL examples to use the selected language\n                    setAllExamplesToLanguage(type);\n                    \n                    // Re-highlight code after tab switch\n                    if (typeof Prism !== 'undefined') {\n                        Prism.highlightAll();\n                    }\n                });\n            });\n            \n            // Add click handlers to all response tabs\n            document.querySelectorAll('.response-tab').forEach(tab => {\n                tab.addEventListener('click', function() {\n                    const example = this.closest('.example');\n                    const type = this.getAttribute('data-type');\n                    \n                    // Update response tabs in this example only\n                    example.querySelectorAll('.response-tab').forEach(t => t.classList.remove('active'));\n                    example.querySelectorAll('.response-content').forEach(c => c.classList.remove('active'));\n                    \n                    // Activate selected tab and content\n                    this.classList.add('active');\n                    example.querySelector('[data-type=\"' + type + '\"].response-content').classList.add('active');\n                    \n                    // Re-highlight code after response tab switch\n                    if (typeof Prism !== 'undefined') {\n                        Prism.highlightAll();\n                    }\n                });\n            });\n        });\n    </script>\n</body>\n</html>`;\n}\n\nexport function createSwaggerUI(baseUrl: string): string {\n  return `<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <title>Riding Lookup API - Swagger UI</title>\n  <link rel=\"stylesheet\" type=\"text/css\" href=\"https://unpkg.com/swagger-ui-dist@4.15.5/swagger-ui.css\" />\n  <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css\">\n  <style>\n    html {\n      box-sizing: border-box;\n      overflow: -moz-scrollbars-vertical;\n      overflow-y: scroll;\n    }\n    *, *:before, *:after {\n      box-sizing: inherit;\n    }\n    body {\n      margin:0;\n      background: #fafafa;\n    }\n    .swagger-ui .topbar {\n      display: none;\n    }\n.swagger-ui .wrapper span:last-child div.opblock-tag-section:last-child {\n      padding-top: 0;\n      padding-bottom: 40px;\n    }\n}\n  </style>\n</head>\n<body>\n  <div id=\"swagger-ui\"></div>\n  <script src=\"https://unpkg.com/swagger-ui-dist@4.15.5/swagger-ui-bundle.js\"></script>\n  <script src=\"https://unpkg.com/swagger-ui-dist@4.15.5/swagger-ui-standalone-preset.js\"></script>\n  <script>\n    window.onload = function() {\n      const ui = SwaggerUIBundle({\n        url: '${baseUrl}/api/docs',\n        dom_id: '#swagger-ui',\n        deepLinking: true,\n        presets: [\n          SwaggerUIBundle.presets.apis,\n          SwaggerUIStandalonePreset\n        ],\n        plugins: [\n          SwaggerUIBundle.plugins.DownloadUrl\n        ],\n        layout: \"StandaloneLayout\"\n      });\n    };\n  </script>\n</body>\n</html>`;\n}\n\nexport function createOpenAPISpec(baseUrl: string) {\n  return {\n    openapi: \"3.0.0\",\n    info: {\n      title: \"Riding Lookup API\",\n      description:\n        \"Find Canadian federal, provincial, and territorial ridings by location. Uses GeoGratis Geolocation API (Government of Canada) as the primary geocoding service, with automatic fallback to Google Maps (BYOK), Mapbox, or Nominatim when needed. Features Google Maps batch geocoding for optimal performance and cost efficiency. Built on Cloudflare Workers for global edge performance.\",\n      version: \"1.0.0\",\n      contact: {\n        name: \"API Support\",\n        url: \"https://github.com\",\n        email: \"support@example.com\",\n      },\n      license: {\n        name: \"MIT\",\n        url: \"https://opensource.org/licenses/MIT\",\n      },\n    },\n    servers: [\n      {\n        url: baseUrl,\n        description: \"Production server\",\n      },\n    ],\n    paths: {\n      \"/api\": {\n        get: {\n          summary: \"Lookup federal riding by location\",\n          description:\n            \"Find the federal riding for a given location using postal code, address, or coordinates\",\n          tags: [\"Federal Ridings\"],\n          parameters: [\n            {\n              name: \"postal\",\n              in: \"query\",\n              description: \"Canadian postal code (e.g., K1A 0A6)\",\n              required: false,\n              schema: { type: \"string\", example: \"K1A 0A6\" },\n            },\n            {\n              name: \"address\",\n              in: \"query\",\n              description: \"Street address\",\n              required: false,\n              schema: { type: \"string\", example: \"123 Main St, Toronto, ON\" },\n            },\n            {\n              name: \"lat\",\n              in: \"query\",\n              description: \"Latitude\",\n              required: false,\n              schema: { type: \"number\", example: 45.4215 },\n            },\n            {\n              name: \"lon\",\n              in: \"query\",\n              description: \"Longitude\",\n              required: false,\n              schema: { type: \"number\", example: -75.6972 },\n            },\n            {\n              name: \"city\",\n              in: \"query\",\n              description: \"City name\",\n              required: false,\n              schema: { type: \"string\", example: \"Toronto\" },\n            },\n            {\n              name: \"state\",\n              in: \"query\",\n              description: \"Province or state\",\n              required: false,\n              schema: { type: \"string\", example: \"Ontario\" },\n            },\n            {\n              name: \"country\",\n              in: \"query\",\n              description: \"Country\",\n              required: false,\n              schema: { type: \"string\", example: \"Canada\" },\n            },\n          ],\n          responses: {\n            \"200\": {\n              description: \"Successful lookup\",\n              content: {\n                \"application/json\": {\n                  schema: {\n                    type: \"object\",\n                    properties: {\n                      query: {\n                        type: \"object\",\n                        description: \"The query parameters used\",\n                      },\n                      point: {\n                        type: \"object\",\n                        properties: {\n                          lon: { type: \"number\" },\n                          lat: { type: \"number\" },\n                        },\n                        description: \"Geocoded coordinates\",\n                      },\n                      properties: {\n                        type: \"object\",\n                        description:\n                          \"Riding properties including FED_NUM, FED_NAME, etc.\",\n                        nullable: true,\n                      },\n                    },\n                  },\n                  example: {\n                    query: { postal: \"K1A 0A6\" },\n                    point: { lon: -75.6972, lat: 45.4215 },\n                    properties: {\n                      FED_NUM: \"35047\",\n                      FED_NAME: \"Ottawa Centre\",\n                      PROV_TERR: \"Ontario\",\n                    },\n                  },\n                },\n              },\n            },\n            \"400\": {\n              description: \"Bad request - invalid parameters\",\n              content: {\n                \"application/json\": {\n                  schema: {\n                    type: \"object\",\n                    properties: {\n                      error: { type: \"string\" },\n                    },\n                  },\n                },\n              },\n            },\n            \"401\": {\n              description: \"Unauthorized - missing or invalid authentication\",\n              content: {\n                \"application/json\": {\n                  schema: {\n                    type: \"object\",\n                    properties: {\n                      error: { type: \"string\" },\n                    },\n                  },\n                },\n              },\n            },\n            \"429\": {\n              description: \"Rate limit exceeded\",\n              content: {\n                \"application/json\": {\n                  schema: {\n                    type: \"object\",\n                    properties: {\n                      error: { type: \"string\" },\n                      retryAfter: { type: \"number\" },\n                    },\n                  },\n                },\n              },\n            },\n          },\n          security: [{ basicAuth: [] }, { apiKey: [] }],\n        },\n      },\n      \"/api/qc\": {\n        get: {\n          summary: \"Lookup Quebec provincial riding by location\",\n          description: \"Find the Quebec provincial riding for a given location\",\n          tags: [\"Quebec Ridings\"],\n          parameters: [\n            {\n              name: \"postal\",\n              in: \"query\",\n              description: \"Canadian postal code (e.g., H2Y 1C6)\",\n              required: false,\n              schema: { type: \"string\", example: \"H2Y 1C6\" },\n            },\n            {\n              name: \"address\",\n              in: \"query\",\n              description: \"Street address\",\n              required: false,\n              schema: {\n                type: \"string\",\n                example: \"1234 Rue Saint-Denis, Montr\u00E9al, QC\",\n              },\n            },\n            {\n              name: \"lat\",\n              in: \"query\",\n              description: \"Latitude\",\n              required: false,\n              schema: { type: \"number\", example: 45.5017 },\n            },\n            {\n              name: \"lon\",\n              in: \"query\",\n              description: \"Longitude\",\n              required: false,\n              schema: { type: \"number\", example: -73.5673 },\n            },\n          ],\n          responses: {\n            \"200\": {\n              description: \"Successful lookup\",\n              content: {\n                \"application/json\": {\n                  schema: {\n                    type: \"object\",\n                    properties: {\n                      query: { type: \"object\" },\n                      point: {\n                        type: \"object\",\n                        properties: {\n                          lon: { type: \"number\" },\n                          lat: { type: \"number\" },\n                        },\n                      },\n                      properties: {\n                        type: \"object\",\n                        nullable: true,\n                      },\n                    },\n                  },\n                },\n              },\n            },\n          },\n          security: [{ basicAuth: [] }, { apiKey: [] }],\n        },\n      },\n      \"/api/on\": {\n        get: {\n          summary: \"Lookup Ontario provincial riding by location\",\n          description:\n            \"Find the Ontario provincial riding for a given location\",\n          tags: [\"Ontario Ridings\"],\n          parameters: [\n            {\n              name: \"postal\",\n              in: \"query\",\n              description: \"Canadian postal code (e.g., M5H 2N2)\",\n              required: false,\n              schema: { type: \"string\", example: \"M5H 2N2\" },\n            },\n            {\n              name: \"address\",\n              in: \"query\",\n              description: \"Street address\",\n              required: false,\n              schema: { type: \"string\", example: \"123 King St, Toronto, ON\" },\n            },\n            {\n              name: \"lat\",\n              in: \"query\",\n              description: \"Latitude\",\n              required: false,\n              schema: { type: \"number\", example: 43.6532 },\n            },\n            {\n              name: \"lon\",\n              in: \"query\",\n              description: \"Longitude\",\n              required: false,\n              schema: { type: \"number\", example: -79.3832 },\n            },\n          ],\n          responses: {\n            \"200\": {\n              description: \"Successful lookup\",\n              content: {\n                \"application/json\": {\n                  schema: {\n                    type: \"object\",\n                    properties: {\n                      query: { type: \"object\" },\n                      point: {\n                        type: \"object\",\n                        properties: {\n                          lon: { type: \"number\" },\n                          lat: { type: \"number\" },\n                        },\n                      },\n                      properties: {\n                        type: \"object\",\n                        nullable: true,\n                      },\n                    },\n                  },\n                },\n              },\n            },\n          },\n          security: [{ basicAuth: [] }, { apiKey: [] }],\n        },\n      },\n      \"/batch\": {\n        post: {\n          summary: \"Process batch of lookup requests\",\n          description: \"Process multiple lookup requests in a single call\",\n          tags: [\"Batch Processing\"],\n          requestBody: {\n            required: true,\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    requests: {\n                      type: \"array\",\n                      items: {\n                        type: \"object\",\n                        properties: {\n                          id: { type: \"string\" },\n                          pathname: {\n                            type: \"string\",\n                            enum: [\"/api\", \"/api/qc\", \"/api/on\"],\n                          },\n                          query: {\n                            type: \"object\",\n                            properties: {\n                              postal: { type: \"string\" },\n                              address: { type: \"string\" },\n                              lat: { type: \"number\" },\n                              lon: { type: \"number\" },\n                              city: { type: \"string\" },\n                              state: { type: \"string\" },\n                              country: { type: \"string\" },\n                            },\n                          },\n                        },\n                        required: [\"id\", \"pathname\", \"query\"],\n                      },\n                    },\n                  },\n                  required: [\"requests\"],\n                },\n              },\n            },\n          },\n          responses: {\n            \"200\": {\n              description: \"Batch processing completed\",\n              content: {\n                \"application/json\": {\n                  schema: {\n                    type: \"object\",\n                    properties: {\n                      results: {\n                        type: \"array\",\n                        items: {\n                          type: \"object\",\n                          properties: {\n                            id: { type: \"string\" },\n                            query: { type: \"object\" },\n                            point: { type: \"object\", nullable: true },\n                            properties: { type: \"object\", nullable: true },\n                            error: { type: \"string\" },\n                            processingTime: { type: \"number\" },\n                          },\n                        },\n                      },\n                    },\n                  },\n                },\n              },\n            },\n          },\n          security: [{ basicAuth: [] }, { apiKey: [] }],\n        },\n      },\n      \"/api/queue/submit\": {\n        post: {\n          summary: \"Submit Batch to Queue\",\n          description:\n            \"Submit a batch of riding lookups to the persistent queue for asynchronous processing. Returns immediately with batch ID for status tracking.\",\n          tags: [\"Queue Operations\"],\n          requestBody: {\n            required: true,\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    requests: {\n                      type: \"array\",\n                      items: {\n                        type: \"object\",\n                        properties: {\n                          id: { type: \"string\" },\n                          pathname: {\n                            type: \"string\",\n                            enum: [\"/api\", \"/api/qc\", \"/api/on\"],\n                          },\n                          query: {\n                            type: \"object\",\n                            properties: {\n                              postal: { type: \"string\" },\n                              address: { type: \"string\" },\n                              lat: { type: \"number\" },\n                              lon: { type: \"number\" },\n                              city: { type: \"string\" },\n                              state: { type: \"string\" },\n                              country: { type: \"string\" },\n                            },\n                          },\n                        },\n                        required: [\"id\", \"pathname\", \"query\"],\n                      },\n                    },\n                  },\n                  required: [\"requests\"],\n                },\n              },\n            },\n          },\n          responses: {\n            \"200\": {\n              description: \"Batch submitted successfully\",\n              content: {\n                \"application/json\": {\n                  schema: {\n                    type: \"object\",\n                    properties: {\n                      batchId: { type: \"string\" },\n                      status: { type: \"string\" },\n                      message: { type: \"string\" },\n                    },\n                  },\n                },\n              },\n            },\n          },\n          security: [{ basicAuth: [] }, { apiKey: [] }],\n        },\n      },\n      \"/api/queue/status\": {\n        get: {\n          summary: \"Get Batch Status\",\n          description:\n            \"Check the status of a submitted batch job including completion progress and results.\",\n          tags: [\"Queue Operations\"],\n          parameters: [\n            {\n              name: \"batchId\",\n              in: \"query\",\n              description: \"The batch ID returned from queue submission\",\n              required: true,\n              schema: { type: \"string\" },\n            },\n          ],\n          responses: {\n            \"200\": {\n              description: \"Batch status retrieved successfully\",\n              content: {\n                \"application/json\": {\n                  schema: {\n                    type: \"object\",\n                    properties: {\n                      batchId: { type: \"string\" },\n                      status: {\n                        type: \"string\",\n                        enum: [\"pending\", \"processing\", \"completed\", \"failed\"],\n                      },\n                      progress: {\n                        type: \"object\",\n                        properties: {\n                          total: { type: \"number\" },\n                          completed: { type: \"number\" },\n                          failed: { type: \"number\" },\n                          pending: { type: \"number\" },\n                        },\n                      },\n                      results: {\n                        type: \"array\",\n                        items: {\n                          type: \"object\",\n                          properties: {\n                            id: { type: \"string\" },\n                            query: { type: \"object\" },\n                            point: { type: \"object\", nullable: true },\n                            properties: { type: \"object\", nullable: true },\n                            error: { type: \"string\" },\n                            processingTime: { type: \"number\" },\n                          },\n                        },\n                      },\n                      createdAt: { type: \"string\", format: \"date-time\" },\n                      updatedAt: { type: \"string\", format: \"date-time\" },\n                    },\n                  },\n                },\n              },\n            },\n          },\n          security: [{ basicAuth: [] }, { apiKey: [] }],\n        },\n      },\n      \"/api/queue/stats\": {\n        get: {\n          summary: \"Get Queue Statistics\",\n          description:\n            \"Get comprehensive statistics about the queue including job counts, processing times, and success rates.\",\n          tags: [\"Queue Operations\"],\n          responses: {\n            \"200\": {\n              description: \"Queue statistics retrieved successfully\",\n              content: {\n                \"application/json\": {\n                  schema: {\n                    type: \"object\",\n                    properties: {\n                      totalBatches: { type: \"number\" },\n                      pendingBatches: { type: \"number\" },\n                      processingBatches: { type: \"number\" },\n                      completedBatches: { type: \"number\" },\n                      failedBatches: { type: \"number\" },\n                      totalJobs: { type: \"number\" },\n                      pendingJobs: { type: \"number\" },\n                      completedJobs: { type: \"number\" },\n                      failedJobs: { type: \"number\" },\n                      averageProcessingTime: { type: \"number\" },\n                      successRate: { type: \"number\" },\n                      lastUpdated: { type: \"string\", format: \"date-time\" },\n                    },\n                  },\n                },\n              },\n            },\n          },\n          security: [{ basicAuth: [] }, { apiKey: [] }],\n        },\n      },\n      \"/api/queue/process\": {\n        post: {\n          summary: \"Process Queue Jobs\",\n          description:\n            \"Process pending jobs from the queue. This endpoint is typically called by worker processes.\",\n          tags: [\"Queue Operations\"],\n          requestBody: {\n            required: false,\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    maxJobs: {\n                      type: \"number\",\n                      description:\n                        \"Maximum number of jobs to process (default: 10)\",\n                      default: 10,\n                    },\n                  },\n                },\n              },\n            },\n          },\n          responses: {\n            \"200\": {\n              description: \"Queue processing completed\",\n              content: {\n                \"application/json\": {\n                  schema: {\n                    type: \"object\",\n                    properties: {\n                      processed: { type: \"number\" },\n                      successful: { type: \"number\" },\n                      failed: { type: \"number\" },\n                      results: { type: \"array\" },\n                    },\n                  },\n                },\n              },\n            },\n          },\n          security: [{ basicAuth: [] }, { apiKey: [] }],\n        },\n      },\n      \"/api/database/init\": {\n        post: {\n          summary: \"Initialize Spatial Database\",\n          description:\n            \"Initialize the spatial database with required tables and indexes\",\n          tags: [\"Database Operations\"],\n          responses: {\n            \"200\": {\n              description: \"Database initialization completed\",\n              content: {\n                \"application/json\": {\n                  schema: {\n                    type: \"object\",\n                    properties: {\n                      success: { type: \"boolean\" },\n                      message: { type: \"string\" },\n                    },\n                  },\n                },\n              },\n            },\n          },\n          security: [{ basicAuth: [] }],\n        },\n      },\n      \"/api/database/sync\": {\n        post: {\n          summary: \"Sync GeoJSON to Database\",\n          description: \"Synchronize GeoJSON data to the spatial database\",\n          tags: [\"Database Operations\"],\n          requestBody: {\n            required: false,\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    dataset: {\n                      type: \"string\",\n                      enum: [\n                        \"federalridings-2024.geojson\",\n                        \"quebecridings-2025.geojson\",\n                        \"ontarioridings-2022.geojson\",\n                      ],\n                      default: \"federalridings-2024.geojson\",\n                    },\n                  },\n                },\n              },\n            },\n          },\n          responses: {\n            \"200\": {\n              description: \"Database sync completed\",\n              content: {\n                \"application/json\": {\n                  schema: {\n                    type: \"object\",\n                    properties: {\n                      success: { type: \"boolean\" },\n                      message: { type: \"string\" },\n                      dataset: { type: \"string\" },\n                    },\n                  },\n                },\n              },\n            },\n          },\n          security: [{ basicAuth: [] }],\n        },\n      },\n      \"/api/database/stats\": {\n        get: {\n          summary: \"Get Database Statistics\",\n          description: \"Get statistics about the spatial database\",\n          tags: [\"Database Operations\"],\n          responses: {\n            \"200\": {\n              description: \"Database statistics retrieved\",\n              content: {\n                \"application/json\": {\n                  schema: {\n                    type: \"object\",\n                    properties: {\n                      enabled: { type: \"boolean\" },\n                      features: { type: \"number\" },\n                      lastSync: {\n                        type: \"string\",\n                        format: \"date-time\",\n                        nullable: true,\n                      },\n                      status: { type: \"string\", enum: [\"active\", \"disabled\"] },\n                    },\n                  },\n                },\n              },\n            },\n          },\n          security: [{ basicAuth: [] }],\n        },\n      },\n      \"/api/database/query\": {\n        get: {\n          summary: \"Query Database Directly\",\n          description: \"Query the spatial database directly by coordinates\",\n          tags: [\"Database Operations\"],\n          parameters: [\n            {\n              name: \"lat\",\n              in: \"query\",\n              description: \"Latitude\",\n              required: true,\n              schema: { type: \"number\", example: 45.4215 },\n            },\n            {\n              name: \"lon\",\n              in: \"query\",\n              description: \"Longitude\",\n              required: true,\n              schema: { type: \"number\", example: -75.6972 },\n            },\n            {\n              name: \"dataset\",\n              in: \"query\",\n              description: \"Dataset to query\",\n              required: false,\n              schema: {\n                type: \"string\",\n                enum: [\n                  \"federalridings-2024.geojson\",\n                  \"quebecridings-2025.geojson\",\n                  \"ontarioridings-2022.geojson\",\n                ],\n                default: \"federalridings-2024.geojson\",\n              },\n            },\n          ],\n          responses: {\n            \"200\": {\n              description: \"Database query successful\",\n              content: {\n                \"application/json\": {\n                  schema: {\n                    type: \"object\",\n                    properties: {\n                      type: { type: \"string\" },\n                      properties: { type: \"object\" },\n                      geometry: { type: \"object\" },\n                    },\n                  },\n                },\n              },\n            },\n          },\n        },\n      },\n      \"/api/boundaries/lookup\": {\n        get: {\n          summary: \"Lookup Boundaries by Coordinates\",\n          description:\n            \"Find boundaries using coordinates with optional dataset selection\",\n          tags: [\"Boundaries\"],\n          parameters: [\n            {\n              name: \"lat\",\n              in: \"query\",\n              description: \"Latitude\",\n              required: true,\n              schema: { type: \"number\", example: 45.4215 },\n            },\n            {\n              name: \"lon\",\n              in: \"query\",\n              description: \"Longitude\",\n              required: true,\n              schema: { type: \"number\", example: -75.6972 },\n            },\n            {\n              name: \"dataset\",\n              in: \"query\",\n              description: \"Dataset to search\",\n              required: false,\n              schema: {\n                type: \"string\",\n                enum: [\n                  \"federalridings-2024.geojson\",\n                  \"quebecridings-2025.geojson\",\n                  \"ontarioridings-2022.geojson\",\n                ],\n                default: \"federalridings-2024.geojson\",\n              },\n            },\n          ],\n          responses: {\n            \"200\": {\n              description: \"Boundaries lookup successful\",\n              content: {\n                \"application/json\": {\n                  schema: {\n                    type: \"object\",\n                    properties: {\n                      riding: { type: \"string\" },\n                      properties: { type: \"object\" },\n                      source: { type: \"string\" },\n                    },\n                  },\n                },\n              },\n            },\n          },\n        },\n      },\n      \"/api/boundaries/all\": {\n        get: {\n          summary: \"Get All Boundaries\",\n          description: \"Get all boundaries from the database with pagination\",\n          tags: [\"Boundaries\"],\n          parameters: [\n            {\n              name: \"dataset\",\n              in: \"query\",\n              description: \"Dataset to retrieve\",\n              required: false,\n              schema: {\n                type: \"string\",\n                enum: [\n                  \"federalridings-2024.geojson\",\n                  \"quebecridings-2025.geojson\",\n                  \"ontarioridings-2022.geojson\",\n                ],\n                default: \"federalridings-2024.geojson\",\n              },\n            },\n            {\n              name: \"limit\",\n              in: \"query\",\n              description: \"Number of results to return\",\n              required: false,\n              schema: {\n                type: \"number\",\n                default: 100,\n                minimum: 1,\n                maximum: 1000,\n              },\n            },\n            {\n              name: \"offset\",\n              in: \"query\",\n              description: \"Number of results to skip\",\n              required: false,\n              schema: { type: \"number\", default: 0, minimum: 0 },\n            },\n          ],\n          responses: {\n            \"200\": {\n              description: \"Boundaries retrieved successfully\",\n              content: {\n                \"application/json\": {\n                  schema: {\n                    type: \"object\",\n                    properties: {\n                      features: {\n                        type: \"array\",\n                        items: {\n                          type: \"object\",\n                          properties: {\n                            type: { type: \"string\" },\n                            properties: { type: \"object\" },\n                            geometry: { type: \"object\" },\n                          },\n                        },\n                      },\n                      total: { type: \"number\" },\n                    },\n                  },\n                },\n              },\n            },\n          },\n        },\n      },\n      \"/api/boundaries/config\": {\n        get: {\n          summary: \"Get Boundaries Configuration\",\n          description:\n            \"Get configuration information for boundaries processing\",\n          tags: [\"Boundaries\"],\n          responses: {\n            \"200\": {\n              description: \"Boundaries configuration retrieved\",\n              content: {\n                \"application/json\": {\n                  schema: {\n                    type: \"object\",\n                    properties: {\n                      enabled: { type: \"boolean\" },\n                      useRtreeIndex: { type: \"boolean\" },\n                      batchInsertSize: { type: \"number\" },\n                      datasets: {\n                        type: \"array\",\n                        items: { type: \"string\" },\n                      },\n                    },\n                  },\n                },\n              },\n            },\n          },\n        },\n      },\n      \"/api/geocoding/batch/status\": {\n        get: {\n          summary: \"Get Geocoding Batch Status\",\n          description:\n            \"Get status and configuration of batch geocoding functionality\",\n          tags: [\"Geocoding\"],\n          responses: {\n            \"200\": {\n              description: \"Geocoding batch status retrieved\",\n              content: {\n                \"application/json\": {\n                  schema: {\n                    type: \"object\",\n                    properties: {\n                      enabled: { type: \"boolean\" },\n                      maxBatchSize: { type: \"number\" },\n                      timeout: { type: \"number\" },\n                      retryAttempts: { type: \"number\" },\n                      fallbackToIndividual: { type: \"boolean\" },\n                      hasGoogleApiKey: { type: \"boolean\" },\n                      timestamp: { type: \"number\" },\n                    },\n                  },\n                },\n              },\n            },\n          },\n        },\n      },\n      \"/api/cache/warm\": {\n        post: {\n          summary: \"Trigger Cache Warming\",\n          description: \"Manually trigger cache warming for specified locations\",\n          tags: [\"Cache Management\"],\n          requestBody: {\n            required: false,\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    locations: {\n                      type: \"array\",\n                      items: {\n                        type: \"object\",\n                        properties: {\n                          lat: { type: \"number\" },\n                          lon: { type: \"number\" },\n                          postal: { type: \"string\" },\n                        },\n                      },\n                    },\n                  },\n                },\n              },\n            },\n          },\n          responses: {\n            \"200\": {\n              description: \"Cache warming initiated\",\n              content: {\n                \"application/json\": {\n                  schema: {\n                    type: \"object\",\n                    properties: {\n                      message: { type: \"string\" },\n                      locations: { type: \"number\" },\n                      timestamp: { type: \"number\" },\n                    },\n                  },\n                },\n              },\n            },\n          },\n          security: [{ basicAuth: [] }],\n        },\n      },\n      \"/api/webhooks\": {\n        get: {\n          summary: \"List Webhooks\",\n          description: \"Get list of all configured webhooks\",\n          tags: [\"Webhook Management\"],\n          responses: {\n            \"200\": {\n              description: \"Webhooks list retrieved\",\n              content: {\n                \"application/json\": {\n                  schema: {\n                    type: \"object\",\n                    properties: {\n                      webhooks: {\n                        type: \"array\",\n                        items: {\n                          type: \"object\",\n                          properties: {\n                            id: { type: \"string\" },\n                            url: { type: \"string\" },\n                            events: {\n                              type: \"array\",\n                              items: { type: \"string\" },\n                            },\n                            secret: { type: \"string\", nullable: true },\n                            createdAt: { type: \"number\" },\n                            lastDelivery: { type: \"number\", nullable: true },\n                            failureCount: { type: \"number\" },\n                            maxFailures: { type: \"number\" },\n                            active: { type: \"boolean\" },\n                          },\n                        },\n                      },\n                    },\n                  },\n                },\n              },\n            },\n          },\n          security: [{ basicAuth: [] }],\n        },\n        post: {\n          summary: \"Create Webhook\",\n          description: \"Create a new webhook configuration\",\n          tags: [\"Webhook Management\"],\n          requestBody: {\n            required: true,\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    url: { type: \"string\", format: \"uri\" },\n                    events: {\n                      type: \"array\",\n                      items: { type: \"string\" },\n                      example: [\"batch.completed\", \"batch.failed\"],\n                    },\n                    secret: {\n                      type: \"string\",\n                      description: \"Optional webhook secret\",\n                    },\n                  },\n                  required: [\"url\", \"events\"],\n                },\n              },\n            },\n          },\n          responses: {\n            \"200\": {\n              description: \"Webhook created successfully\",\n              content: {\n                \"application/json\": {\n                  schema: {\n                    type: \"object\",\n                    properties: {\n                      webhookId: { type: \"string\" },\n                      message: { type: \"string\" },\n                    },\n                  },\n                },\n              },\n            },\n          },\n          security: [{ basicAuth: [] }],\n        },\n      },\n      \"/api/webhooks/events\": {\n        get: {\n          summary: \"Get Webhook Events\",\n          description: \"Get webhook events with optional filtering\",\n          tags: [\"Webhook Management\"],\n          parameters: [\n            {\n              name: \"status\",\n              in: \"query\",\n              description: \"Filter by event status\",\n              required: false,\n              schema: {\n                type: \"string\",\n                enum: [\"pending\", \"delivered\", \"failed\"],\n              },\n            },\n            {\n              name: \"webhookId\",\n              in: \"query\",\n              description: \"Filter by webhook ID\",\n              required: false,\n              schema: { type: \"string\" },\n            },\n          ],\n          responses: {\n            \"200\": {\n              description: \"Webhook events retrieved\",\n              content: {\n                \"application/json\": {\n                  schema: {\n                    type: \"object\",\n                    properties: {\n                      events: {\n                        type: \"array\",\n                        items: {\n                          type: \"object\",\n                          properties: {\n                            id: { type: \"string\" },\n                            webhookId: { type: \"string\" },\n                            eventType: { type: \"string\" },\n                            status: { type: \"string\" },\n                            payload: { type: \"object\" },\n                            createdAt: { type: \"number\" },\n                          },\n                        },\n                      },\n                    },\n                  },\n                },\n              },\n            },\n          },\n          security: [{ basicAuth: [] }],\n        },\n      },\n      \"/api/webhooks/deliveries\": {\n        get: {\n          summary: \"Get Webhook Deliveries\",\n          description: \"Get webhook delivery attempts with optional filtering\",\n          tags: [\"Webhook Management\"],\n          parameters: [\n            {\n              name: \"webhookId\",\n              in: \"query\",\n              description: \"Filter by webhook ID\",\n              required: false,\n              schema: { type: \"string\" },\n            },\n            {\n              name: \"status\",\n              in: \"query\",\n              description: \"Filter by delivery status\",\n              required: false,\n              schema: {\n                type: \"string\",\n                enum: [\"pending\", \"success\", \"failed\"],\n              },\n            },\n          ],\n          responses: {\n            \"200\": {\n              description: \"Webhook deliveries retrieved\",\n              content: {\n                \"application/json\": {\n                  schema: {\n                    type: \"object\",\n                    properties: {\n                      deliveries: {\n                        type: \"array\",\n                        items: {\n                          type: \"object\",\n                          properties: {\n                            id: { type: \"string\" },\n                            webhookId: { type: \"string\" },\n                            eventId: { type: \"string\" },\n                            status: { type: \"string\" },\n                            responseCode: { type: \"number\", nullable: true },\n                            responseBody: { type: \"string\", nullable: true },\n                            attemptCount: { type: \"number\" },\n                            createdAt: { type: \"number\" },\n                          },\n                        },\n                      },\n                    },\n                  },\n                },\n              },\n            },\n          },\n          security: [{ basicAuth: [] }],\n        },\n      },\n      \"/health\": {\n        get: {\n          summary: \"Health Check\",\n          description:\n            \"Get comprehensive health status including metrics, circuit breakers, and cache warming status\",\n          tags: [\"System\"],\n          responses: {\n            \"200\": {\n              description: \"Health status retrieved\",\n              content: {\n                \"application/json\": {\n                  schema: {\n                    type: \"object\",\n                    properties: {\n                      status: {\n                        type: \"string\",\n                        enum: [\"healthy\", \"unhealthy\"],\n                      },\n                      timestamp: { type: \"number\" },\n                      metrics: { type: \"object\" },\n                      circuitBreakers: { type: \"object\" },\n                      cacheWarming: { type: \"object\" },\n                    },\n                  },\n                },\n              },\n            },\n          },\n        },\n      },\n      \"/metrics\": {\n        get: {\n          summary: \"Get Performance Metrics\",\n          description: \"Get detailed performance metrics and statistics\",\n          tags: [\"System\"],\n          responses: {\n            \"200\": {\n              description: \"Metrics retrieved successfully\",\n              content: {\n                \"application/json\": {\n                  schema: {\n                    type: \"object\",\n                    properties: {\n                      requests: {\n                        type: \"object\",\n                        properties: {\n                          total: { type: \"number\" },\n                          errors: { type: \"number\" },\n                          errorRate: { type: \"number\" },\n                        },\n                      },\n                      geocoding: { type: \"object\" },\n                      r2: { type: \"object\" },\n                      lookup: { type: \"object\" },\n                      batch: { type: \"object\" },\n                      webhooks: { type: \"object\" },\n                    },\n                  },\n                },\n              },\n            },\n          },\n        },\n      },\n      \"/cache-warming\": {\n        get: {\n          summary: \"Get Cache Warming Status\",\n          description: \"Get current cache warming status and configuration\",\n          tags: [\"Cache Management\"],\n          responses: {\n            \"200\": {\n              description: \"Cache warming status retrieved\",\n              content: {\n                \"application/json\": {\n                  schema: {\n                    type: \"object\",\n                    properties: {\n                      isRunning: { type: \"boolean\" },\n                      lastWarmed: { type: \"number\" },\n                      currentBatch: { type: \"number\" },\n                      totalBatches: { type: \"number\" },\n                      successCount: { type: \"number\" },\n                      failureCount: { type: \"number\" },\n                      nextWarmingTime: { type: \"number\" },\n                      config: {\n                        type: \"object\",\n                        properties: {\n                          enabled: { type: \"boolean\" },\n                          interval: { type: \"number\" },\n                          batchSize: { type: \"number\" },\n                        },\n                      },\n                    },\n                  },\n                },\n              },\n            },\n          },\n        },\n      },\n      \"/webhooks\": {\n        get: {\n          summary: \"List Webhooks (Legacy)\",\n          description:\n            \"Legacy endpoint for listing webhooks - use /api/webhooks instead\",\n          tags: [\"Webhook Management\"],\n          responses: {\n            \"200\": {\n              description: \"Webhooks list retrieved\",\n              content: {\n                \"application/json\": {\n                  schema: {\n                    type: \"object\",\n                    properties: {\n                      webhooks: {\n                        type: \"array\",\n                        items: { type: \"object\" },\n                      },\n                    },\n                  },\n                },\n              },\n            },\n          },\n        },\n      },\n      \"/webhooks/events\": {\n        get: {\n          summary: \"Get Webhook Events (Legacy)\",\n          description:\n            \"Legacy endpoint for webhook events - use /api/webhooks/events instead\",\n          tags: [\"Webhook Management\"],\n          responses: {\n            \"200\": {\n              description: \"Webhook events retrieved\",\n              content: {\n                \"application/json\": {\n                  schema: {\n                    type: \"object\",\n                    properties: {\n                      events: { type: \"array\" },\n                    },\n                  },\n                },\n              },\n            },\n          },\n        },\n      },\n      \"/webhooks/deliveries\": {\n        get: {\n          summary: \"Get Webhook Deliveries (Legacy)\",\n          description:\n            \"Legacy endpoint for webhook deliveries - use /api/webhooks/deliveries instead\",\n          tags: [\"Webhook Management\"],\n          responses: {\n            \"200\": {\n              description: \"Webhook deliveries retrieved\",\n              content: {\n                \"application/json\": {\n                  schema: {\n                    type: \"object\",\n                    properties: {\n                      deliveries: { type: \"array\" },\n                    },\n                  },\n                },\n              },\n            },\n          },\n        },\n      },\n    },\n    securitySchemes: {\n      basicAuth: {\n        type: \"http\",\n        scheme: \"basic\",\n      },\n      apiKey: {\n        type: \"apiKey\",\n        in: \"header\",\n        name: \"X-Google-API-Key\",\n        description: \"Google Maps API key for BYOK authentication\",\n      },\n    },\n    tags: [\n      {\n        name: \"Federal Ridings\",\n        description: \"Operations for federal riding lookups\",\n      },\n      {\n        name: \"Quebec Ridings\",\n        description: \"Operations for Quebec provincial riding lookups\",\n      },\n      {\n        name: \"Ontario Ridings\",\n        description: \"Operations for Ontario provincial riding lookups\",\n      },\n      {\n        name: \"Batch Processing\",\n        description: \"Batch processing operations\",\n      },\n      {\n        name: \"Queue Operations\",\n        description: \"Queue-based batch processing operations\",\n      },\n      {\n        name: \"Database Operations\",\n        description: \"Spatial database management and operations\",\n      },\n      {\n        name: \"Boundaries\",\n        description: \"Boundary data access and configuration\",\n      },\n      {\n        name: \"Geocoding\",\n        description: \"Geocoding service management and status\",\n      },\n      {\n        name: \"Cache Management\",\n        description: \"Cache warming and management operations\",\n      },\n      {\n        name: \"Webhook Management\",\n        description: \"Webhook configuration and monitoring\",\n      },\n      {\n        name: \"System\",\n        description: \"System health and monitoring endpoints\",\n      },\n    ],\n  };\n}\n", "/// <reference types=\"@cloudflare/workers-types\" />\n\nimport { Env, QueryParams, LookupResult, GeoJSONFeatureCollection, SpatialIndex } from './types';\nimport { geocodeIfNeeded, geocodeBatch, normalizeAddressWithGoogle } from './geocoding';\nimport { \n  geoCacheLRU, \n  spatialIndexCacheLRU, \n  getCachedGeoJSON, \n  setCachedGeoJSON, \n  getCachedSpatialIndex, \n  setCachedSpatialIndex,\n  getCachedSimplifiedBoundary,\n  setCachedSimplifiedBoundary,\n  performCacheWarming,\n  getCacheWarmingStatus,\n  generateLookupCacheKey,\n  getCachedLookupResult,\n  setCachedLookupResult\n} from './cache';\nimport { initializeCircuitBreakers, geocodingCircuitBreaker, r2CircuitBreaker } from './circuit-breaker';\nimport { incrementMetric, recordTiming, getMetrics, getMetricsSummary } from './metrics';\nimport { \n  isPointInPolygon, \n  withTimeout, \n  withRetry, \n  pickDataset, \n  parseQuery, \n  checkBasicAuth, \n  badRequest, \n  unauthorizedResponse, \n  rateLimitExceededResponse,\n  checkRateLimit,\n  getClientId,\n  simplifyGeometry,\n  getCorrelationId\n} from './utils';\nimport { \n  createSpatialIndex, \n  findCandidateFeatures, \n  isPointInBoundingBox,\n  queryRidingFromDatabase,\n  initializeSpatialDatabase,\n  insertFeaturesIntoDatabase,\n  getAllFeaturesFromDatabase,\n  syncGeoJSONToDatabase,\n  getSpatialDbConfig\n} from './spatial';\nimport { \n  initializeWebhookProcessing, \n  triggerBatchCompletionWebhook,\n  getAllWebhooks,\n  getWebhookEvents,\n  getWebhookDeliveries,\n  generateWebhookId,\n  createWebhook,\n  updateWebhook,\n  deleteWebhook,\n  getWebhook\n} from './webhooks';\nimport { \n  processBatchLookup, \n  processBatchLookupWithBatchGeocoding,\n  submitBatchToQueue,\n  getBatchStatus,\n  processQueueJobs,\n  BATCH_CONFIG\n} from './batch';\nimport { QueueManagerDO } from './queue-manager';\nimport { CircuitBreakerDO } from './circuit-breaker-do';\nimport { createLandingPage, createSwaggerUI, createOpenAPISpec } from './docs';\nimport { getTimeoutConfig, getRetryConfig, TIME_CONSTANTS } from './config';\n\n// Global state\nlet cacheWarmingInitialized = false;\n\n/**\n * Handle scheduled events (Cron Triggers) for cache warming.\n */\nasync function handleScheduled(event: ScheduledEvent, env: Env, ctx: ExecutionContext): Promise<void> {\n  console.log(`[Cron] Scheduled event triggered: ${event.cron}`);\n  \n  // Perform cache warming\n  try {\n    await performCacheWarming(env, async (env: Env, r2Key: string) => {\n      await loadGeo(env, r2Key);\n    }, lookupRiding);\n    console.log('[Cron] Cache warming completed successfully');\n  } catch (error) {\n    console.error('[Cron] Cache warming failed:', error);\n  }\n}\n\n// Main lookup function\nasync function lookupRiding(env: Env, pathname: string, lon: number, lat: number): Promise<LookupResult> {\n  const timeoutConfig = getTimeoutConfig(env);\n  const timeoutMs = timeoutConfig.lookup;\n  \n  const lookupPromise = (async () => {\n    const { r2Key } = pickDataset(pathname);\n    \n    // Try spatial database first if enabled\n    const dbConfig = getSpatialDbConfig(env);\n    if (dbConfig.ENABLED && env.RIDING_DB) {\n      try {\n        const dbResult = await queryRidingFromDatabase(env, r2Key, lon, lat);\n        if (dbResult) {\n          const englishName = dbResult.properties?.ENGLISH_NAME;\n          const nameEn = dbResult.properties?.NAME_EN;\n          const ridingName = (typeof englishName === 'string' ? englishName : null) \n            || (typeof nameEn === 'string' ? nameEn : null) \n            || 'Unknown';\n          return {\n            riding: ridingName,\n            properties: dbResult.properties || {}\n          };\n        }\n      } catch (error) {\n        console.warn('Database lookup failed, falling back to spatial index:', error);\n      }\n    }\n    \n    // Check LRU cache\n    let spatialIndex = spatialIndexCacheLRU.get(r2Key);\n    \n    if (!spatialIndex) {\n        // Load GeoJSON to create spatial index\n        await loadGeo(env, r2Key);\n        spatialIndex = spatialIndexCacheLRU.get(r2Key);\n        if (!spatialIndex) throw new Error(`Failed to create spatial index for ${r2Key}`);\n    }\n    \n    return lookupRidingWithIndex(spatialIndex, lon, lat);\n  })();\n\n  return withTimeout(lookupPromise, timeoutMs, \"Riding lookup\");\n}\n\n// Load GeoJSON data from R2\nasync function loadGeo(env: Env, key: string): Promise<GeoJSONFeatureCollection> {\n  const startTime = Date.now();\n  incrementMetric('r2Requests');\n  \n  // Check LRU cache\n  const cached = geoCacheLRU.get(key);\n  if (cached) {\n    incrementMetric('r2CacheHits');\n    recordTiming('totalR2Time', Date.now() - startTime);\n    return cached;\n  }\n\n  incrementMetric('r2CacheMisses');\n  \n  try {\n    const geo = await r2CircuitBreaker.execute(`r2:${key}`, async () => {\n      const retryConfig = getRetryConfig();\n      return await withRetry(async () => {\n        const obj = await env.RIDINGS.get(key);\n        if (!obj) throw new Error(`R2 object not found: ${key}`);\n        const text = await obj.text();\n        const parsed = JSON.parse(text) as GeoJSONFeatureCollection;\n        \n        // Validate GeoJSON structure\n        if (!parsed || typeof parsed !== 'object') {\n          throw new Error(`Invalid GeoJSON: not an object`);\n        }\n        if (parsed.type !== 'FeatureCollection') {\n          throw new Error(`Invalid GeoJSON: expected FeatureCollection, got ${parsed.type}`);\n        }\n        if (!Array.isArray(parsed.features)) {\n          throw new Error(`Invalid GeoJSON: features must be an array`);\n        }\n        \n        // Validate features structure\n        for (let i = 0; i < Math.min(parsed.features.length, 10); i++) {\n          const feature = parsed.features[i];\n          if (!feature || typeof feature !== 'object') {\n            throw new Error(`Invalid GeoJSON: feature ${i} is not an object`);\n          }\n          if (feature.type !== 'Feature') {\n            throw new Error(`Invalid GeoJSON: feature ${i} type is not 'Feature'`);\n          }\n          if (!feature.geometry || typeof feature.geometry !== 'object') {\n            throw new Error(`Invalid GeoJSON: feature ${i} missing or invalid geometry`);\n          }\n          if (!feature.geometry.coordinates || !Array.isArray(feature.geometry.coordinates)) {\n            throw new Error(`Invalid GeoJSON: feature ${i} missing or invalid coordinates`);\n          }\n        }\n        \n        return parsed;\n      }, retryConfig, `R2 fetch ${key}`);\n    });\n    \n    // Cache the result\n    setCachedGeoJSON(key, geo);\n    \n    // Create spatial index\n    const spatialIndex = createSpatialIndex(geo);\n    setCachedSpatialIndex(key, spatialIndex);\n    \n    incrementMetric('r2Successes');\n    recordTiming('totalR2Time', Date.now() - startTime);\n    return geo;\n  } catch (error) {\n    incrementMetric('r2Failures');\n    if (error instanceof Error && error.message.includes('Circuit breaker is OPEN')) {\n      incrementMetric('r2CircuitBreakerTrips');\n    }\n    recordTiming('totalR2Time', Date.now() - startTime);\n    throw error;\n  }\n}\n\n// Lookup riding using spatial index\nfunction lookupRidingWithIndex(spatialIndex: SpatialIndex, lon: number, lat: number): LookupResult {\n  const startTime = Date.now();\n  \n  // First check if point is within the overall bounding box\n  if (!isPointInBoundingBox(lon, lat, spatialIndex.boundingBox)) {\n    incrementMetric('spatialIndexHits');\n    recordTiming('totalSpatialIndexTime', Date.now() - startTime);\n    return { properties: null };\n  }\n  \n  // Find candidate features using spatial index\n  const candidates = findCandidateFeatures(lon, lat, spatialIndex);\n  \n  if (candidates.length === 0) {\n    incrementMetric('spatialIndexHits');\n    recordTiming('totalSpatialIndexTime', Date.now() - startTime);\n    return { properties: null };\n  }\n  \n  incrementMetric('spatialIndexMisses');\n  \n  // Only test point-in-polygon for candidates\n  for (const feat of candidates) {\n    const props = featurePropertiesIfContains(feat, lon, lat);\n    if (props) {\n      // Extract riding name from properties (same logic as database lookup)\n      const englishName = props.ENGLISH_NAME;\n      const nameEn = props.NAME_EN;\n      const fedName = props.FED_NAME;\n      const ridingName = (typeof englishName === 'string' ? englishName : null) \n        || (typeof nameEn === 'string' ? nameEn : null)\n        || (typeof fedName === 'string' ? fedName : null)\n        || undefined;\n      recordTiming('totalSpatialIndexTime', Date.now() - startTime);\n      return { \n        properties: props,\n        riding: ridingName\n      };\n    }\n  }\n  \n  recordTiming('totalSpatialIndexTime', Date.now() - startTime);\n  return { properties: null };\n}\n\n// Check if point is in polygon and return properties\nfunction featurePropertiesIfContains(ridingFeature: any, lon: number, lat: number): Record<string, unknown> | null {\n  const geom = ridingFeature?.geometry;\n  if (!geom) return null;\n  if (isPointInPolygon(lon, lat, geom)) {\n    return ridingFeature?.properties || {};\n  }\n  return null;\n}\n\n/**\n * Main Cloudflare Worker entry point.\n * Handles all incoming HTTP requests and routes them to appropriate handlers.\n * \n * @param request - The incoming HTTP request\n * @param env - Cloudflare Worker environment bindings (R2, KV, D1, Durable Objects, etc.)\n * @returns HTTP response with lookup results, error messages, or API documentation\n * \n * Supported endpoints:\n * - GET /api, /api/qc, /api/on - Riding lookup endpoints\n * - GET /api/batch - Batch lookup processing\n * - POST /api/batch/queue - Submit batch to queue\n * - GET /api/batch/status - Get batch status\n * - POST /api/batch/process - Process queue jobs\n * - POST /api/database/* - Spatial database management\n * - GET /api/boundaries - Get riding boundaries\n * - GET /webhooks - Webhook management\n * - GET /, /docs, /swagger - API documentation\n */\nexport default {\n  async fetch(request: Request, env: Env): Promise<Response> {\n    const startTime = Date.now();\n    const correlationId = getCorrelationId(request);\n    incrementMetric('requestCount');\n    \n    // Initialize circuit breakers with environment (for Durable Object support)\n    if (!geocodingCircuitBreaker || !r2CircuitBreaker) {\n      initializeCircuitBreakers(env);\n    }\n    \n    // Note: Cache warming is now handled by Cloudflare Cron Triggers\n    // See wrangler.toml for cron configuration\n    \n    // Initialize webhook processing\n    initializeWebhookProcessing(env);\n    \n    try {\n      const url = new URL(request.url);\n      const pathname = url.pathname;\n      \n      // CORS configuration - can be customized per endpoint\n      const getCorsHeaders = (origin?: string | null): Record<string, string> => {\n        // Allow all origins by default, but can be restricted per endpoint\n        const allowedOrigin = origin || '*';\n        return {\n          'Access-Control-Allow-Origin': allowedOrigin,\n          'Access-Control-Allow-Methods': 'GET, POST, OPTIONS',\n          'Access-Control-Allow-Headers': 'Content-Type, Authorization, X-Google-API-Key, X-Correlation-ID, X-Request-ID',\n          'Access-Control-Max-Age': '86400',\n          'X-Correlation-ID': correlationId\n        };\n      };\n      \n      // Handle CORS preflight\n      if (request.method === 'OPTIONS') {\n        const origin = request.headers.get('Origin');\n        return new Response(null, {\n          status: 200,\n          headers: getCorsHeaders(origin)\n        });\n      }\n      \n      // Handle landing page\n      if (pathname === \"/\") {\n        const baseUrl = `${url.protocol}//${url.host}`;\n        return new Response(createLandingPage(baseUrl), {\n          headers: { \n            \"content-type\": \"text/html; charset=UTF-8\",\n            'Access-Control-Allow-Origin': '*'\n          }\n        });\n      }\n      \n      // Handle OpenAPI docs\n      if (pathname === \"/api/docs\") {\n        const baseUrl = `${url.protocol}//${url.host}`;\n        return new Response(JSON.stringify(createOpenAPISpec(baseUrl)), {\n          headers: { \n            \"content-type\": \"application/json; charset=UTF-8\",\n            'Access-Control-Allow-Origin': '*'\n          }\n        });\n      }\n\n      // Handle Swagger UI\n      if (pathname === \"/api/swagger\" || pathname === \"/swagger\") {\n        const baseUrl = `${url.protocol}//${url.host}`;\n        const swaggerHtml = createSwaggerUI(baseUrl);\n        return new Response(swaggerHtml, {\n          headers: { \n            \"content-type\": \"text/html; charset=UTF-8\",\n            'Access-Control-Allow-Origin': '*'\n          }\n        });\n      }\n      \n      // Health check endpoint\n      if (pathname === '/health') {\n        const metrics = getMetrics();\n        const circuitBreakerStates = {\n          geocoding: await geocodingCircuitBreaker.getStateInfo('geocoding:nominatim'),\n          r2: await r2CircuitBreaker.getStateInfo('r2:federalridings-2024.geojson')\n        };\n        \n        return new Response(JSON.stringify({\n          status: 'healthy',\n          timestamp: Date.now(),\n          metrics,\n          circuitBreakers: circuitBreakerStates,\n          cacheWarming: getCacheWarmingStatus()\n        }), {\n          headers: { \n            \"content-type\": \"application/json; charset=UTF-8\",\n            'Access-Control-Allow-Origin': '*'\n          }\n        });\n      }\n      \n      // Metrics endpoint\n      if (pathname === '/metrics') {\n        const metrics = getMetricsSummary();\n        return new Response(JSON.stringify(metrics), {\n          headers: { \n            \"content-type\": \"application/json; charset=UTF-8\",\n            'Access-Control-Allow-Origin': '*'\n          }\n        });\n      }\n      \n      // Webhook management endpoints\n      if (pathname.startsWith('/webhooks')) {\n        if (!checkBasicAuth(request, env)) {\n          return unauthorizedResponse(correlationId);\n        }\n        \n        if (pathname === '/webhooks' && request.method === 'GET') {\n          const webhooksMap = await getAllWebhooks(env);\n          const webhooks = Array.from(webhooksMap.entries()).map(([id, config]) => ({\n            id,\n            url: config.url,\n            events: config.events,\n            active: config.active,\n            createdAt: config.createdAt,\n            lastDelivery: config.lastDelivery,\n            failureCount: config.failureCount\n          }));\n          \n          return new Response(JSON.stringify({ webhooks }), {\n            headers: { \n              \"content-type\": \"application/json; charset=UTF-8\",\n              'Access-Control-Allow-Origin': '*'\n            }\n          });\n        }\n        \n        if (pathname === '/webhooks/events' && request.method === 'GET') {\n          const events = await getWebhookEvents(env);\n          return new Response(JSON.stringify({ events }), {\n            headers: { \n              \"content-type\": \"application/json; charset=UTF-8\",\n              'Access-Control-Allow-Origin': '*'\n            }\n          });\n        }\n        \n        if (pathname === '/webhooks/deliveries' && request.method === 'GET') {\n          const deliveries = await getWebhookDeliveries(env);\n          return new Response(JSON.stringify({ deliveries }), {\n            headers: { \n              \"content-type\": \"application/json; charset=UTF-8\",\n              'Access-Control-Allow-Origin': '*'\n            }\n          });\n        }\n      }\n      \n      // Cache warming status endpoint\n      if (pathname === '/cache-warming' && request.method === 'GET') {\n        const status = getCacheWarmingStatus();\n        return new Response(JSON.stringify({\n          ...status,\n          config: {\n            enabled: true,\n            interval: TIME_CONSTANTS.SIX_HOURS_MS,\n            batchSize: 5\n          }\n        }), {\n          headers: { \n            \"content-type\": \"application/json; charset=UTF-8\",\n            'Access-Control-Allow-Origin': '*'\n          }\n        });\n      }\n      \n      // Handle database endpoints\n      if (pathname.startsWith('/api/database')) {\n        if (pathname === '/api/database/init' && request.method === 'POST') {\n          if (!checkBasicAuth(request, env)) {\n            return unauthorizedResponse(correlationId);\n          }\n          \n          try {\n            const success = await initializeSpatialDatabase(env);\n            return new Response(JSON.stringify({\n              success,\n              message: success ? \"Database initialized successfully\" : \"Database initialization failed\"\n            }), {\n              headers: { \n                \"content-type\": \"application/json; charset=UTF-8\",\n                'Access-Control-Allow-Origin': '*'\n              }\n            });\n          } catch (error) {\n            return badRequest(\n              error instanceof Error ? error.message : \"Database initialization failed\",\n              500\n            );\n          }\n        }\n        \n        if (pathname === '/api/database/sync' && request.method === 'POST') {\n          if (!checkBasicAuth(request, env)) {\n            return unauthorizedResponse(correlationId);\n          }\n          \n          try {\n            const body = await request.json() as { dataset?: string };\n            const dataset = body.dataset || 'federalridings-2024.geojson';\n            \n            const success = await syncGeoJSONToDatabase(env, dataset, loadGeo);\n            return new Response(JSON.stringify({\n              success,\n              message: success ? `Database synced for ${dataset}` : \"Database sync failed\",\n              dataset\n            }), {\n              headers: { \n                \"content-type\": \"application/json; charset=UTF-8\",\n                'Access-Control-Allow-Origin': '*'\n              }\n            });\n          } catch (error) {\n            return badRequest(\n              error instanceof Error ? error.message : \"Database sync failed\",\n              500\n            );\n          }\n        }\n        \n        if (pathname === '/api/database/stats' && request.method === 'GET') {\n          if (!checkBasicAuth(request, env)) {\n            return unauthorizedResponse(correlationId);\n          }\n          \n          try {\n            // This would need to be implemented to get actual database stats\n            const dbConfig = getSpatialDbConfig(env);\n            return new Response(JSON.stringify({\n              enabled: dbConfig.ENABLED,\n              features: 0, // Would need actual count\n              lastSync: null, // Would need actual timestamp\n              status: dbConfig.ENABLED ? \"active\" : \"disabled\"\n            }), {\n              headers: { \n                \"content-type\": \"application/json; charset=UTF-8\",\n                'Access-Control-Allow-Origin': '*'\n              }\n            });\n          } catch (error) {\n            return badRequest(\n              error instanceof Error ? error.message : \"Failed to get database stats\",\n              500\n            );\n          }\n        }\n        \n        if (pathname === '/api/database/query' && request.method === 'GET') {\n          const lat = parseFloat(url.searchParams.get('lat') || '');\n          const lon = parseFloat(url.searchParams.get('lon') || '');\n          const dataset = url.searchParams.get('dataset') || 'federalridings-2024.geojson';\n          \n          if (isNaN(lat) || isNaN(lon)) {\n            return badRequest('Invalid lat/lon parameters', 400);\n          }\n          \n          try {\n            const result = await queryRidingFromDatabase(env, dataset, lon, lat);\n            return new Response(JSON.stringify(result), {\n              headers: { \n                \"content-type\": \"application/json; charset=UTF-8\",\n                'Access-Control-Allow-Origin': '*'\n              }\n            });\n          } catch (error) {\n            return badRequest(\n              error instanceof Error ? error.message : \"Database query failed\",\n              500\n            );\n          }\n        }\n        \n        return badRequest(\"Database endpoint not found\", 404);\n      }\n      \n      // Handle boundaries endpoints\n      if (pathname.startsWith('/api/boundaries')) {\n        if (pathname === '/api/boundaries/lookup' && request.method === 'GET') {\n          const lat = parseFloat(url.searchParams.get('lat') || '');\n          const lon = parseFloat(url.searchParams.get('lon') || '');\n          const dataset = url.searchParams.get('dataset') || 'federalridings-2024.geojson';\n          \n          if (isNaN(lat) || isNaN(lon)) {\n            return badRequest('Invalid lat/lon parameters', 400);\n          }\n          \n          try {\n            const result = await lookupRiding(env, `/api`, lon, lat);\n            return new Response(JSON.stringify(result), {\n              headers: { \n                \"content-type\": \"application/json; charset=UTF-8\",\n                'Access-Control-Allow-Origin': '*'\n              }\n            });\n          } catch (error) {\n            return badRequest(\n              error instanceof Error ? error.message : \"Boundaries lookup failed\",\n              500\n            );\n          }\n        }\n        \n        if (pathname === '/api/boundaries/all' && request.method === 'GET') {\n          const dataset = url.searchParams.get('dataset') || 'federalridings-2024.geojson';\n          const limit = parseInt(url.searchParams.get('limit') || '100');\n          const offset = parseInt(url.searchParams.get('offset') || '0');\n          \n          try {\n            const dbConfig = getSpatialDbConfig(env);\n            if (dbConfig.ENABLED && env.RIDING_DB) {\n              const result = await getAllFeaturesFromDatabase(env, dataset, limit, offset);\n              return new Response(JSON.stringify(result), {\n                headers: { \n                  \"content-type\": \"application/json; charset=UTF-8\",\n                  'Access-Control-Allow-Origin': '*'\n                }\n              });\n            } else {\n              return badRequest('Spatial database not enabled', 503);\n            }\n          } catch (error) {\n            return badRequest(\n              error instanceof Error ? error.message : \"Failed to get boundaries\",\n              500\n            );\n          }\n        }\n        \n        if (pathname === '/api/boundaries/config' && request.method === 'GET') {\n          const dbConfig = getSpatialDbConfig(env);\n          return new Response(JSON.stringify({\n            enabled: dbConfig.ENABLED,\n            useRtreeIndex: dbConfig.USE_RTREE_INDEX,\n            batchInsertSize: dbConfig.BATCH_INSERT_SIZE,\n            datasets: ['federalridings-2024.geojson', 'quebecridings-2025.geojson', 'ontarioridings-2022.geojson']\n          }), {\n            headers: { \n              \"content-type\": \"application/json; charset=UTF-8\",\n              'Access-Control-Allow-Origin': '*'\n            }\n          });\n        }\n        \n        return badRequest(\"Boundaries endpoint not found\", 404);\n      }\n      \n      // Handle geocoding batch status endpoint\n      if (pathname === \"/api/geocoding/batch/status\") {\n        if (request.method === \"GET\") {\n          return new Response(JSON.stringify({\n            enabled: true,\n            maxBatchSize: 10,\n            timeout: 30000,\n            retryAttempts: 3,\n            fallbackToIndividual: true,\n            hasGoogleApiKey: !!(env.GOOGLE_MAPS_KEY),\n            timestamp: Date.now()\n          }), {\n            headers: { \n              \"content-type\": \"application/json; charset=UTF-8\",\n              'Access-Control-Allow-Origin': '*'\n            }\n          });\n        } else {\n          return badRequest(\"Method not allowed\", 405);\n        }\n      }\n      \n      // Handle cache warming endpoints\n      if (pathname === \"/api/cache/warm\") {\n        if (request.method === \"POST\") {\n          if (!checkBasicAuth(request, env)) {\n            return unauthorizedResponse(correlationId);\n          }\n          \n          try {\n            const body = await request.json() as { locations?: Array<{ lat: number; lon: number; postal?: string }> };\n            const locations = body.locations || [];\n            \n            for (const location of locations) {\n              if (location.lat && location.lon) {\n                await loadGeo(env, 'federalridings-2024.geojson');\n              } else if (location.postal) {\n                console.log(`Cache warming for postal code: ${location.postal}`);\n              }\n            }\n            \n            return new Response(JSON.stringify({\n              message: \"Cache warming initiated\",\n              locations: locations.length,\n              timestamp: Date.now()\n            }), {\n              headers: { \n                \"content-type\": \"application/json; charset=UTF-8\",\n                'Access-Control-Allow-Origin': '*'\n              }\n            });\n          } catch (error) {\n            return badRequest(\n              error instanceof Error ? error.message : \"Cache warming failed\",\n              500\n            );\n          }\n        } else {\n          return badRequest(\"Method not allowed\", 405);\n        }\n      }\n      \n      // Handle webhook management endpoints\n      if (pathname.startsWith('/api/webhooks')) {\n        if (pathname === '/api/webhooks' && request.method === 'GET') {\n          if (!checkBasicAuth(request, env)) {\n            return unauthorizedResponse(correlationId);\n          }\n          \n          const webhooksMap = await getAllWebhooks(env);\n          const webhooks = Array.from(webhooksMap.entries()).map(([id, config]) => ({\n            id,\n            url: config.url,\n            events: config.events,\n            secret: config.secret ? '***' : undefined,\n            createdAt: config.createdAt,\n            lastDelivery: config.lastDelivery,\n            failureCount: config.failureCount,\n            maxFailures: config.maxFailures,\n            active: config.active\n          }));\n          \n          return new Response(JSON.stringify({ webhooks }), {\n            headers: { \n              \"content-type\": \"application/json; charset=UTF-8\",\n              'Access-Control-Allow-Origin': '*'\n            }\n          });\n        }\n        \n        if (pathname === '/api/webhooks' && request.method === 'POST') {\n          if (!checkBasicAuth(request, env)) {\n            return unauthorizedResponse(correlationId);\n          }\n          \n          try {\n            const body = await request.json() as { url: string; events: string[]; secret?: string };\n            const webhookId = await createWebhook(env, {\n              url: body.url,\n              events: body.events,\n              secret: body.secret || '',\n              active: true\n            });\n            \n            return new Response(JSON.stringify({\n              webhookId,\n              message: \"Webhook created successfully\"\n            }), {\n              headers: { \n                \"content-type\": \"application/json; charset=UTF-8\",\n                'Access-Control-Allow-Origin': '*'\n              }\n            });\n          } catch (error) {\n            return badRequest(\n              error instanceof Error ? error.message : \"Failed to create webhook\",\n              500\n            );\n          }\n        }\n        \n        if (pathname === '/api/webhooks/events' && request.method === 'GET') {\n          if (!checkBasicAuth(request, env)) {\n            return unauthorizedResponse(correlationId);\n          }\n          \n          const url = new URL(request.url);\n          const status = url.searchParams.get('status');\n          const webhookId = url.searchParams.get('webhookId');\n          \n          const events = await getWebhookEvents(env, webhookId || undefined);\n          const filteredEvents = status ? events.filter(e => e.status === status) : events;\n          \n          return new Response(JSON.stringify({ events: filteredEvents }), {\n            headers: { \n              \"content-type\": \"application/json; charset=UTF-8\",\n              'Access-Control-Allow-Origin': '*'\n            }\n          });\n        }\n        \n        if (pathname === '/api/webhooks/deliveries' && request.method === 'GET') {\n          if (!checkBasicAuth(request, env)) {\n            return unauthorizedResponse(correlationId);\n          }\n          \n          const url = new URL(request.url);\n          const webhookId = url.searchParams.get('webhookId');\n          const status = url.searchParams.get('status');\n          \n          const deliveries = await getWebhookDeliveries(env, webhookId || undefined);\n          const filteredDeliveries = status ? deliveries.filter(d => d.status === status) : deliveries;\n          \n          return new Response(JSON.stringify({ deliveries: filteredDeliveries }), {\n            headers: { \n              \"content-type\": \"application/json; charset=UTF-8\",\n              'Access-Control-Allow-Origin': '*'\n            }\n          });\n        }\n        \n        return badRequest(\"Webhook endpoint not found\", 404);\n      }\n      \n      // Batch processing endpoints\n      if (pathname.startsWith('/batch')) {\n        if (!checkBasicAuth(request, env)) {\n          return unauthorizedResponse(correlationId);\n        }\n        \n        if (pathname === '/batch' && request.method === 'POST') {\n          try {\n            // Check request body size (limit to 10MB)\n            const contentLength = request.headers.get('content-length');\n            if (contentLength && parseInt(contentLength) > 10 * 1024 * 1024) {\n              return badRequest('Request body too large. Maximum size is 10MB', 413);\n            }\n            \n            const body = await request.json() as { requests: any[] };\n            const requests = body.requests.map((req, index) => ({\n              id: req.id || `req_${index}`,\n              query: req.query,\n              pathname: req.pathname || '/api'\n            }));\n            \n            const cb = geocodingCircuitBreaker ? { execute: (k: string, fn: () => Promise<any>) => geocodingCircuitBreaker!.execute(k, fn) } : undefined;\n            const results = await processBatchLookupWithBatchGeocoding(\n              env,\n              requests,\n              geocodeIfNeeded,\n              lookupRiding,\n              (e, q, req?, c?) => geocodeBatch(e, q, req, undefined, c ?? cb),\n              request,\n              cb\n            );\n            \n            return new Response(JSON.stringify({ results }), {\n              headers: { \n                \"content-type\": \"application/json; charset=UTF-8\",\n                'Access-Control-Allow-Origin': '*'\n              }\n            });\n          } catch (error) {\n            return badRequest(\n              error instanceof Error ? error.message : \"Batch processing failed\",\n              500\n            );\n          }\n        }\n        \n        if (pathname.startsWith('/batch/') && request.method === 'GET') {\n          const batchId = pathname.split('/')[2];\n          try {\n            const status = await getBatchStatus(env, batchId);\n            return new Response(JSON.stringify(status), {\n              headers: { \n                \"content-type\": \"application/json; charset=UTF-8\",\n                'Access-Control-Allow-Origin': '*'\n              }\n            });\n          } catch (error) {\n            return badRequest(\n              error instanceof Error ? error.message : \"Failed to get batch status\",\n              500\n            );\n          }\n        }\n      }\n      \n      // Handle queue-based batch submission\n      if (pathname === \"/api/queue/submit\") {\n        if (request.method !== \"POST\") {\n          return badRequest(\"Only POST supported for queue submit\", 405);\n        }\n        \n        // Check basic authentication\n        if (!checkBasicAuth(request, env)) {\n          return unauthorizedResponse(correlationId);\n        }\n        \n        try {\n          // Check request body size (limit to 10MB)\n          const contentLength = request.headers.get('content-length');\n          if (contentLength && parseInt(contentLength) > 10 * 1024 * 1024) {\n            return badRequest('Request body too large. Maximum size is 10MB', 413);\n          }\n          \n          const body = await request.json() as { requests: any[] };\n          \n          if (!body.requests || !Array.isArray(body.requests)) {\n            return badRequest(\"Invalid request body. Expected 'requests' array.\", 400);\n          }\n          \n          const result = await submitBatchToQueue(env, body.requests);\n          return new Response(JSON.stringify(result), {\n            headers: { \n              \"content-type\": \"application/json; charset=UTF-8\",\n              'Access-Control-Allow-Origin': '*'\n            }\n          });\n        } catch (error) {\n          return badRequest(\n            error instanceof Error ? error.message : \"Failed to submit batch to queue\",\n            500\n          );\n        }\n      }\n      \n      // Handle batch status check\n      if (pathname === \"/api/queue/status\") {\n        if (request.method !== \"GET\") {\n          return badRequest(\"Only GET supported for status check\", 405);\n        }\n        \n        // Check basic authentication\n        if (!checkBasicAuth(request, env)) {\n          return unauthorizedResponse(correlationId);\n        }\n        \n        const batchId = url.searchParams.get('batchId');\n        if (!batchId) {\n          return badRequest(\"Missing required parameter: batchId\", 400);\n        }\n        \n        try {\n          const result = await getBatchStatus(env, batchId);\n          return new Response(JSON.stringify(result), {\n            headers: { \n              \"content-type\": \"application/json; charset=UTF-8\",\n              'Access-Control-Allow-Origin': '*'\n            }\n          });\n        } catch (error) {\n          return badRequest(\n            error instanceof Error ? error.message : \"Failed to get batch status\",\n            500\n          );\n        }\n      }\n      \n      // Handle queue processing (for workers)\n      if (pathname === \"/api/queue/process\") {\n        if (request.method !== \"POST\") {\n          return badRequest(\"Only POST supported for queue processing\", 405);\n        }\n        \n        // Check basic authentication\n        if (!checkBasicAuth(request, env)) {\n          return unauthorizedResponse(correlationId);\n        }\n        \n        try {\n          const body = await request.json() as { maxJobs?: number };\n          const result = await processQueueJobs(env, body.maxJobs || 10);\n          return new Response(JSON.stringify(result), {\n            headers: { \n              \"content-type\": \"application/json; charset=UTF-8\",\n              'Access-Control-Allow-Origin': '*'\n            }\n          });\n        } catch (error) {\n          return badRequest(\n            error instanceof Error ? error.message : \"Failed to process queue jobs\",\n            500\n          );\n        }\n      }\n      \n      // Handle queue statistics\n      if (pathname === \"/api/queue/stats\") {\n        if (request.method !== \"GET\") {\n          return badRequest(\"Only GET supported for queue stats\", 405);\n        }\n        \n        // Check basic authentication\n        if (!checkBasicAuth(request, env)) {\n          return unauthorizedResponse(correlationId);\n        }\n        \n        try {\n          // Get queue stats from the queue manager\n          if (!env.QUEUE_MANAGER) {\n            return badRequest(\"Queue manager not configured\", 503);\n          }\n          \n          const queueManagerId = env.QUEUE_MANAGER.idFromName(\"main-queue\");\n          const queueManager = env.QUEUE_MANAGER.get(queueManagerId);\n          const response = await queueManager.fetch(new Request(\"https://queue.local/queue/stats\"));\n          \n          if (!response.ok) {\n            const error = await response.json() as { error?: string };\n            throw new Error(error.error || \"Failed to get queue stats\");\n          }\n          \n          const stats = await response.json();\n          return new Response(JSON.stringify(stats), {\n            headers: { \n              \"content-type\": \"application/json; charset=UTF-8\",\n              'Access-Control-Allow-Origin': '*'\n            }\n          });\n        } catch (error) {\n          return badRequest(\n            error instanceof Error ? error.message : \"Failed to get queue stats\",\n            500\n          );\n        }\n      }\n      \n      // Queue processing endpoint (legacy)\n      if (pathname === '/queue/process' && request.method === 'POST') {\n        if (!checkBasicAuth(request, env)) {\n          return unauthorizedResponse(correlationId);\n        }\n        \n        try {\n          const body = await request.json() as { maxJobs?: number };\n          const result = await processQueueJobs(env, body.maxJobs || 10);\n          return new Response(JSON.stringify(result), {\n            headers: { \n              \"content-type\": \"application/json; charset=UTF-8\",\n              'Access-Control-Allow-Origin': '*'\n            }\n          });\n        } catch (error) {\n          return badRequest(\n            error instanceof Error ? error.message : \"Queue processing failed\",\n            500\n          );\n        }\n      }\n      \n      // Main lookup endpoint\n      if (pathname.startsWith('/api')) {\n        // Check rate limiting\n        const clientId = getClientId(request);\n        if (!checkRateLimit(env, clientId)) {\n          return rateLimitExceededResponse(correlationId);\n        }\n        \n        // Check basic authentication for API routes\n        if (!checkBasicAuth(request, env)) {\n          return unauthorizedResponse(correlationId);\n        }\n        \n        try {\n          const { query, validation } = parseQuery(request);\n          \n          // Check validation result\n          if (!validation.valid) {\n            return badRequest(validation.error || \"Invalid query parameters\", 400, \"INVALID_QUERY\", correlationId);\n          }\n          \n          // Use sanitized query parameters\n          const sanitizedQuery = validation.sanitized!;\n          \n          // Increment lookup requests metric (before cache check)\n          incrementMetric('lookupRequests');\n          \n          // Generate cache key\n          const cacheKey = generateLookupCacheKey(sanitizedQuery, pathname);\n          \n          // Check lookup cache\n          const cachedResult = await getCachedLookupResult(env, cacheKey);\n          if (cachedResult) {\n            incrementMetric('lookupCacheHits');\n            recordTiming('totalLookupTime', Date.now() - startTime);\n            const origin = request.headers.get('Origin');\n            // Use point from cache entry if available, otherwise fall back to sanitizedQuery\n            const point = cachedResult.point || (sanitizedQuery.lat !== undefined && sanitizedQuery.lon !== undefined \n              ? { lon: sanitizedQuery.lon, lat: sanitizedQuery.lat } \n              : undefined);\n            return new Response(JSON.stringify({\n              query: sanitizedQuery,\n              point,\n              properties: cachedResult.properties,\n              riding: cachedResult.riding,\n              ...(cachedResult.normalizedAddress && { normalizedAddress: cachedResult.normalizedAddress }),\n              correlationId\n            }), {\n              headers: { \n                \"content-type\": \"application/json; charset=UTF-8\",\n                \"X-Cache-Status\": \"HIT\",\n                ...getCorsHeaders(origin)\n              }\n            });\n          }\n          \n          incrementMetric('lookupCacheMisses');\n          \n          const timeoutConfig = getTimeoutConfig(env);\n          const cb = geocodingCircuitBreaker ? { execute: (k: string, fn: () => Promise<any>) => geocodingCircuitBreaker!.execute(k, fn) } : undefined;\n          const geocodeResult = await withTimeout(\n            geocodeIfNeeded(env, sanitizedQuery, request, undefined, cb),\n            timeoutConfig.geocoding,\n            \"Geocoding\"\n          );\n          const { lon, lat } = geocodeResult;\n          let normalizedAddress = geocodeResult.normalizedAddress;\n          if (!normalizedAddress && (request?.headers.get('X-Google-API-Key') || env.GOOGLE_MAPS_KEY)) {\n            normalizedAddress = await normalizeAddressWithGoogle(env, geocodeResult.lat, geocodeResult.lon, request, cb) ?? undefined;\n          }\n          const result = await withTimeout(\n            lookupRiding(env, pathname, lon, lat),\n            timeoutConfig.lookup,\n            \"Riding lookup\"\n          );\n          \n          const { r2Key } = pickDataset(pathname);\n          const dataset = r2Key.replace('.geojson', '');\n          const lookupResult: LookupResult = {\n            properties: result.properties,\n            riding: result.riding,\n            ...(normalizedAddress && { normalizedAddress })\n          };\n          await setCachedLookupResult(env, cacheKey, lookupResult, dataset, { lon, lat });\n          \n          recordTiming('totalLookupTime', Date.now() - startTime);\n          const origin = request.headers.get('Origin');\n          return new Response(JSON.stringify({\n            query: sanitizedQuery,\n            point: { lon, lat },\n            ...result,\n            ...(normalizedAddress && { normalizedAddress }),\n            correlationId\n          }), {\n            headers: { \n              \"content-type\": \"application/json; charset=UTF-8\",\n              \"X-Cache-Status\": \"MISS\",\n              ...getCorsHeaders(origin)\n            }\n          });\n        } catch (error) {\n          incrementMetric('errorCount');\n          console.error(`[${correlationId}] Lookup error:`, error);\n          return badRequest(\n            error instanceof Error ? error.message : \"Lookup failed\",\n            500,\n            \"LOOKUP_ERROR\",\n            correlationId\n          );\n        }\n      }\n      \n      return badRequest(\"Not found\", 404, \"NOT_FOUND\", correlationId)\n    } catch (err: unknown) {\n      incrementMetric('errorCount');\n      recordTiming('totalLookupTime', Date.now() - startTime);\n      console.error(`[${correlationId}] Unexpected error:`, err);\n      return badRequest(err instanceof Error ? err.message : \"Unexpected error\", 400, \"UNEXPECTED_ERROR\", correlationId);\n    }\n  },\n  \n  async scheduled(event: ScheduledEvent, env: Env, ctx: ExecutionContext): Promise<void> {\n    // Initialize circuit breakers with environment (for Durable Object support)\n    // This is needed because scheduled events can fire before any HTTP request\n    if (!geocodingCircuitBreaker || !r2CircuitBreaker) {\n      initializeCircuitBreakers(env);\n    }\n    \n    await handleScheduled(event, env, ctx);\n  }\n};\n\n// Export Durable Objects\nexport { QueueManagerDO };\nexport { CircuitBreakerDO };\n\n"],
  "mappings": "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AAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4CA8ZmC,OAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,6DAOU,OAAO;AAAA;AAAA;AAAA,oEAGA,OAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2BAOhD,OAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4CA8BU,OAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,6DAOU,OAAO;AAAA;AAAA;AAAA,oEAGA,OAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2BAOhD,OAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4CA8BU,OAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,6DAOU,OAAO;AAAA;AAAA;AAAA,oEAGA,OAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2BAOhD,OAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iEA4E+B,OAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iEA2BP,OAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yDAkCf,OAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;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",
  "names": ["util", "objectUtil", "errorUtil", "errorMap", "ctx", "result", "issues", "elements", "processed", "result", "r", "ZodFirstPartyTypeKind", "metrics", "errorMsg", "withRetry", "withTimeout", "loadGeo", "lookupRiding", "hash", "loadGeo", "geocodeIfNeeded", "lookupRiding", "request", "startTime", "MAX_BATCH_SIZE", "env", "withTimeout", "withRetry", "metrics", "url", "origin"]
}
